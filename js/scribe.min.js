/*! Stypi Editor - v0.11.1 - 2014-03-13
 *  https://stypi.github.io/scribe/
 *  Copyright (c) 2014
 *  Jason Chen, Salesforce.com
 */

!function(a){if("object"==typeof exports)module.exports=a();else if("function"==typeof define&&define.amd)define(a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.Scribe=a()}}(function(){var a;return function b(a,c,d){function e(g,h){if(!c[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};a[g][0].call(j.exports,function(b){var c=a[g][1][b];return e(c?c:b)},j,j.exports,b,a,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){b.exports=a("./src/scribe")},{"./src/scribe":45}],uyMq3L:[function(a,b){function c(){}c.prototype={length:0,first:null,last:null},c.prototype.append=function(a){"undefined"==typeof this.first||null===this.first?this.first=a:(a.next=null,this.last.next=a),a.prev=this.last,this.last=a,this.length++},c.prototype.insertAfter=function(a,b){b.prev=a,a?(b.next=a.next,"undefined"!=typeof a.next&&null!==a.next&&(a.next.prev=b),a.next=b,a===this.last&&(this.last=b)):(b.next=this.first,this.first.prev=b,this.first=b),this.length++},c.prototype.remove=function(a){this.length>1?("undefined"!=typeof a.prev&&null!==a.prev&&(a.prev.next=a.next),"undefined"!=typeof a.next&&null!==a.next&&(a.next.prev=a.prev),a==this.first&&(this.first=a.next),a==this.last&&(this.last=a.prev)):(this.first=null,this.last=null),a.prev=null,a.next=null,this.length--},c.prototype.toArray=function(){for(var a=[],b=this.first;b;)a.push(b),b=b.next;return a},c.Node=function(a){this.prev=null,this.next=null,this.data=a},b.exports=c},{}],"linked-list":[function(a,b){b.exports=a("uyMq3L")},{}],"4VPpiv":[function(){!function(b){"function"==typeof a?a(b):"function"==typeof YUI?YUI.add("es5",b):b()}(function(){function a(){}function b(a){return a=+a,a!==a?a=0:0!==a&&a!==1/0&&a!==-(1/0)&&(a=(a>0||-1)*Math.floor(Math.abs(a))),a}function c(a){var b=typeof a;return null===a||"undefined"===b||"boolean"===b||"number"===b||"string"===b}function d(a){var b,d,e;if(c(a))return a;if(d=a.valueOf,"function"==typeof d&&(b=d.call(a),c(b)))return b;if(e=a.toString,"function"==typeof e&&(b=e.call(a),c(b)))return b;throw new TypeError}8!==parseInt("08")&&(parseInt=function(a){var b=/^0[xX]/;return function(c,d){return c=String(c).trim(),+d||(d=b.test(c)?16:10),a(c,d)}}(parseInt)),Function.prototype.bind||(Function.prototype.bind=function(b){var c=this;if("function"!=typeof c)throw new TypeError("Function.prototype.bind called on incompatible "+c);for(var d=m.call(arguments,1),e=function(){if(this instanceof i){var a=c.apply(this,d.concat(m.call(arguments)));return Object(a)===a?a:this}return c.apply(b,d.concat(m.call(arguments)))},f=Math.max(0,c.length-d.length),g=[],h=0;f>h;h++)g.push("$"+h);var i=Function("binder","return function("+g.join(",")+"){return binder.apply(this,arguments)}")(e);return c.prototype&&(a.prototype=c.prototype,i.prototype=new a,a.prototype=null),i});var e,f,g,h,i,j=Function.prototype.call,k=Array.prototype,l=Object.prototype,m=k.slice,n=j.bind(l.toString),o=j.bind(l.hasOwnProperty);if((i=o(l,"__defineGetter__"))&&(e=j.bind(l.__defineGetter__),f=j.bind(l.__defineSetter__),g=j.bind(l.__lookupGetter__),h=j.bind(l.__lookupSetter__)),2!=[1,2].splice(0).length){var p=Array.prototype.splice,q=Array.prototype.push,r=Array.prototype.unshift;Array.prototype.splice=function(){function a(a){for(var b=[];a--;)b.unshift(a);return b}var b,c=[];return c.splice.bind(c,0,0).apply(null,a(20)),c.splice.bind(c,0,0).apply(null,a(26)),b=c.length,c.splice(5,0,"XXX"),b+1==c.length?!0:void 0}()?function(a,b){return arguments.length?p.apply(this,[void 0===a?0:a,void 0===b?this.length-a:b].concat(m.call(arguments,2))):[]}:function(a,b){var c,d=m.call(arguments,2),e=d.length;if(!arguments.length)return[];if(void 0===a&&(a=0),void 0===b&&(b=this.length-a),e>0){if(0>=b){if(a==this.length)return q.apply(this,d),[];if(0==a)return r.apply(this,d),[]}return c=m.call(this,a,a+b),d.push.apply(d,m.call(this,a+b,this.length)),d.unshift.apply(d,m.call(this,0,a)),d.unshift(0,this.length),p.apply(this,d),c}return p.call(this,a,b)}}if(1!=[].unshift(0)){var r=Array.prototype.unshift;Array.prototype.unshift=function(){return r.apply(this,arguments),this.length}}Array.isArray||(Array.isArray=function(a){return"[object Array]"==n(a)});var s=Object("a"),t="a"!=s[0]||!(0 in s),u=!0;if(Array.prototype.forEach&&Array.prototype.forEach.call("foo",function(a,b,c){"object"!=typeof c&&(u=!1)}),Array.prototype.forEach&&u||(Array.prototype.forEach=function(a){var b=I(this),c=t&&"[object String]"==n(this)?this.split(""):b,d=arguments[1],e=-1,f=c.length>>>0;if("[object Function]"!=n(a))throw new TypeError;for(;++e<f;)e in c&&a.call(d,c[e],e,b)}),Array.prototype.map||(Array.prototype.map=function(a){var b=I(this),c=t&&"[object String]"==n(this)?this.split(""):b,d=c.length>>>0,e=Array(d),f=arguments[1];if("[object Function]"!=n(a))throw new TypeError(a+" is not a function");for(var g=0;d>g;g++)g in c&&(e[g]=a.call(f,c[g],g,b));return e}),Array.prototype.filter||(Array.prototype.filter=function(a){var b,c=I(this),d=t&&"[object String]"==n(this)?this.split(""):c,e=d.length>>>0,f=[],g=arguments[1];if("[object Function]"!=n(a))throw new TypeError(a+" is not a function");for(var h=0;e>h;h++)h in d&&(b=d[h],a.call(g,b,h,c)&&f.push(b));return f}),Array.prototype.every||(Array.prototype.every=function(a){var b=I(this),c=t&&"[object String]"==n(this)?this.split(""):b,d=c.length>>>0,e=arguments[1];if("[object Function]"!=n(a))throw new TypeError(a+" is not a function");for(var f=0;d>f;f++)if(f in c&&!a.call(e,c[f],f,b))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(a){var b=I(this),c=t&&"[object String]"==n(this)?this.split(""):b,d=c.length>>>0,e=arguments[1];if("[object Function]"!=n(a))throw new TypeError(a+" is not a function");for(var f=0;d>f;f++)if(f in c&&a.call(e,c[f],f,b))return!0;return!1}),Array.prototype.reduce||(Array.prototype.reduce=function(a){var b=I(this),c=t&&"[object String]"==n(this)?this.split(""):b,d=c.length>>>0;if("[object Function]"!=n(a))throw new TypeError(a+" is not a function");if(!d&&1==arguments.length)throw new TypeError("reduce of empty array with no initial value");var e,f=0;if(arguments.length>=2)e=arguments[1];else for(;;){if(f in c){e=c[f++];break}if(++f>=d)throw new TypeError("reduce of empty array with no initial value")}for(;d>f;f++)f in c&&(e=a.call(void 0,e,c[f],f,b));return e}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(a){var b=I(this),c=t&&"[object String]"==n(this)?this.split(""):b,d=c.length>>>0;if("[object Function]"!=n(a))throw new TypeError(a+" is not a function");if(!d&&1==arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var e,f=d-1;if(arguments.length>=2)e=arguments[1];else for(;;){if(f in c){e=c[f--];break}if(--f<0)throw new TypeError("reduceRight of empty array with no initial value")}if(0>f)return e;do f in this&&(e=a.call(void 0,e,c[f],f,b));while(f--);return e}),Array.prototype.indexOf&&-1==[0,1].indexOf(1,2)||(Array.prototype.indexOf=function(a){var c=t&&"[object String]"==n(this)?this.split(""):I(this),d=c.length>>>0;if(!d)return-1;var e=0;for(arguments.length>1&&(e=b(arguments[1])),e=e>=0?e:Math.max(0,d+e);d>e;e++)if(e in c&&c[e]===a)return e;return-1}),Array.prototype.lastIndexOf&&-1==[0,1].lastIndexOf(0,-3)||(Array.prototype.lastIndexOf=function(a){var c=t&&"[object String]"==n(this)?this.split(""):I(this),d=c.length>>>0;if(!d)return-1;var e=d-1;for(arguments.length>1&&(e=Math.min(e,b(arguments[1]))),e=e>=0?e:d-Math.abs(e);e>=0;e--)if(e in c&&a===c[e])return e;return-1}),!Object.keys){var v=!0,w=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],x=w.length;for(var y in{toString:null})v=!1;Object.keys=function J(a){if("object"!=typeof a&&"function"!=typeof a||null===a)throw new TypeError("Object.keys called on a non-object");var J=[];for(var b in a)o(a,b)&&J.push(b);if(v)for(var c=0,d=x;d>c;c++){var e=w[c];o(a,e)&&J.push(e)}return J}}var z=-621987552e5,A="-000001";Date.prototype.toISOString&&-1!==new Date(z).toISOString().indexOf(A)||(Date.prototype.toISOString=function(){var a,b,c,d,e;if(!isFinite(this))throw new RangeError("Date.prototype.toISOString called on non-finite value.");for(d=this.getUTCFullYear(),e=this.getUTCMonth(),d+=Math.floor(e/12),e=(e%12+12)%12,a=[e+1,this.getUTCDate(),this.getUTCHours(),this.getUTCMinutes(),this.getUTCSeconds()],d=(0>d?"-":d>9999?"+":"")+("00000"+Math.abs(d)).slice(d>=0&&9999>=d?-4:-6),b=a.length;b--;)c=a[b],10>c&&(a[b]="0"+c);return d+"-"+a.slice(0,2).join("-")+"T"+a.slice(2).join(":")+"."+("000"+this.getUTCMilliseconds()).slice(-3)+"Z"});var B=!1;try{B=Date.prototype.toJSON&&null===new Date(0/0).toJSON()&&-1!==new Date(z).toJSON().indexOf(A)&&Date.prototype.toJSON.call({toISOString:function(){return!0}})}catch(C){}B||(Date.prototype.toJSON=function(){var a,b=Object(this),c=d(b);if("number"==typeof c&&!isFinite(c))return null;if(a=b.toISOString,"function"!=typeof a)throw new TypeError("toISOString property is not callable");return a.call(b)}),Date=function(a){function b(c,d,e,f,g,h,i){var j=arguments.length;if(this instanceof a){var k=1==j&&String(c)===c?new a(b.parse(c)):j>=7?new a(c,d,e,f,g,h,i):j>=6?new a(c,d,e,f,g,h):j>=5?new a(c,d,e,f,g):j>=4?new a(c,d,e,f):j>=3?new a(c,d,e):j>=2?new a(c,d):j>=1?new a(c):new a;return k.constructor=b,k}return a.apply(this,arguments)}function c(a,b){var c=b>1?1:0;return f[b]+Math.floor((a-1969+c)/4)-Math.floor((a-1901+c)/100)+Math.floor((a-1601+c)/400)+365*(a-1970)}function d(b){return Number(new a(1970,0,1,0,0,0,b))}var e=new RegExp("^(\\d{4}|[+-]\\d{6})(?:-(\\d{2})(?:-(\\d{2})(?:T(\\d{2}):(\\d{2})(?::(\\d{2})(?:(\\.\\d{1,}))?)?(Z|(?:([-+])(\\d{2}):(\\d{2})))?)?)?)?$"),f=[0,31,59,90,120,151,181,212,243,273,304,334,365];for(var g in a)b[g]=a[g];return b.now=a.now,b.UTC=a.UTC,b.prototype=a.prototype,b.prototype.constructor=b,b.parse=function(b){var f=e.exec(b);if(f){var g,h=Number(f[1]),i=Number(f[2]||1)-1,j=Number(f[3]||1)-1,k=Number(f[4]||0),l=Number(f[5]||0),m=Number(f[6]||0),n=Math.floor(1e3*Number(f[7]||0)),o=Boolean(f[4]&&!f[8]),p="-"===f[9]?1:-1,q=Number(f[10]||0),r=Number(f[11]||0);return(l>0||m>0||n>0?24:25)>k&&60>l&&60>m&&1e3>n&&i>-1&&12>i&&24>q&&60>r&&j>-1&&j<c(h,i+1)-c(h,i)&&(g=60*(24*(c(h,i)+j)+k+q*p),g=1e3*(60*(g+l+r*p)+m)+n,o&&(g=d(g)),g>=-864e13&&864e13>=g)?g:0/0}return a.parse.apply(this,arguments)},b}(Date),Date.now||(Date.now=function(){return(new Date).getTime()}),Number.prototype.toFixed&&"0.000"===8e-5.toFixed(3)&&"0"!==.9.toFixed(0)&&"1.25"===1.255.toFixed(2)&&"1000000000000000128"===0xde0b6b3a7640080.toFixed(0)||!function(){function a(a,b){for(var c=-1;++c<g;)b+=a*h[c],h[c]=b%f,b=Math.floor(b/f)}function b(a){for(var b=g,c=0;--b>=0;)c+=h[b],h[b]=Math.floor(c/a),c=c%a*f}function c(){for(var a=g,b="";--a>=0;)if(""!==b||0===a||0!==h[a]){var c=String(h[a]);""===b?b=c:b+="0000000".slice(0,7-c.length)+c}return b}function d(a,b,c){return 0===b?c:b%2===1?d(a,b-1,c*a):d(a*a,b/2,c)}function e(a){for(var b=0;a>=4096;)b+=12,a/=4096;for(;a>=2;)b+=1,a/=2;return b}var f,g,h;f=1e7,g=6,h=[0,0,0,0,0,0],Number.prototype.toFixed=function(f){var g,h,i,j,k,l,m,n;if(g=Number(f),g=g!==g?0:Math.floor(g),0>g||g>20)throw new RangeError("Number.toFixed called with invalid number of decimals");if(h=Number(this),h!==h)return"NaN";if(-1e21>=h||h>=1e21)return String(h);if(i="",0>h&&(i="-",h=-h),j="0",h>1e-21)if(k=e(h*d(2,69,1))-69,l=0>k?h*d(2,-k,1):h/d(2,k,1),l*=4503599627370496,k=52-k,k>0){for(a(0,l),m=g;m>=7;)a(1e7,0),m-=7;for(a(d(10,m,1),0),m=k-1;m>=23;)b(1<<23),m-=23;b(1<<m),a(1,1),b(2),j=c()}else a(0,l),a(1<<-k,0),j=c()+"0.00000000000000000000".slice(2,2+g);return g>0?(n=j.length,j=g>=n?i+"0.0000000000000000000".slice(0,g-n+2)+j:i+j.slice(0,n-g)+"."+j.slice(n-g)):j=i+j,j}}();var D=String.prototype.split;if(2!=="ab".split(/(?:ab)*/).length||4!==".".split(/(.?)(.?)/).length||"t"==="tesst".split(/(s)*/)[1]||"".split(/.?/).length||".".split(/()()/).length>1?!function(){var a=void 0===/()??/.exec("")[1];String.prototype.split=function(b,c){var d=this;if(void 0===b&&0===c)return[];if("[object RegExp]"!==Object.prototype.toString.call(b))return D.apply(this,arguments);var e,f,g,h,i=[],j=(b.ignoreCase?"i":"")+(b.multiline?"m":"")+(b.extended?"x":"")+(b.sticky?"y":""),k=0,b=new RegExp(b.source,j+"g");for(d+="",a||(e=new RegExp("^"+b.source+"$(?!\\s)",j)),c=void 0===c?-1>>>0:c>>>0;(f=b.exec(d))&&(g=f.index+f[0].length,!(g>k&&(i.push(d.slice(k,f.index)),!a&&f.length>1&&f[0].replace(e,function(){for(var a=1;a<arguments.length-2;a++)void 0===arguments[a]&&(f[a]=void 0)}),f.length>1&&f.index<d.length&&Array.prototype.push.apply(i,f.slice(1)),h=f[0].length,k=g,i.length>=c)));)b.lastIndex===f.index&&b.lastIndex++;return k===d.length?(h||!b.test(""))&&i.push(""):i.push(d.slice(k)),i.length>c?i.slice(0,c):i}}():"0".split(void 0,0).length&&(String.prototype.split=function(a,b){return void 0===a&&0===b?[]:D.apply(this,arguments)}),"".substr&&"b"!=="0b".substr(-1)){var E=String.prototype.substr;String.prototype.substr=function(a,b){return E.call(this,0>a&&(a=this.length+a)<0?0:a,b)}}var F="  \n\f\r   ᠎             　\u2028\u2029﻿";if(!String.prototype.trim||F.trim()){F="["+F+"]";var G=new RegExp("^"+F+F+"*"),H=new RegExp(F+F+"*$");String.prototype.trim=function(){if(void 0===this||null===this)throw new TypeError("can't convert "+this+" to object");return String(this).replace(G,"").replace(H,"")}}var I=function(a){if(null==a)throw new TypeError("can't convert "+a+" to object");return Object(a)}})},{}],"es5-shim":[function(a,b){b.exports=a("4VPpiv")},{}],eventemitter2:[function(a,b){b.exports=a("x/3aRz")},{}],"x/3aRz":[function(b,c,d){(function(b){!function(b){function c(){this._events={},this._conf&&d.call(this,this._conf)}function d(a){a&&(this._conf=a,a.delimiter&&(this.delimiter=a.delimiter),a.maxListeners&&(this._events.maxListeners=a.maxListeners),a.wildcard&&(this.wildcard=a.wildcard),a.newListener&&(this.newListener=a.newListener),this.wildcard&&(this.listenerTree={}))}function e(a){this._events={},this.newListener=!1,d.call(this,a)}function f(a,b,c,d){if(!c)return[];var e,g,h,i,j,k,l,m=[],n=b.length,o=b[d],p=b[d+1];if(d===n&&c._listeners){if("function"==typeof c._listeners)return a&&a.push(c._listeners),[c];for(e=0,g=c._listeners.length;g>e;e++)a&&a.push(c._listeners[e]);return[c]}if("*"===o||"**"===o||c[o]){if("*"===o){for(h in c)"_listeners"!==h&&c.hasOwnProperty(h)&&(m=m.concat(f(a,b,c[h],d+1)));return m}if("**"===o){l=d+1===n||d+2===n&&"*"===p,l&&c._listeners&&(m=m.concat(f(a,b,c,n)));for(h in c)"_listeners"!==h&&c.hasOwnProperty(h)&&("*"===h||"**"===h?(c[h]._listeners&&!l&&(m=m.concat(f(a,b,c[h],n))),m=m.concat(f(a,b,c[h],d))):m=m.concat(h===p?f(a,b,c[h],d+2):f(a,b,c[h],d)));return m}m=m.concat(f(a,b,c[o],d+1))}if(i=c["*"],i&&f(a,b,i,d+1),j=c["**"])if(n>d){j._listeners&&f(a,b,j,n);for(h in j)"_listeners"!==h&&j.hasOwnProperty(h)&&(h===p?f(a,b,j[h],d+2):h===o?f(a,b,j[h],d+1):(k={},k[h]=j[h],f(a,b,{"**":k},d+1)))}else j._listeners?f(a,b,j,n):j["*"]&&j["*"]._listeners&&f(a,b,j["*"],n);return m}function g(a,b){a="string"==typeof a?a.split(this.delimiter):a.slice();for(var c=0,d=a.length;d>c+1;c++)if("**"===a[c]&&"**"===a[c+1])return;for(var e=this.listenerTree,f=a.shift();f;){if(e[f]||(e[f]={}),e=e[f],0===a.length){if(e._listeners){if("function"==typeof e._listeners)e._listeners=[e._listeners,b];else if(h(e._listeners)&&(e._listeners.push(b),!e._listeners.warned)){var g=i;"undefined"!=typeof this._events.maxListeners&&(g=this._events.maxListeners),g>0&&e._listeners.length>g&&(e._listeners.warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",e._listeners.length),console.trace())}}else e._listeners=b;return!0}f=a.shift()}return!0}var h=Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)},i=10;e.prototype.delimiter=".",e.prototype.setMaxListeners=function(a){this._events||c.call(this),this._events.maxListeners=a,this._conf||(this._conf={}),this._conf.maxListeners=a},e.prototype.event="",e.prototype.once=function(a,b){return this.many(a,1,b),this},e.prototype.many=function(a,b,c){function d(){0===--b&&e.off(a,d),c.apply(this,arguments)}var e=this;if("function"!=typeof c)throw new Error("many only accepts instances of Function");return d._origin=c,this.on(a,d),e},e.prototype.emit=function(){this._events||c.call(this);var a=arguments[0];if("newListener"===a&&!this.newListener&&!this._events.newListener)return!1;if(this._all){for(var b=arguments.length,d=new Array(b-1),e=1;b>e;e++)d[e-1]=arguments[e];for(e=0,b=this._all.length;b>e;e++)this.event=a,this._all[e].apply(this,d)}if("error"===a&&!(this._all||this._events.error||this.wildcard&&this.listenerTree.error))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");var g;if(this.wildcard){g=[];var h="string"==typeof a?a.split(this.delimiter):a.slice();f.call(this,g,h,this.listenerTree,0)}else g=this._events[a];if("function"==typeof g){if(this.event=a,1===arguments.length)g.call(this);else if(arguments.length>1)switch(arguments.length){case 2:g.call(this,arguments[1]);break;case 3:g.call(this,arguments[1],arguments[2]);break;default:for(var b=arguments.length,d=new Array(b-1),e=1;b>e;e++)d[e-1]=arguments[e];g.apply(this,d)}return!0}if(g){for(var b=arguments.length,d=new Array(b-1),e=1;b>e;e++)d[e-1]=arguments[e];for(var i=g.slice(),e=0,b=i.length;b>e;e++)this.event=a,i[e].apply(this,d);return i.length>0||this._all}return this._all},e.prototype.on=function(a,b){if("function"==typeof a)return this.onAny(a),this;if("function"!=typeof b)throw new Error("on only accepts instances of Function");if(this._events||c.call(this),this.emit("newListener",a,b),this.wildcard)return g.call(this,a,b),this;if(this._events[a]){if("function"==typeof this._events[a])this._events[a]=[this._events[a],b];else if(h(this._events[a])&&(this._events[a].push(b),!this._events[a].warned)){var d=i;"undefined"!=typeof this._events.maxListeners&&(d=this._events.maxListeners),d>0&&this._events[a].length>d&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),console.trace())}}else this._events[a]=b;return this},e.prototype.onAny=function(a){if(this._all||(this._all=[]),"function"!=typeof a)throw new Error("onAny only accepts instances of Function");return this._all.push(a),this},e.prototype.addListener=e.prototype.on,e.prototype.off=function(a,b){if("function"!=typeof b)throw new Error("removeListener only takes instances of Function");var c,d=[];if(this.wildcard){var e="string"==typeof a?a.split(this.delimiter):a.slice();d=f.call(this,null,e,this.listenerTree,0)}else{if(!this._events[a])return this;c=this._events[a],d.push({_listeners:c})}for(var g=0;g<d.length;g++){var i=d[g];if(c=i._listeners,h(c)){for(var j=-1,k=0,l=c.length;l>k;k++)if(c[k]===b||c[k].listener&&c[k].listener===b||c[k]._origin&&c[k]._origin===b){j=k;break}if(0>j)continue;return this.wildcard?i._listeners.splice(j,1):this._events[a].splice(j,1),0===c.length&&(this.wildcard?delete i._listeners:delete this._events[a]),this}(c===b||c.listener&&c.listener===b||c._origin&&c._origin===b)&&(this.wildcard?delete i._listeners:delete this._events[a])}return this},e.prototype.offAny=function(a){var b,c=0,d=0;if(a&&this._all&&this._all.length>0){for(b=this._all,c=0,d=b.length;d>c;c++)if(a===b[c])return b.splice(c,1),this}else this._all=[];return this},e.prototype.removeListener=e.prototype.off,e.prototype.removeAllListeners=function(a){if(0===arguments.length)return!this._events||c.call(this),this;if(this.wildcard)for(var b="string"==typeof a?a.split(this.delimiter):a.slice(),d=f.call(this,null,b,this.listenerTree,0),e=0;e<d.length;e++){var g=d[e];g._listeners=null}else{if(!this._events[a])return this;this._events[a]=null}return this},e.prototype.listeners=function(a){if(this.wildcard){var b=[],d="string"==typeof a?a.split(this.delimiter):a.slice();return f.call(this,b,d,this.listenerTree,0),b}return this._events||c.call(this),this._events[a]||(this._events[a]=[]),h(this._events[a])||(this._events[a]=[this._events[a]]),this._events[a]},e.prototype.listenersAny=function(){return this._all?this._all:[]},"function"==typeof a&&a.amd?a(function(){return e}):b.EventEmitter2=e}("undefined"!=typeof b&&"undefined"!=typeof b.title&&"undefined"!=typeof d?d:window)}).call(this,b("/Users/jason/Dropbox/jetcode/scribe/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"))},{"/Users/jason/Dropbox/jetcode/scribe/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":8}],8:[function(a,b){var c=b.exports={};c.nextTick=function(){var a="undefined"!=typeof window&&window.setImmediate,b="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(a)return function(a){return window.setImmediate(a)};if(b){var c=[];return window.addEventListener("message",function(a){var b=a.source;if((b===window||null===b)&&"process-tick"===a.data&&(a.stopPropagation(),c.length>0)){var d=c.shift();d()}},!0),function(a){c.push(a),window.postMessage("process-tick","*")}}return function(a){setTimeout(a,0)}}(),c.title="browser",c.browser=!0,c.env={},c.argv=[],c.binding=function(){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(){throw new Error("process.chdir is not supported")}},{}],lodash:[function(a,b){b.exports=a("4HJaAd")},{}],"4HJaAd":[function(b,c,d){(function(b){(function(){function e(a,b,c){for(var d=(c||0)-1,e=a?a.length:0;++d<e;)if(a[d]===b)return d;return-1}function f(a,b){var c=typeof b;if(a=a.cache,"boolean"==c||null==b)return a[b]?0:-1;"number"!=c&&"string"!=c&&(c="object");var d="number"==c?b:x+b;return a=(a=a[c])&&a[d],"object"==c?a&&e(a,b)>-1?0:-1:a?0:-1}function g(a){var b=this.cache,c=typeof a;if("boolean"==c||null==a)b[a]=!0;else{"number"!=c&&"string"!=c&&(c="object");var d="number"==c?a:x+a,e=b[c]||(b[c]={});"object"==c?(e[d]||(e[d]=[])).push(a):e[d]=!0}}function h(a){return a.charCodeAt(0)}function i(a,b){for(var c=a.criteria,d=b.criteria,e=-1,f=c.length;++e<f;){var g=c[e],h=d[e];if(g!==h){if(g>h||"undefined"==typeof g)return 1;if(h>g||"undefined"==typeof h)return-1}}return a.index-b.index}function j(a){var b=-1,c=a.length,d=a[0],e=a[c/2|0],f=a[c-1];if(d&&"object"==typeof d&&e&&"object"==typeof e&&f&&"object"==typeof f)return!1;var h=m();h["false"]=h["null"]=h["true"]=h.undefined=!1;var i=m();for(i.array=a,i.cache=h,i.push=g;++b<c;)i.push(a[b]);return i}function k(a){return"\\"+cb[a]}function l(){return t.pop()||[]}function m(){return u.pop()||{array:null,cache:null,criteria:null,"false":!1,index:0,"null":!1,number:null,object:null,push:null,string:null,"true":!1,undefined:!1,value:null}}function n(a){return"function"!=typeof a.toString&&"string"==typeof(a+"")}function o(a){a.length=0,t.length<z&&t.push(a)}function p(a){var b=a.cache;b&&p(b),a.array=a.cache=a.criteria=a.object=a.number=a.string=a.value=null,u.length<z&&u.push(a)}function q(a,b,c){b||(b=0),"undefined"==typeof c&&(c=a?a.length:0);for(var d=-1,e=c-b||0,f=Array(0>e?0:e);++d<e;)f[d]=a[b+d];return f}function r(a){function b(a){return a&&"object"==typeof a&&!je(a)&&Qd.call(a,"__wrapped__")?a:new c(a)}function c(a,b){this.__chain__=!!b,this.__wrapped__=a}function d(a){function b(){if(d){var a=q(d);Rd.apply(a,arguments)}if(this instanceof b){var f=t(c.prototype),g=c.apply(f,a||arguments);return Kb(g)?g:f}return c.apply(e,a||arguments)}var c=a[0],d=a[2],e=a[4];return ie(b,a),b}function g(a,b,c,d,e){if(c){var f=c(a);if("undefined"!=typeof f)return f}var h=Kb(a);if(!h)return a;var i=Jd.call(a);if(!Z[i]||!ge.nodeClass&&n(a))return a;var j=ee[i];switch(i){case R:case S:return new j(+a);case V:case Y:return new j(a);case X:return f=j(a.source,F.exec(a)),f.lastIndex=a.lastIndex,f}var k=je(a);if(b){var m=!d;d||(d=l()),e||(e=l());for(var p=d.length;p--;)if(d[p]==a)return e[p];f=k?j(a.length):{}}else f=k?q(a):ue({},a);return k&&(Qd.call(a,"index")&&(f.index=a.index),Qd.call(a,"input")&&(f.input=a.input)),b?(d.push(a),e.push(f),(k?te:xe)(a,function(a,h){f[h]=g(a,b,c,d,e)}),m&&(o(d),o(e)),f):f}function t(a){return Kb(a)?Xd(a):{}}function u(a,b,c){if("function"!=typeof a)return dd;if("undefined"==typeof b||!("prototype"in a))return a;var d=a.__bindData__;if("undefined"==typeof d&&(ge.funcNames&&(d=!a.name),d=d||!ge.funcDecomp,!d)){var e=Od.call(a);ge.funcNames||(d=!G.test(e)),d||(d=K.test(e),ie(a,d))}if(d===!1||d!==!0&&1&d[1])return a;switch(c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)};case 4:return function(c,d,e,f){return a.call(b,c,d,e,f)}}return Oc(a,b)}function z(a){function b(){var a=i?g:this;if(e){var n=q(e);Rd.apply(n,arguments)}if((f||k)&&(n||(n=q(arguments)),f&&Rd.apply(n,f),k&&n.length<h))return d|=16,z([c,l?d:-4&d,n,null,g,h]);if(n||(n=arguments),j&&(c=a[m]),this instanceof b){a=t(c.prototype);var o=c.apply(a,n);return Kb(o)?o:a}return c.apply(a,n)}var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],i=1&d,j=2&d,k=4&d,l=8&d,m=c;return ie(b,a),b}function cb(a,b){var c=-1,d=ob(),g=a?a.length:0,h=g>=y&&d===e,i=[];if(h){var k=j(b);k?(d=f,b=k):h=!1}for(;++c<g;){var l=a[c];d(b,l)<0&&i.push(l)}return h&&p(b),i}function eb(a,b,c,d){for(var e=(d||0)-1,f=a?a.length:0,g=[];++e<f;){var h=a[e];if(h&&"object"==typeof h&&"number"==typeof h.length&&(je(h)||sb(h))){b||(h=eb(h,b,c));var i=-1,j=h.length,k=g.length;for(g.length+=j;++i<j;)g[k++]=h[i]}else c||g.push(h)}return g}function fb(a,b,c,d,e,f){if(c){var g=c(a,b);if("undefined"!=typeof g)return!!g}if(a===b)return 0!==a||1/a==1/b;var h=typeof a,i=typeof b;if(!(a!==a||a&&bb[h]||b&&bb[i]))return!1;if(null==a||null==b)return a===b;var j=Jd.call(a),k=Jd.call(b);if(j==P&&(j=W),k==P&&(k=W),j!=k)return!1;switch(j){case R:case S:return+a==+b;case V:return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case X:case Y:return a==Cd(b)}var m=j==Q;if(!m){var p=Qd.call(a,"__wrapped__"),q=Qd.call(b,"__wrapped__");if(p||q)return fb(p?a.__wrapped__:a,q?b.__wrapped__:b,c,d,e,f);if(j!=W||!ge.nodeClass&&(n(a)||n(b)))return!1;var r=!ge.argsObject&&sb(a)?Ad:a.constructor,s=!ge.argsObject&&sb(b)?Ad:b.constructor;if(r!=s&&!(Jb(r)&&r instanceof r&&Jb(s)&&s instanceof s)&&"constructor"in a&&"constructor"in b)return!1}var t=!e;e||(e=l()),f||(f=l());for(var u=e.length;u--;)if(e[u]==a)return f[u]==b;var v=0;if(g=!0,e.push(a),f.push(b),m){if(u=a.length,v=b.length,g=v==u,g||d)for(;v--;){var w=u,x=b[v];if(d)for(;w--&&!(g=fb(a[w],x,c,d,e,f)););else if(!(g=fb(a[v],x,c,d,e,f)))break}}else we(b,function(b,h,i){return Qd.call(i,h)?(v++,g=Qd.call(a,h)&&fb(a[h],b,c,d,e,f)):void 0}),g&&!d&&we(a,function(a,b,c){return Qd.call(c,b)?g=--v>-1:void 0});return e.pop(),f.pop(),t&&(o(e),o(f)),g}function gb(a,b,c,d,e){(je(b)?cc:xe)(b,function(b,f){var g,h,i=b,j=a[f];if(b&&((h=je(b))||ye(b))){for(var k=d.length;k--;)if(g=d[k]==b){j=e[k];break}if(!g){var l;c&&(i=c(j,b),(l="undefined"!=typeof i)&&(j=i)),l||(j=h?je(j)?j:[]:ye(j)?j:{}),d.push(b),e.push(j),l||gb(j,b,c,d,e)}}else c&&(i=c(j,b),"undefined"==typeof i&&(i=b)),"undefined"!=typeof i&&(j=i);a[f]=j})}function hb(a,b){return a+Nd(de()*(b-a+1))}function jb(a,b,c){var d=-1,g=ob(),h=a?a.length:0,i=[],k=!b&&h>=y&&g===e,m=c||k?l():i;if(k){var n=j(m);g=f,m=n}for(;++d<h;){var q=a[d],r=c?c(q,d,a):q;(b?!d||m[m.length-1]!==r:g(m,r)<0)&&((c||k)&&m.push(r),i.push(q))}return k?(o(m.array),p(m)):c&&o(m),i}function kb(a){return function(c,d,e){var f={};if(d=b.createCallback(d,e,3),je(c))for(var g=-1,h=c.length;++g<h;){var i=c[g];a(f,i,d(i,g,c),c)}else te(c,function(b,c,e){a(f,b,d(b,c,e),e)});return f}}function lb(a,b,c,e,f,g){var h=1&b,i=2&b,j=4&b,k=16&b,l=32&b;if(!i&&!Jb(a))throw new Dd;k&&!c.length&&(b&=-17,k=c=!1),l&&!e.length&&(b&=-33,l=e=!1);var m=a&&a.__bindData__;if(m&&m!==!0)return m=q(m),m[2]&&(m[2]=q(m[2])),m[3]&&(m[3]=q(m[3])),!h||1&m[1]||(m[4]=f),!h&&1&m[1]&&(b|=8),!j||4&m[1]||(m[5]=g),k&&Rd.apply(m[2]||(m[2]=[]),c),l&&Vd.apply(m[3]||(m[3]=[]),e),m[1]|=b,lb.apply(null,m);var n=1==b||17===b?d:z;return n([a,b,c,e,f,g])}function mb(){ab.shadowedProps=N,ab.support=ge,ab.array=ab.bottom=ab.loop=ab.top="",ab.init="iterable",ab.useHas=!0;for(var a,b=0;a=arguments[b];b++)for(var c in a)ab[c]=a[c];var d=ab.args;ab.firstArg=/^[^,]+/.exec(d)[0];var e=xd("baseCreateCallback, errorClass, errorProto, hasOwnProperty, indicatorObject, isArguments, isArray, isString, keys, objectProto, objectTypes, nonEnumProps, stringClass, stringProto, toString","return function("+d+") {\n"+he(ab)+"\n}");return e(u,T,Fd,Qd,w,sb,je,Pb,ab.keys,Gd,bb,fe,Y,Hd,Jd)}function nb(a){return pe[a]}function ob(){var a=(a=b.indexOf)===xc?e:a;return a}function pb(a){return"function"==typeof a&&Kd.test(a)}function qb(a){var b,c;return!a||Jd.call(a)!=W||(b=a.constructor,Jb(b)&&!(b instanceof b))||!ge.argsClass&&sb(a)||!ge.nodeClass&&n(a)?!1:ge.ownLast?(we(a,function(a,b,d){return c=Qd.call(d,b),!1}),c!==!1):(we(a,function(a,b){c=b}),"undefined"==typeof c||Qd.call(a,c))}function rb(a){return qe[a]}function sb(a){return a&&"object"==typeof a&&"number"==typeof a.length&&Jd.call(a)==P||!1}function tb(a,b,c,d){return"boolean"!=typeof b&&null!=b&&(d=c,c=b,b=!1),g(a,b,"function"==typeof c&&u(c,d,1))}function ub(a,b,c){return g(a,!0,"function"==typeof b&&u(b,c,1))}function vb(a,b){var c=t(a);return b?ue(c,b):c}function wb(a,c,d){var e;return c=b.createCallback(c,d,3),xe(a,function(a,b,d){return c(a,b,d)?(e=b,!1):void 0}),e}function xb(a,c,d){var e;return c=b.createCallback(c,d,3),zb(a,function(a,b,d){return c(a,b,d)?(e=b,!1):void 0}),e}function yb(a,b,c){var d=[];we(a,function(a,b){d.push(b,a)});var e=d.length;for(b=u(b,c,3);e--&&b(d[e--],d[e],a)!==!1;);return a}function zb(a,b,c){var d=le(a),e=d.length;for(b=u(b,c,3);e--;){var f=d[e];if(b(a[f],f,a)===!1)break}return a}function Ab(a){var b=[];return we(a,function(a,c){Jb(a)&&b.push(c)}),b.sort()}function Bb(a,b){return a?Qd.call(a,b):!1}function Cb(a){for(var b=-1,c=le(a),d=c.length,e={};++b<d;){var f=c[b];e[a[f]]=f}return e}function Db(a){return a===!0||a===!1||a&&"object"==typeof a&&Jd.call(a)==R||!1}function Eb(a){return a&&"object"==typeof a&&Jd.call(a)==S||!1}function Fb(a){return a&&1===a.nodeType||!1}function Gb(a){var b=!0;if(!a)return b;var c=Jd.call(a),d=a.length;return c==Q||c==Y||(ge.argsClass?c==P:sb(a))||c==W&&"number"==typeof d&&Jb(a.splice)?!d:(xe(a,function(){return b=!1}),b)}function Hb(a,b,c,d){return fb(a,b,"function"==typeof c&&u(c,d,2))}function Ib(a){return Zd(a)&&!$d(parseFloat(a))}function Jb(a){return"function"==typeof a}function Kb(a){return!(!a||!bb[typeof a])}function Lb(a){return Nb(a)&&a!=+a}function Mb(a){return null===a}function Nb(a){return"number"==typeof a||a&&"object"==typeof a&&Jd.call(a)==V||!1}function Ob(a){return a&&bb[typeof a]&&Jd.call(a)==X||!1}function Pb(a){return"string"==typeof a||a&&"object"==typeof a&&Jd.call(a)==Y||!1}function Qb(a){return"undefined"==typeof a}function Rb(a,c,d){var e={};return c=b.createCallback(c,d,3),xe(a,function(a,b,d){e[b]=c(a,b,d)}),e}function Sb(a){var b=arguments,c=2;if(!Kb(a))return a;if("number"!=typeof b[2]&&(c=b.length),c>3&&"function"==typeof b[c-2])var d=u(b[--c-1],b[c--],2);else c>2&&"function"==typeof b[c-1]&&(d=b[--c]);for(var e=q(arguments,1,c),f=-1,g=l(),h=l();++f<c;)gb(a,e[f],d,g,h);return o(g),o(h),a}function Tb(a,c,d){var e={};if("function"!=typeof c){var f=[];we(a,function(a,b){f.push(b)}),f=cb(f,eb(arguments,!0,!1,1));for(var g=-1,h=f.length;++g<h;){var i=f[g];e[i]=a[i]}}else c=b.createCallback(c,d,3),we(a,function(a,b,d){c(a,b,d)||(e[b]=a)});return e}function Ub(a){for(var b=-1,c=le(a),d=c.length,e=td(d);++b<d;){var f=c[b];
e[b]=[f,a[f]]}return e}function Vb(a,c,d){var e={};if("function"!=typeof c)for(var f=-1,g=eb(arguments,!0,!1,1),h=Kb(a)?g.length:0;++f<h;){var i=g[f];i in a&&(e[i]=a[i])}else c=b.createCallback(c,d,3),we(a,function(a,b,d){c(a,b,d)&&(e[b]=a)});return e}function Wb(a,c,d,e){var f=je(a);if(null==d)if(f)d=[];else{var g=a&&a.constructor,h=g&&g.prototype;d=t(h)}return c&&(c=b.createCallback(c,e,4),(f?te:xe)(a,function(a,b,e){return c(d,a,b,e)})),d}function Xb(a){for(var b=-1,c=le(a),d=c.length,e=td(d);++b<d;)e[b]=a[c[b]];return e}function Yb(a){var b=arguments,c=-1,d=eb(b,!0,!1,1),e=b[2]&&b[2][b[1]]===a?1:d.length,f=td(e);for(ge.unindexedChars&&Pb(a)&&(a=a.split(""));++c<e;)f[c]=a[d[c]];return f}function Zb(a,b,c){var d=-1,e=ob(),f=a?a.length:0,g=!1;return c=(0>c?ae(0,f+c):c)||0,je(a)?g=e(a,b,c)>-1:"number"==typeof f?g=(Pb(a)?a.indexOf(b,c):e(a,b,c))>-1:te(a,function(a){return++d>=c?!(g=a===b):void 0}),g}function $b(a,c,d){var e=!0;if(c=b.createCallback(c,d,3),je(a))for(var f=-1,g=a.length;++f<g&&(e=!!c(a[f],f,a)););else te(a,function(a,b,d){return e=!!c(a,b,d)});return e}function _b(a,c,d){var e=[];if(c=b.createCallback(c,d,3),je(a))for(var f=-1,g=a.length;++f<g;){var h=a[f];c(h,f,a)&&e.push(h)}else te(a,function(a,b,d){c(a,b,d)&&e.push(a)});return e}function ac(a,c,d){if(c=b.createCallback(c,d,3),!je(a)){var e;return te(a,function(a,b,d){return c(a,b,d)?(e=a,!1):void 0}),e}for(var f=-1,g=a.length;++f<g;){var h=a[f];if(c(h,f,a))return h}}function bc(a,c,d){var e;return c=b.createCallback(c,d,3),dc(a,function(a,b,d){return c(a,b,d)?(e=a,!1):void 0}),e}function cc(a,b,c){if(b&&"undefined"==typeof c&&je(a))for(var d=-1,e=a.length;++d<e&&b(a[d],d,a)!==!1;);else te(a,b,c);return a}function dc(a,b,c){var d=a,e=a?a.length:0;if(b=b&&"undefined"==typeof c?b:u(b,c,3),je(a))for(;e--&&b(a[e],e,a)!==!1;);else{if("number"!=typeof e){var f=le(a);e=f.length}else ge.unindexedChars&&Pb(a)&&(d=a.split(""));te(a,function(a,c,g){return c=f?f[--e]:--e,b(d[c],c,g)})}return a}function ec(a,b){var c=q(arguments,2),d=-1,e="function"==typeof b,f=a?a.length:0,g=td("number"==typeof f?f:0);return cc(a,function(a){g[++d]=(e?b:a[b]).apply(a,c)}),g}function fc(a,c,d){var e=-1,f=a?a.length:0,g=td("number"==typeof f?f:0);if(c=b.createCallback(c,d,3),je(a))for(;++e<f;)g[e]=c(a[e],e,a);else te(a,function(a,b,d){g[++e]=c(a,b,d)});return g}function gc(a,c,d){var e=-1/0,f=e;if("function"!=typeof c&&d&&d[c]===a&&(c=null),null==c&&je(a))for(var g=-1,i=a.length;++g<i;){var j=a[g];j>f&&(f=j)}else c=null==c&&Pb(a)?h:b.createCallback(c,d,3),te(a,function(a,b,d){var g=c(a,b,d);g>e&&(e=g,f=a)});return f}function hc(a,c,d){var e=1/0,f=e;if("function"!=typeof c&&d&&d[c]===a&&(c=null),null==c&&je(a))for(var g=-1,i=a.length;++g<i;){var j=a[g];f>j&&(f=j)}else c=null==c&&Pb(a)?h:b.createCallback(c,d,3),te(a,function(a,b,d){var g=c(a,b,d);e>g&&(e=g,f=a)});return f}function ic(a,c,d,e){var f=arguments.length<3;if(c=b.createCallback(c,e,4),je(a)){var g=-1,h=a.length;for(f&&(d=a[++g]);++g<h;)d=c(d,a[g],g,a)}else te(a,function(a,b,e){d=f?(f=!1,a):c(d,a,b,e)});return d}function jc(a,c,d,e){var f=arguments.length<3;return c=b.createCallback(c,e,4),dc(a,function(a,b,e){d=f?(f=!1,a):c(d,a,b,e)}),d}function kc(a,c,d){return c=b.createCallback(c,d,3),_b(a,function(a,b,d){return!c(a,b,d)})}function lc(a,b,c){if(a&&"number"!=typeof a.length?a=Xb(a):ge.unindexedChars&&Pb(a)&&(a=a.split("")),null==b||c)return a?a[hb(0,a.length-1)]:s;var d=mc(a);return d.length=be(ae(0,b),d.length),d}function mc(a){var b=-1,c=a?a.length:0,d=td("number"==typeof c?c:0);return cc(a,function(a){var c=hb(0,++b);d[b]=d[c],d[c]=a}),d}function nc(a){var b=a?a.length:0;return"number"==typeof b?b:le(a).length}function oc(a,c,d){var e;if(c=b.createCallback(c,d,3),je(a))for(var f=-1,g=a.length;++f<g&&!(e=c(a[f],f,a)););else te(a,function(a,b,d){return!(e=c(a,b,d))});return!!e}function pc(a,c,d){var e=-1,f=je(c),g=a?a.length:0,h=td("number"==typeof g?g:0);for(f||(c=b.createCallback(c,d,3)),cc(a,function(a,b,d){var g=h[++e]=m();f?g.criteria=fc(c,function(b){return a[b]}):(g.criteria=l())[0]=c(a,b,d),g.index=e,g.value=a}),g=h.length,h.sort(i);g--;){var j=h[g];h[g]=j.value,f||o(j.criteria),p(j)}return h}function qc(a){return a&&"number"==typeof a.length?ge.unindexedChars&&Pb(a)?a.split(""):q(a):Xb(a)}function rc(a){for(var b=-1,c=a?a.length:0,d=[];++b<c;){var e=a[b];e&&d.push(e)}return d}function sc(a){return cb(a,eb(arguments,!0,!0,1))}function tc(a,c,d){var e=-1,f=a?a.length:0;for(c=b.createCallback(c,d,3);++e<f;)if(c(a[e],e,a))return e;return-1}function uc(a,c,d){var e=a?a.length:0;for(c=b.createCallback(c,d,3);e--;)if(c(a[e],e,a))return e;return-1}function vc(a,c,d){var e=0,f=a?a.length:0;if("number"!=typeof c&&null!=c){var g=-1;for(c=b.createCallback(c,d,3);++g<f&&c(a[g],g,a);)e++}else if(e=c,null==e||d)return a?a[0]:s;return q(a,0,be(ae(0,e),f))}function wc(a,b,c,d){return"boolean"!=typeof b&&null!=b&&(d=c,c="function"!=typeof b&&d&&d[b]===a?null:b,b=!1),null!=c&&(a=fc(a,c,d)),eb(a,b)}function xc(a,b,c){if("number"==typeof c){var d=a?a.length:0;c=0>c?ae(0,d+c):c||0}else if(c){var f=Gc(a,b);return a[f]===b?f:-1}return e(a,b,c)}function yc(a,c,d){var e=0,f=a?a.length:0;if("number"!=typeof c&&null!=c){var g=f;for(c=b.createCallback(c,d,3);g--&&c(a[g],g,a);)e++}else e=null==c||d?1:c||e;return q(a,0,be(ae(0,f-e),f))}function zc(){for(var a=[],b=-1,c=arguments.length,d=l(),g=ob(),h=g===e,i=l();++b<c;){var k=arguments[b];(je(k)||sb(k))&&(a.push(k),d.push(h&&k.length>=y&&j(b?a[b]:i)))}var m=a[0],n=-1,q=m?m.length:0,r=[];a:for(;++n<q;){var s=d[0];if(k=m[n],(s?f(s,k):g(i,k))<0){for(b=c,(s||i).push(k);--b;)if(s=d[b],(s?f(s,k):g(a[b],k))<0)continue a;r.push(k)}}for(;c--;)s=d[c],s&&p(s);return o(d),o(i),r}function Ac(a,c,d){var e=0,f=a?a.length:0;if("number"!=typeof c&&null!=c){var g=f;for(c=b.createCallback(c,d,3);g--&&c(a[g],g,a);)e++}else if(e=c,null==e||d)return a?a[f-1]:s;return q(a,ae(0,f-e))}function Bc(a,b,c){var d=a?a.length:0;for("number"==typeof c&&(d=(0>c?ae(0,d+c):be(c,d-1))+1);d--;)if(a[d]===b)return d;return-1}function Cc(a){for(var b=arguments,c=0,d=b.length,e=a?a.length:0;++c<d;)for(var f=-1,g=b[c];++f<e;)a[f]===g&&(Ud.call(a,f--,1),e--);return a}function Dc(a,b,c){a=+a||0,c="number"==typeof c?c:+c||1,null==b&&(b=a,a=0);for(var d=-1,e=ae(0,Ld((b-a)/(c||1))),f=td(e);++d<e;)f[d]=a,a+=c;return f}function Ec(a,c,d){var e=-1,f=a?a.length:0,g=[];for(c=b.createCallback(c,d,3);++e<f;){var h=a[e];c(h,e,a)&&(g.push(h),Ud.call(a,e--,1),f--)}return g}function Fc(a,c,d){if("number"!=typeof c&&null!=c){var e=0,f=-1,g=a?a.length:0;for(c=b.createCallback(c,d,3);++f<g&&c(a[f],f,a);)e++}else e=null==c||d?1:ae(0,c);return q(a,e)}function Gc(a,c,d,e){var f=0,g=a?a.length:f;for(d=d?b.createCallback(d,e,1):dd,c=d(c);g>f;){var h=f+g>>>1;d(a[h])<c?f=h+1:g=h}return f}function Hc(){return jb(eb(arguments,!0,!0))}function Ic(a,c,d,e){return"boolean"!=typeof c&&null!=c&&(e=d,d="function"!=typeof c&&e&&e[c]===a?null:c,c=!1),null!=d&&(d=b.createCallback(d,e,3)),jb(a,c,d)}function Jc(a){return cb(a,q(arguments,1))}function Kc(){for(var a=-1,b=arguments.length;++a<b;){var c=arguments[a];if(je(c)||sb(c))var d=d?jb(cb(d,c).concat(cb(c,d))):c}return d||[]}function Lc(){for(var a=arguments.length>1?arguments:arguments[0],b=-1,c=a?gc(Ce(a,"length")):0,d=td(0>c?0:c);++b<c;)d[b]=Ce(a,b);return d}function Mc(a,b){var c=-1,d=a?a.length:0,e={};for(b||!d||je(a[0])||(b=[]);++c<d;){var f=a[c];b?e[f]=b[c]:f&&(e[f[0]]=f[1])}return e}function Nc(a,b){if(!Jb(b))throw new Dd;return function(){return--a<1?b.apply(this,arguments):void 0}}function Oc(a,b){return arguments.length>2?lb(a,17,q(arguments,2),null,b):lb(a,1,null,null,b)}function Pc(a){for(var b=arguments.length>1?eb(arguments,!0,!1,1):Ab(a),c=-1,d=b.length;++c<d;){var e=b[c];a[e]=lb(a[e],1,null,null,a)}return a}function Qc(a,b){return arguments.length>2?lb(b,19,q(arguments,2),null,a):lb(b,3,null,null,a)}function Rc(){for(var a=arguments,b=a.length;b--;)if(!Jb(a[b]))throw new Dd;return function(){for(var b=arguments,c=a.length;c--;)b=[a[c].apply(this,b)];return b[0]}}function Sc(a,b){return b="number"==typeof b?b:+b||a.length,lb(a,4,null,null,null,b)}function Tc(a,b,c){var d,e,f,g,h,i,j,k=0,l=!1,m=!0;if(!Jb(a))throw new Dd;if(b=ae(0,b)||0,c===!0){var n=!0;m=!1}else Kb(c)&&(n=c.leading,l="maxWait"in c&&(ae(b,c.maxWait)||0),m="trailing"in c?c.trailing:m);var o=function(){var c=b-(Ee()-g);if(0>=c){e&&Md(e);var l=j;e=i=j=s,l&&(k=Ee(),f=a.apply(h,d),i||e||(d=h=null))}else i=Td(o,c)},p=function(){i&&Md(i),e=i=j=s,(m||l!==b)&&(k=Ee(),f=a.apply(h,d),i||e||(d=h=null))};return function(){if(d=arguments,g=Ee(),h=this,j=m&&(i||!n),l===!1)var c=n&&!i;else{e||n||(k=g);var q=l-(g-k),r=0>=q;r?(e&&(e=Md(e)),k=g,f=a.apply(h,d)):e||(e=Td(p,q))}return r&&i?i=Md(i):i||b===l||(i=Td(o,b)),c&&(r=!0,f=a.apply(h,d)),!r||i||e||(d=h=null),f}}function Uc(a){if(!Jb(a))throw new Dd;var b=q(arguments,1);return Td(function(){a.apply(s,b)},1)}function Vc(a,b){if(!Jb(a))throw new Dd;var c=q(arguments,2);return Td(function(){a.apply(s,c)},b)}function Wc(a,b){if(!Jb(a))throw new Dd;var c=function(){var d=c.cache,e=b?b.apply(this,arguments):x+arguments[0];return Qd.call(d,e)?d[e]:d[e]=a.apply(this,arguments)};return c.cache={},c}function Xc(a){var b,c;if(!Jb(a))throw new Dd;return function(){return b?c:(b=!0,c=a.apply(this,arguments),a=null,c)}}function Yc(a){return lb(a,16,q(arguments,1))}function Zc(a){return lb(a,32,null,q(arguments,1))}function $c(a,b,c){var d=!0,e=!0;if(!Jb(a))throw new Dd;return c===!1?d=!1:Kb(c)&&(d="leading"in c?c.leading:d,e="trailing"in c?c.trailing:e),$.leading=d,$.maxWait=b,$.trailing=e,Tc(a,b,$)}function _c(a,b){return lb(b,16,[a])}function ad(a){return function(){return a}}function bd(a,b,c){var d=typeof a;if(null==a||"function"==d)return u(a,b,c);if("object"!=d)return hd(a);var e=le(a),f=e[0],g=a[f];return 1!=e.length||g!==g||Kb(g)?function(b){for(var c=e.length,d=!1;c--&&(d=fb(b[e[c]],a[e[c]],null,!0)););return d}:function(a){var b=a[f];return g===b&&(0!==g||1/g==1/b)}}function cd(a){return null==a?"":Cd(a).replace(se,nb)}function dd(a){return a}function ed(a,d,e){var f=!0,g=d&&Ab(d);d&&(e||g.length)||(null==e&&(e=d),h=c,d=a,a=b,g=Ab(d)),e===!1?f=!1:Kb(e)&&"chain"in e&&(f=e.chain);var h=a,i=Jb(h);cc(g,function(b){var c=a[b]=d[b];i&&(h.prototype[b]=function(){var b=this.__chain__,d=this.__wrapped__,e=[d];Rd.apply(e,arguments);var g=c.apply(a,e);if(f||b){if(d===g&&Kb(g))return this;g=new h(g),g.__chain__=b}return g})})}function fd(){return a._=Id,this}function gd(){}function hd(a){return function(b){return b[a]}}function id(a,b,c){var d=null==a,e=null==b;if(null==c&&("boolean"==typeof a&&e?(c=a,a=1):e||"boolean"!=typeof b||(c=b,e=!0)),d&&e&&(b=1),a=+a||0,e?(b=a,a=0):b=+b||0,c||a%1||b%1){var f=de();return be(a+f*(b-a+parseFloat("1e-"+((f+"").length-1))),b)}return hb(a,b)}function jd(a,b){if(a){var c=a[b];return Jb(c)?a[b]():c}}function kd(a,c,d){var e=b.templateSettings;a=Cd(a||""),d=he?ve({},d,e):e;var f,g=he&&ve({},d.imports,e.imports),h=he?le(g):["_"],i=he?Xb(g):[b],j=0,l=d.interpolate||J,m="__p += '",n=Bd((d.escape||J).source+"|"+l.source+"|"+(l===H?E:J).source+"|"+(d.evaluate||J).source+"|$","g");a.replace(n,function(b,c,d,e,g,h){return d||(d=e),m+=a.slice(j,h).replace(L,k),c&&(m+="' +\n__e("+c+") +\n'"),g&&(f=!0,m+="';\n"+g+";\n__p += '"),d&&(m+="' +\n((__t = ("+d+")) == null ? '' : __t) +\n'"),j=h+b.length,b}),m+="';\n";var o=d.variable,p=o;p||(o="obj",m="with ("+o+") {\n"+m+"\n}\n"),m=(f?m.replace(B,""):m).replace(C,"$1").replace(D,"$1;"),m="function("+o+") {\n"+(p?"":o+" || ("+o+" = {});\n")+"var __t, __p = '', __e = _.escape"+(f?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+m+"return __p\n}";var q="\n/*\n//# sourceURL="+(d.sourceURL||"/lodash/template/source["+O++ +"]")+"\n*/";try{var r=xd(h,"return "+m+q).apply(s,i)}catch(t){throw t.source=m,t}return c?r(c):(r.source=m,r)}function ld(a,b,c){a=(a=+a)>-1?a:0;var d=-1,e=td(a);for(b=u(b,c,1);++d<a;)e[d]=b(d);return e}function md(a){return null==a?"":Cd(a).replace(re,rb)}function nd(a){var b=++v;return Cd(null==a?"":a)+b}function od(a){return a=new c(a),a.__chain__=!0,a}function pd(a,b){return b(a),a}function qd(){return this.__chain__=!0,this}function rd(){return Cd(this.__wrapped__)}function sd(){return this.__wrapped__}a=a?ib.defaults(db.Object(),a,ib.pick(db,M)):db;var td=a.Array,ud=a.Boolean,vd=a.Date,wd=a.Error,xd=a.Function,yd=a.Math,zd=a.Number,Ad=a.Object,Bd=a.RegExp,Cd=a.String,Dd=a.TypeError,Ed=[],Fd=wd.prototype,Gd=Ad.prototype,Hd=Cd.prototype,Id=a._,Jd=Gd.toString,Kd=Bd("^"+Cd(Jd).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),Ld=yd.ceil,Md=a.clearTimeout,Nd=yd.floor,Od=xd.prototype.toString,Pd=pb(Pd=Ad.getPrototypeOf)&&Pd,Qd=Gd.hasOwnProperty,Rd=Ed.push,Sd=Gd.propertyIsEnumerable,Td=a.setTimeout,Ud=Ed.splice,Vd=Ed.unshift,Wd=function(){try{var a={},b=pb(b=Ad.defineProperty)&&b,c=b(a,a,a)&&b}catch(d){}return c}(),Xd=pb(Xd=Ad.create)&&Xd,Yd=pb(Yd=td.isArray)&&Yd,Zd=a.isFinite,$d=a.isNaN,_d=pb(_d=Ad.keys)&&_d,ae=yd.max,be=yd.min,ce=a.parseInt,de=yd.random,ee={};ee[Q]=td,ee[R]=ud,ee[S]=vd,ee[U]=xd,ee[W]=Ad,ee[V]=zd,ee[X]=Bd,ee[Y]=Cd;var fe={};fe[Q]=fe[S]=fe[V]={constructor:!0,toLocaleString:!0,toString:!0,valueOf:!0},fe[R]=fe[Y]={constructor:!0,toString:!0,valueOf:!0},fe[T]=fe[U]=fe[X]={constructor:!0,toString:!0},fe[W]={constructor:!0},function(){for(var a=N.length;a--;){var b=N[a];for(var c in fe)Qd.call(fe,c)&&!Qd.call(fe[c],b)&&(fe[c][b]=!1)}}(),c.prototype=b.prototype;var ge=b.support={};!function(){var b=function(){this.x=1},c={0:1,length:1},d=[];b.prototype={valueOf:1,y:1};for(var e in new b)d.push(e);for(e in arguments);ge.argsClass=Jd.call(arguments)==P,ge.argsObject=arguments.constructor==Ad&&!(arguments instanceof td),ge.enumErrorProps=Sd.call(Fd,"message")||Sd.call(Fd,"name"),ge.enumPrototypes=Sd.call(b,"prototype"),ge.funcDecomp=!pb(a.WinRTError)&&K.test(r),ge.funcNames="string"==typeof xd.name,ge.nonEnumArgs=0!=e,ge.nonEnumShadows=!/valueOf/.test(d),ge.ownLast="x"!=d[0],ge.spliceObjects=(Ed.splice.call(c,0,1),!c[0]),ge.unindexedChars="x"[0]+Ad("x")[0]!="xx";try{ge.nodeClass=!(Jd.call(document)==W&&!({toString:0}+""))}catch(f){ge.nodeClass=!0}}(1),b.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:H,variable:"",imports:{_:b}};var he=kd("var index, iterable = <%= firstArg %>, result = <%= init %>;\nif (!iterable) return result;\n<%= top %>;<% if (array) { %>\nvar length = iterable.length; index = -1;\nif (<%= array %>) {  <% if (support.unindexedChars) { %>\n  if (isString(iterable)) {\n    iterable = iterable.split('')\n  }  <% } %>\n  while (++index < length) {\n    <%= loop %>;\n  }\n}\nelse {  <% } else if (support.nonEnumArgs) { %>\n  var length = iterable.length; index = -1;\n  if (length && isArguments(iterable)) {\n    while (++index < length) {\n      index += '';\n      <%= loop %>;\n    }\n  } else {  <% } %>  <% if (support.enumPrototypes) { %>\n  var skipProto = typeof iterable == 'function';\n  <% } %>  <% if (support.enumErrorProps) { %>\n  var skipErrorProps = iterable === errorProto || iterable instanceof Error;\n  <% } %>  <%    var conditions = [];    if (support.enumPrototypes) { conditions.push('!(skipProto && index == \"prototype\")'); }    if (support.enumErrorProps)  { conditions.push('!(skipErrorProps && (index == \"message\" || index == \"name\"))'); }  %>  <% if (useHas && keys) { %>\n  var ownIndex = -1,\n      ownProps = objectTypes[typeof iterable] && keys(iterable),\n      length = ownProps ? ownProps.length : 0;\n\n  while (++ownIndex < length) {\n    index = ownProps[ownIndex];\n<%    if (conditions.length) { %>    if (<%= conditions.join(' && ') %>) {\n  <% } %>    <%= loop %>;    <% if (conditions.length) { %>\n    }<% } %>\n  }  <% } else { %>\n  for (index in iterable) {\n<%    if (useHas) { conditions.push(\"hasOwnProperty.call(iterable, index)\"); }    if (conditions.length) { %>    if (<%= conditions.join(' && ') %>) {\n  <% } %>    <%= loop %>;    <% if (conditions.length) { %>\n    }<% } %>\n  }    <% if (support.nonEnumShadows) { %>\n\n  if (iterable !== objectProto) {\n    var ctor = iterable.constructor,\n        isProto = iterable === (ctor && ctor.prototype),\n        className = iterable === stringProto ? stringClass : iterable === errorProto ? errorClass : toString.call(iterable),\n        nonEnum = nonEnumProps[className];\n      <% for (k = 0; k < 7; k++) { %>\n    index = '<%= shadowedProps[k] %>';\n    if ((!(isProto && nonEnum[index]) && hasOwnProperty.call(iterable, index))<%        if (!useHas) { %> || (!nonEnum[index] && iterable[index] !== objectProto[index])<% }      %>) {\n      <%= loop %>;\n    }      <% } %>\n  }    <% } %>  <% } %>  <% if (array || support.nonEnumArgs) { %>\n}<% } %>\n<%= bottom %>;\nreturn result");Xd||(t=function(){function b(){}return function(c){if(Kb(c)){b.prototype=c;var d=new b;b.prototype=null}return d||a.Object()}}());var ie=Wd?function(a,b){_.value=b,Wd(a,"__bindData__",_)}:gd;ge.argsClass||(sb=function(a){return a&&"object"==typeof a&&"number"==typeof a.length&&Qd.call(a,"callee")&&!Sd.call(a,"callee")||!1});var je=Yd||function(a){return a&&"object"==typeof a&&"number"==typeof a.length&&Jd.call(a)==Q||!1},ke=mb({args:"object",init:"[]",top:"if (!(objectTypes[typeof object])) return result",loop:"result.push(index)"}),le=_d?function(a){return Kb(a)?ge.enumPrototypes&&"function"==typeof a||ge.nonEnumArgs&&a.length&&sb(a)?ke(a):_d(a):[]}:ke,me={args:"collection, callback, thisArg",top:"callback = callback && typeof thisArg == 'undefined' ? callback : baseCreateCallback(callback, thisArg, 3)",array:"typeof length == 'number'",keys:le,loop:"if (callback(iterable[index], index, collection) === false) return result"},ne={args:"object, source, guard",top:"var args = arguments,\n    argsIndex = 0,\n    argsLength = typeof guard == 'number' ? 2 : args.length;\nwhile (++argsIndex < argsLength) {\n  iterable = args[argsIndex];\n  if (iterable && objectTypes[typeof iterable]) {",keys:le,loop:"if (typeof result[index] == 'undefined') result[index] = iterable[index]",bottom:"  }\n}"},oe={top:"if (!objectTypes[typeof iterable]) return result;\n"+me.top,array:!1},pe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},qe=Cb(pe),re=Bd("("+le(qe).join("|")+")","g"),se=Bd("["+le(pe).join("")+"]","g"),te=mb(me),ue=mb(ne,{top:ne.top.replace(";",";\nif (argsLength > 3 && typeof args[argsLength - 2] == 'function') {\n  var callback = baseCreateCallback(args[--argsLength - 1], args[argsLength--], 2);\n} else if (argsLength > 2 && typeof args[argsLength - 1] == 'function') {\n  callback = args[--argsLength];\n}"),loop:"result[index] = callback ? callback(result[index], iterable[index]) : iterable[index]"}),ve=mb(ne),we=mb(me,oe,{useHas:!1}),xe=mb(me,oe);Jb(/x/)&&(Jb=function(a){return"function"==typeof a&&Jd.call(a)==U});var ye=Pd?function(a){if(!a||Jd.call(a)!=W||!ge.argsClass&&sb(a))return!1;var b=a.valueOf,c=pb(b)&&(c=Pd(b))&&Pd(c);return c?a==c||Pd(a)==c:qb(a)}:qb,ze=kb(function(a,b,c){Qd.call(a,c)?a[c]++:a[c]=1}),Ae=kb(function(a,b,c){(Qd.call(a,c)?a[c]:a[c]=[]).push(b)}),Be=kb(function(a,b,c){a[c]=b}),Ce=fc,De=_b,Ee=pb(Ee=vd.now)&&Ee||function(){return(new vd).getTime()},Fe=8==ce(A+"08")?ce:function(a,b){return ce(Pb(a)?a.replace(I,""):a,b||0)};return b.after=Nc,b.assign=ue,b.at=Yb,b.bind=Oc,b.bindAll=Pc,b.bindKey=Qc,b.chain=od,b.compact=rc,b.compose=Rc,b.constant=ad,b.countBy=ze,b.create=vb,b.createCallback=bd,b.curry=Sc,b.debounce=Tc,b.defaults=ve,b.defer=Uc,b.delay=Vc,b.difference=sc,b.filter=_b,b.flatten=wc,b.forEach=cc,b.forEachRight=dc,b.forIn=we,b.forInRight=yb,b.forOwn=xe,b.forOwnRight=zb,b.functions=Ab,b.groupBy=Ae,b.indexBy=Be,b.initial=yc,b.intersection=zc,b.invert=Cb,b.invoke=ec,b.keys=le,b.map=fc,b.mapValues=Rb,b.max=gc,b.memoize=Wc,b.merge=Sb,b.min=hc,b.omit=Tb,b.once=Xc,b.pairs=Ub,b.partial=Yc,b.partialRight=Zc,b.pick=Vb,b.pluck=Ce,b.property=hd,b.pull=Cc,b.range=Dc,b.reject=kc,b.remove=Ec,b.rest=Fc,b.shuffle=mc,b.sortBy=pc,b.tap=pd,b.throttle=$c,b.times=ld,b.toArray=qc,b.transform=Wb,b.union=Hc,b.uniq=Ic,b.values=Xb,b.where=De,b.without=Jc,b.wrap=_c,b.xor=Kc,b.zip=Lc,b.zipObject=Mc,b.collect=fc,b.drop=Fc,b.each=cc,b.eachRight=dc,b.extend=ue,b.methods=Ab,b.object=Mc,b.select=_b,b.tail=Fc,b.unique=Ic,b.unzip=Lc,ed(b),b.clone=tb,b.cloneDeep=ub,b.contains=Zb,b.escape=cd,b.every=$b,b.find=ac,b.findIndex=tc,b.findKey=wb,b.findLast=bc,b.findLastIndex=uc,b.findLastKey=xb,b.has=Bb,b.identity=dd,b.indexOf=xc,b.isArguments=sb,b.isArray=je,b.isBoolean=Db,b.isDate=Eb,b.isElement=Fb,b.isEmpty=Gb,b.isEqual=Hb,b.isFinite=Ib,b.isFunction=Jb,b.isNaN=Lb,b.isNull=Mb,b.isNumber=Nb,b.isObject=Kb,b.isPlainObject=ye,b.isRegExp=Ob,b.isString=Pb,b.isUndefined=Qb,b.lastIndexOf=Bc,b.mixin=ed,b.noConflict=fd,b.noop=gd,b.now=Ee,b.parseInt=Fe,b.random=id,b.reduce=ic,b.reduceRight=jc,b.result=jd,b.runInContext=r,b.size=nc,b.some=oc,b.sortedIndex=Gc,b.template=kd,b.unescape=md,b.uniqueId=nd,b.all=$b,b.any=oc,b.detect=ac,b.findWhere=ac,b.foldl=ic,b.foldr=jc,b.include=Zb,b.inject=ic,ed(function(){var a={};return xe(b,function(c,d){b.prototype[d]||(a[d]=c)}),a}(),!1),b.first=vc,b.last=Ac,b.sample=lc,b.take=vc,b.head=vc,xe(b,function(a,d){var e="sample"!==d;b.prototype[d]||(b.prototype[d]=function(b,d){var f=this.__chain__,g=a(this.__wrapped__,b,d);return f||null!=b&&(!d||e&&"function"==typeof b)?new c(g,f):g})}),b.VERSION="2.4.1",b.prototype.chain=qd,b.prototype.toString=rd,b.prototype.value=sd,b.prototype.valueOf=sd,te(["join","pop","shift"],function(a){var d=Ed[a];b.prototype[a]=function(){var a=this.__chain__,b=d.apply(this.__wrapped__,arguments);return a?new c(b,a):b}}),te(["push","reverse","sort","unshift"],function(a){var c=Ed[a];b.prototype[a]=function(){return c.apply(this.__wrapped__,arguments),this}}),te(["concat","slice","splice"],function(a){var d=Ed[a];b.prototype[a]=function(){return new c(d.apply(this.__wrapped__,arguments),this.__chain__)}}),ge.spliceObjects||te(["pop","shift","splice"],function(a){var d=Ed[a],e="splice"==a;b.prototype[a]=function(){var a=this.__chain__,b=this.__wrapped__,f=d.apply(b,arguments);return 0===b.length&&delete b[0],a||e?new c(f,a):f}}),b._baseEach=te,b._iteratorTemplate=he,b._shimKeys=ke,b}var s,t=[],u=[],v=0,w={},x=+new Date+"",y=75,z=40,A="   \f ﻿\n\r\u2028\u2029 ᠎             　",B=/\b__p \+= '';/g,C=/\b(__p \+=) '' \+/g,D=/(__e\(.*?\)|\b__t\)) \+\n'';/g,E=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,F=/\w*$/,G=/^\s*function[ \n\r\t]+\w/,H=/<%=([\s\S]+?)%>/g,I=RegExp("^["+A+"]*0+(?=.$)"),J=/($^)/,K=/\bthis\b/,L=/['\n\r\t\u2028\u2029\\]/g,M=["Array","Boolean","Date","Error","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setTimeout"],N=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],O=0,P="[object Arguments]",Q="[object Array]",R="[object Boolean]",S="[object Date]",T="[object Error]",U="[object Function]",V="[object Number]",W="[object Object]",X="[object RegExp]",Y="[object String]",Z={};Z[U]=!1,Z[P]=Z[Q]=Z[R]=Z[S]=Z[V]=Z[W]=Z[X]=Z[Y]=!0;var $={leading:!1,maxWait:0,trailing:!1},_={configurable:!1,enumerable:!1,value:null,writable:!1},ab={args:"",array:null,bottom:"",firstArg:"",init:"",keys:null,loop:"",shadowedProps:null,support:null,top:"",useHas:!1},bb={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},cb={"\\":"\\","'":"'","\n":"n","\r":"r"," ":"t","\u2028":"u2028","\u2029":"u2029"},db=bb[typeof window]&&window||this,eb=bb[typeof d]&&d&&!d.nodeType&&d,fb=bb[typeof c]&&c&&!c.nodeType&&c,gb=fb&&fb.exports===eb&&eb,hb=bb[typeof b]&&b;!hb||hb.global!==hb&&hb.window!==hb||(db=hb);var ib=r();"function"==typeof a&&"object"==typeof a.amd&&a.amd?(db._=ib,a(function(){return ib})):eb&&fb?gb?(fb.exports=ib)._=ib:eb._=ib:db._=ib}).call(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],rmqf9t:[function(a,b){(function(a){(function(a,b,c,d){window.rangy=function(){function a(a,b){var c=typeof a[b];return c==l||!(c!=k||!a[b])||"unknown"==c}function b(a,b){return!(typeof a[b]!=k||!a[b])}function c(a,b){return typeof a[b]!=m}function d(a){return function(b,c){for(var d=c.length;d--;)if(!a(b,c[d]))return!1;return!0}}function e(a){return a&&r(a,q)&&t(a,p)}function f(a){window.alert("Rangy not supported in your browser. Reason: "+a),u.initialized=!0,u.supported=!1}function g(a){var b="Rangy warning: "+a;u.config.alertOnWarn?window.alert(b):typeof window.console!=m&&typeof window.console.log!=m&&window.console.log(b)}function h(){if(!u.initialized){var c,d=!1,g=!1;a(document,"createRange")&&(c=document.createRange(),r(c,o)&&t(c,n)&&(d=!0),c.detach());var h=b(document,"body")?document.body:document.getElementsByTagName("body")[0];h&&a(h,"createTextRange")&&(c=h.createTextRange(),e(c)&&(g=!0)),d||g||f("Neither Range nor TextRange are implemented"),u.initialized=!0,u.features={implementsDomRange:d,implementsTextRange:g};for(var i=w.concat(v),j=0,k=i.length;k>j;++j)try{i[j](u)}catch(l){b(window,"console")&&a(window.console,"log")&&window.console.log("Init listener threw an exception. Continuing.",l)}}}function i(a){a=a||window,h();for(var b=0,c=x.length;c>b;++b)x[b](a)}function j(a){this.name=a,this.initialized=!1,this.supported=!1}var k="object",l="function",m="undefined",n=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer","START_TO_START","START_TO_END","END_TO_START","END_TO_END"],o=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],p=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],q=["collapse","compareEndPoints","duplicate","getBookmark","moveToBookmark","moveToElementText","parentElement","pasteHTML","select","setEndPoint","getBoundingClientRect"],r=d(a),s=d(b),t=d(c),u={version:"1.2.3",initialized:!1,supported:!0,util:{isHostMethod:a,isHostObject:b,isHostProperty:c,areHostMethods:r,areHostObjects:s,areHostProperties:t,isTextRange:e},features:{},modules:{},config:{alertOnWarn:!1,preferTextRange:!1}};u.fail=f,u.warn=g,{}.hasOwnProperty?u.util.extend=function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])}:f("hasOwnProperty not supported");var v=[],w=[];u.init=h,u.addInitListener=function(a){u.initialized?a(u):v.push(a)};var x=[];u.addCreateMissingNativeApiListener=function(a){x.push(a)},u.createMissingNativeApi=i,j.prototype.fail=function(a){throw this.initialized=!0,this.supported=!1,new Error("Module '"+this.name+"' failed to load: "+a)},j.prototype.warn=function(a){u.warn("Module "+this.name+": "+a)},j.prototype.createError=function(a){return new Error("Error in Rangy "+this.name+" module: "+a)},u.createModule=function(a,b){var c=new j(a);u.modules[a]=c,w.push(function(a){b(a,c),c.initialized=!0,c.supported=!0})},u.requireModules=function(a){for(var b,c,d=0,e=a.length;e>d;++d){if(c=a[d],b=u.modules[c],!(b&&b instanceof j))throw new Error("Module '"+c+"' not found");if(!b.supported)throw new Error("Module '"+c+"' not supported")}};var y=!1,z=function(){y||(y=!0,u.initialized||h())};return typeof window==m?void f("No window found"):typeof document==m?void f("No document found"):(a(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",z,!1),a(window,"addEventListener")?window.addEventListener("load",z,!1):a(window,"attachEvent")?window.attachEvent("onload",z):f("Window does not have required addEventListener or attachEvent method"),u)}(),rangy.createModule("DomUtil",function(a,b){function c(a){var b;return typeof a.namespaceURI==z||null===(b=a.namespaceURI)||"http://www.w3.org/1999/xhtml"==b}function d(a){var b=a.parentNode;return 1==b.nodeType?b:null}function e(a){for(var b=0;a=a.previousSibling;)b++;return b}function f(a){var b;return j(a)?a.length:(b=a.childNodes)?b.length:0}function g(a,b){var c,d=[];for(c=a;c;c=c.parentNode)d.push(c);for(c=b;c;c=c.parentNode)if(D(d,c))return c;return null}function h(a,b,c){for(var d=c?b:b.parentNode;d;){if(d===a)return!0;d=d.parentNode}return!1}function i(a,b,c){for(var d,e=c?a:a.parentNode;e;){if(d=e.parentNode,d===b)return e;e=d}return null}function j(a){var b=a.nodeType;return 3==b||4==b||8==b}function k(a,b){var c=b.nextSibling,d=b.parentNode;return c?d.insertBefore(a,c):d.appendChild(a),a}function l(a,b){var c=a.cloneNode(!1);return c.deleteData(0,b),a.deleteData(b,a.length-b),k(c,a),c}function m(a){if(9==a.nodeType)return a;if(typeof a.ownerDocument!=z)return a.ownerDocument;if(typeof a.document!=z)return a.document;if(a.parentNode)return m(a.parentNode);throw new Error("getDocument: no document found for node")}function n(a){var b=m(a);if(typeof b.defaultView!=z)return b.defaultView;if(typeof b.parentWindow!=z)return b.parentWindow;throw new Error("Cannot get a window object for node")}function o(a){if(typeof a.contentDocument!=z)return a.contentDocument;if(typeof a.contentWindow!=z)return a.contentWindow.document;throw new Error("getIframeWindow: No Document object found for iframe element")}function p(a){if(typeof a.contentWindow!=z)return a.contentWindow;if(typeof a.contentDocument!=z)return a.contentDocument.defaultView;throw new Error("getIframeWindow: No Window object found for iframe element")}function q(a){return A.isHostObject(a,"body")?a.body:a.getElementsByTagName("body")[0]}function r(a){for(var b;b=a.parentNode;)a=b;return a}function s(a,b,c,d){var f,h,j,k,l;if(a==c)return b===d?0:d>b?-1:1;if(f=i(c,a,!0))return b<=e(f)?-1:1;if(f=i(a,c,!0))return e(f)<d?-1:1;if(h=g(a,c),j=a===h?h:i(a,h,!0),k=c===h?h:i(c,h,!0),j===k)throw new Error("comparePoints got to case 4 and childA and childB are the same!");for(l=h.firstChild;l;){if(l===j)return-1;if(l===k)return 1;l=l.nextSibling}throw new Error("Should not be here!")}function t(a){for(var b,c=m(a).createDocumentFragment();b=a.firstChild;)c.appendChild(b);return c}function u(a){if(!a)return"[No node]";if(j(a))return'"'+a.data+'"';if(1==a.nodeType){var b=a.id?' id="'+a.id+'"':"";return"<"+a.nodeName+b+">["+a.childNodes.length+"]"}return a.nodeName}function v(a){this.root=a,this._next=a}function w(a){return new v(a)}function x(a,b){this.node=a,this.offset=b}function y(a){this.code=this[a],this.codeName=a,this.message="DOMException: "+this.codeName}var z="undefined",A=a.util;A.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||b.fail("document missing a Node creation method"),A.isHostMethod(document,"getElementsByTagName")||b.fail("document missing getElementsByTagName method");var B=document.createElement("div");A.areHostMethods(B,["insertBefore","appendChild","cloneNode"]||!A.areHostObjects(B,["previousSibling","nextSibling","childNodes","parentNode"]))||b.fail("Incomplete Element implementation"),A.isHostProperty(B,"innerHTML")||b.fail("Element is missing innerHTML property");var C=document.createTextNode("test");A.areHostMethods(C,["splitText","deleteData","insertData","appendData","cloneNode"]||!A.areHostObjects(B,["previousSibling","nextSibling","childNodes","parentNode"])||!A.areHostProperties(C,["data"]))||b.fail("Incomplete Text Node implementation");var D=function(a,b){for(var c=a.length;c--;)if(a[c]===b)return!0;return!1};v.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var a,b,c=this._current=this._next;if(this._current)if(a=c.firstChild)this._next=a;else{for(b=null;c!==this.root&&!(b=c.nextSibling);)c=c.parentNode;this._next=b}return this._current},detach:function(){this._current=this._next=this.root=null}},x.prototype={equals:function(a){return this.node===a.node&this.offset==a.offset},inspect:function(){return"[DomPosition("+u(this.node)+":"+this.offset+")]"}},y.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11},y.prototype.toString=function(){return this.message
},a.dom={arrayContains:D,isHtmlNamespace:c,parentElement:d,getNodeIndex:e,getNodeLength:f,getCommonAncestor:g,isAncestorOf:h,getClosestAncestorIn:i,isCharacterDataNode:j,insertAfter:k,splitDataNode:l,getDocument:m,getWindow:n,getIframeWindow:p,getIframeDocument:o,getBody:q,getRootContainer:r,comparePoints:s,inspectNode:u,fragmentFromNodeChildren:t,createIterator:w,DomPosition:x},a.DOMException=y}),rangy.createModule("DomRange",function(a){function b(a,b){return 3!=a.nodeType&&(L.isAncestorOf(a,b.startContainer,!0)||L.isAncestorOf(a,b.endContainer,!0))}function c(a){return L.getDocument(a.startContainer)}function d(a,b,c){var d=a._listeners[b];if(d)for(var e=0,f=d.length;f>e;++e)d[e].call(a,{target:a,args:c})}function e(a){return new M(a.parentNode,L.getNodeIndex(a))}function f(a){return new M(a.parentNode,L.getNodeIndex(a)+1)}function g(a,b,c){var d=11==a.nodeType?a.firstChild:a;return L.isCharacterDataNode(b)?c==b.length?L.insertAfter(a,b):b.parentNode.insertBefore(a,0==c?b:L.splitDataNode(b,c)):c>=b.childNodes.length?b.appendChild(a):b.insertBefore(a,b.childNodes[c]),d}function h(a){for(var b,d,e,f=c(a.range).createDocumentFragment();d=a.next();){if(b=a.isPartiallySelectedSubtree(),d=d.cloneNode(!b),b&&(e=a.getSubtreeIterator(),d.appendChild(h(e)),e.detach(!0)),10==d.nodeType)throw new N("HIERARCHY_REQUEST_ERR");f.appendChild(d)}return f}function i(a,b,c){var d,e;c=c||{stop:!1};for(var f,g;f=a.next();)if(a.isPartiallySelectedSubtree()){if(b(f)===!1)return void(c.stop=!0);if(g=a.getSubtreeIterator(),i(g,b,c),g.detach(!0),c.stop)return}else for(d=L.createIterator(f);e=d.next();)if(b(e)===!1)return void(c.stop=!0)}function j(a){for(var b;a.next();)a.isPartiallySelectedSubtree()?(b=a.getSubtreeIterator(),j(b),b.detach(!0)):a.remove()}function k(a){for(var b,d,e=c(a.range).createDocumentFragment();b=a.next();){if(a.isPartiallySelectedSubtree()?(b=b.cloneNode(!1),d=a.getSubtreeIterator(),b.appendChild(k(d)),d.detach(!0)):a.remove(),10==b.nodeType)throw new N("HIERARCHY_REQUEST_ERR");e.appendChild(b)}return e}function l(a,b,c){var d,e=!(!b||!b.length),f=!!c;e&&(d=new RegExp("^("+b.join("|")+")$"));var g=[];return i(new n(a,!1),function(a){e&&!d.test(a.nodeType)||f&&!c(a)||g.push(a)}),g}function m(a){var b="undefined"==typeof a.getName?"Range":a.getName();return"["+b+"("+L.inspectNode(a.startContainer)+":"+a.startOffset+", "+L.inspectNode(a.endContainer)+":"+a.endOffset+")]"}function n(a,b){if(this.range=a,this.clonePartiallySelectedTextNodes=b,!a.collapsed){this.sc=a.startContainer,this.so=a.startOffset,this.ec=a.endContainer,this.eo=a.endOffset;var c=a.commonAncestorContainer;this.sc===this.ec&&L.isCharacterDataNode(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc!==c||L.isCharacterDataNode(this.sc)?L.getClosestAncestorIn(this.sc,c,!0):this.sc.childNodes[this.so],this._last=this.ec!==c||L.isCharacterDataNode(this.ec)?L.getClosestAncestorIn(this.ec,c,!0):this.ec.childNodes[this.eo-1])}}function o(a){this.code=this[a],this.codeName=a,this.message="RangeException: "+this.codeName}function p(a,b,c){this.nodes=l(a,b,c),this._next=this.nodes[0],this._position=0}function q(a){return function(b,c){for(var d,e=c?b:b.parentNode;e;){if(d=e.nodeType,L.arrayContains(a,d))return e;e=e.parentNode}return null}}function r(a,b){if(W(a,b))throw new o("INVALID_NODE_TYPE_ERR")}function s(a){if(!a.startContainer)throw new N("INVALID_STATE_ERR")}function t(a,b){if(!L.arrayContains(b,a.nodeType))throw new o("INVALID_NODE_TYPE_ERR")}function u(a,b){if(0>b||b>(L.isCharacterDataNode(a)?a.length:a.childNodes.length))throw new N("INDEX_SIZE_ERR")}function v(a,b){if(U(a,!0)!==U(b,!0))throw new N("WRONG_DOCUMENT_ERR")}function w(a){if(V(a,!0))throw new N("NO_MODIFICATION_ALLOWED_ERR")}function x(a,b){if(!a)throw new N(b)}function y(a){return!L.arrayContains(P,a.nodeType)&&!U(a,!0)}function z(a,b){return b<=(L.isCharacterDataNode(a)?a.length:a.childNodes.length)}function A(a){return!!a.startContainer&&!!a.endContainer&&!y(a.startContainer)&&!y(a.endContainer)&&z(a.startContainer,a.startOffset)&&z(a.endContainer,a.endOffset)}function B(a){if(s(a),!A(a))throw new Error("Range error: Range is no longer valid after DOM mutation ("+a.inspect()+")")}function C(){}function D(a){a.START_TO_START=ab,a.START_TO_END=bb,a.END_TO_END=cb,a.END_TO_START=db,a.NODE_BEFORE=eb,a.NODE_AFTER=fb,a.NODE_BEFORE_AND_AFTER=gb,a.NODE_INSIDE=hb}function E(a){D(a),D(a.prototype)}function F(a,b){return function(){B(this);var c,d,e=this.startContainer,g=this.startOffset,h=this.commonAncestorContainer,j=new n(this,!0);e!==h&&(c=L.getClosestAncestorIn(e,h,!0),d=f(c),e=d.node,g=d.offset),i(j,w),j.reset();var k=a(j);return j.detach(),b(this,e,g,e,g),k}}function G(c,d,g){function h(a,b){return function(c){s(this),t(c,O),t(T(c),P);var d=(a?e:f)(c);(b?i:l)(this,d.node,d.offset)}}function i(a,b,c){var e=a.endContainer,f=a.endOffset;(b!==a.startContainer||c!==a.startOffset)&&((T(b)!=T(e)||1==L.comparePoints(b,c,e,f))&&(e=b,f=c),d(a,b,c,e,f))}function l(a,b,c){var e=a.startContainer,f=a.startOffset;(b!==a.endContainer||c!==a.endOffset)&&((T(b)!=T(e)||-1==L.comparePoints(b,c,e,f))&&(e=b,f=c),d(a,e,f,b,c))}function m(a,b,c){(b!==a.startContainer||c!==a.startOffset||b!==a.endContainer||c!==a.endOffset)&&d(a,b,c,b,c)}c.prototype=new C,a.util.extend(c.prototype,{setStart:function(a,b){s(this),r(a,!0),u(a,b),i(this,a,b)},setEnd:function(a,b){s(this),r(a,!0),u(a,b),l(this,a,b)},setStartBefore:h(!0,!0),setStartAfter:h(!1,!0),setEndBefore:h(!0,!1),setEndAfter:h(!1,!1),collapse:function(a){B(this),a?d(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):d(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(a){s(this),r(a,!0),d(this,a,0,a,L.getNodeLength(a))},selectNode:function(a){s(this),r(a,!1),t(a,O);var b=e(a),c=f(a);d(this,b.node,b.offset,c.node,c.offset)},extractContents:F(k,d),deleteContents:F(j,d),canSurroundContents:function(){B(this),w(this.startContainer),w(this.endContainer);var a=new n(this,!0),c=a._first&&b(a._first,this)||a._last&&b(a._last,this);return a.detach(),!c},detach:function(){g(this)},splitBoundaries:function(){B(this);var a=this.startContainer,b=this.startOffset,c=this.endContainer,e=this.endOffset,f=a===c;L.isCharacterDataNode(c)&&e>0&&e<c.length&&L.splitDataNode(c,e),L.isCharacterDataNode(a)&&b>0&&b<a.length&&(a=L.splitDataNode(a,b),f?(e-=b,c=a):c==a.parentNode&&e>=L.getNodeIndex(a)&&e++,b=0),d(this,a,b,c,e)},normalizeBoundaries:function(){B(this);var a=this.startContainer,b=this.startOffset,c=this.endContainer,e=this.endOffset,f=function(a){var b=a.nextSibling;b&&b.nodeType==a.nodeType&&(c=a,e=a.length,a.appendData(b.data),b.parentNode.removeChild(b))},g=function(d){var f=d.previousSibling;if(f&&f.nodeType==d.nodeType){a=d;var g=d.length;if(b=f.length,d.insertData(0,f.data),f.parentNode.removeChild(f),a==c)e+=b,c=a;else if(c==d.parentNode){var h=L.getNodeIndex(d);e==h?(c=d,e=g):e>h&&e--}}},h=!0;if(L.isCharacterDataNode(c))c.length==e&&f(c);else{if(e>0){var i=c.childNodes[e-1];i&&L.isCharacterDataNode(i)&&f(i)}h=!this.collapsed}if(h){if(L.isCharacterDataNode(a))0==b&&g(a);else if(b<a.childNodes.length){var j=a.childNodes[b];j&&L.isCharacterDataNode(j)&&g(j)}}else a=c,b=e;d(this,a,b,c,e)},collapseToPoint:function(a,b){s(this),r(a,!0),u(a,b),m(this,a,b)}}),E(c)}function H(a){a.collapsed=a.startContainer===a.endContainer&&a.startOffset===a.endOffset,a.commonAncestorContainer=a.collapsed?a.startContainer:L.getCommonAncestor(a.startContainer,a.endContainer)}function I(a,b,c,e,f){var g=a.startContainer!==b||a.startOffset!==c,h=a.endContainer!==e||a.endOffset!==f;a.startContainer=b,a.startOffset=c,a.endContainer=e,a.endOffset=f,H(a),d(a,"boundarychange",{startMoved:g,endMoved:h})}function J(a){s(a),a.startContainer=a.startOffset=a.endContainer=a.endOffset=null,a.collapsed=a.commonAncestorContainer=null,d(a,"detach",null),a._listeners=null}function K(a){this.startContainer=a,this.startOffset=0,this.endContainer=a,this.endOffset=0,this._listeners={boundarychange:[],detach:[]},H(this)}a.requireModules(["DomUtil"]);var L=a.dom,M=L.DomPosition,N=a.DOMException;n.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return!!this._next},next:function(){var a=this._current=this._next;return a&&(this._next=a!==this._last?a.nextSibling:null,L.isCharacterDataNode(a)&&this.clonePartiallySelectedTextNodes&&(a===this.ec&&(a=a.cloneNode(!0)).deleteData(this.eo,a.length-this.eo),this._current===this.sc&&(a=a.cloneNode(!0)).deleteData(0,this.so))),a},remove:function(){var a,b,c=this._current;!L.isCharacterDataNode(c)||c!==this.sc&&c!==this.ec?c.parentNode&&c.parentNode.removeChild(c):(a=c===this.sc?this.so:0,b=c===this.ec?this.eo:c.length,a!=b&&c.deleteData(a,b-a))},isPartiallySelectedSubtree:function(){var a=this._current;return b(a,this.range)},getSubtreeIterator:function(){var a;if(this.isSingleCharacterDataNode)a=this.range.cloneRange(),a.collapse();else{a=new K(c(this.range));var b=this._current,d=b,e=0,f=b,g=L.getNodeLength(b);L.isAncestorOf(b,this.sc,!0)&&(d=this.sc,e=this.so),L.isAncestorOf(b,this.ec,!0)&&(f=this.ec,g=this.eo),I(a,d,e,f,g)}return new n(a,this.clonePartiallySelectedTextNodes)},detach:function(a){a&&this.range.detach(),this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}},o.prototype={BAD_BOUNDARYPOINTS_ERR:1,INVALID_NODE_TYPE_ERR:2},o.prototype.toString=function(){return this.message},p.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){return this._current=this._next,this._next=this.nodes[++this._position],this._current},detach:function(){this._current=this._next=this.nodes=null}};var O=[1,3,4,5,7,8,10],P=[2,9,11],Q=[5,6,10,12],R=[1,3,4,5,7,8,10,11],S=[1,3,4,5,7,8],T=L.getRootContainer,U=q([9,11]),V=q(Q),W=q([6,10,12]),X=document.createElement("style"),Y=!1;try{X.innerHTML="<b>x</b>",Y=3==X.firstChild.nodeType}catch(Z){}a.features.htmlParsingConforms=Y;var $=Y?function(a){var b=this.startContainer,c=L.getDocument(b);if(!b)throw new N("INVALID_STATE_ERR");var d=null;return 1==b.nodeType?d=b:L.isCharacterDataNode(b)&&(d=L.parentElement(b)),d=null===d||"HTML"==d.nodeName&&L.isHtmlNamespace(L.getDocument(d).documentElement)&&L.isHtmlNamespace(d)?c.createElement("body"):d.cloneNode(!1),d.innerHTML=a,L.fragmentFromNodeChildren(d)}:function(a){s(this);var b=c(this),d=b.createElement("body");return d.innerHTML=a,L.fragmentFromNodeChildren(d)},_=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],ab=0,bb=1,cb=2,db=3,eb=0,fb=1,gb=2,hb=3;C.prototype={attachListener:function(a,b){this._listeners[a].push(b)},compareBoundaryPoints:function(a,b){B(this),v(this.startContainer,b.startContainer);var c,d,e,f,g=a==db||a==ab?"start":"end",h=a==bb||a==ab?"start":"end";return c=this[g+"Container"],d=this[g+"Offset"],e=b[h+"Container"],f=b[h+"Offset"],L.comparePoints(c,d,e,f)},insertNode:function(a){if(B(this),t(a,R),w(this.startContainer),L.isAncestorOf(a,this.startContainer,!0))throw new N("HIERARCHY_REQUEST_ERR");var b=g(a,this.startContainer,this.startOffset);this.setStartBefore(b)},cloneContents:function(){B(this);var a,b;if(this.collapsed)return c(this).createDocumentFragment();if(this.startContainer===this.endContainer&&L.isCharacterDataNode(this.startContainer))return a=this.startContainer.cloneNode(!0),a.data=a.data.slice(this.startOffset,this.endOffset),b=c(this).createDocumentFragment(),b.appendChild(a),b;var d=new n(this,!0);return a=h(d),d.detach(),a},canSurroundContents:function(){B(this),w(this.startContainer),w(this.endContainer);var a=new n(this,!0),c=a._first&&b(a._first,this)||a._last&&b(a._last,this);return a.detach(),!c},surroundContents:function(a){if(t(a,S),!this.canSurroundContents())throw new o("BAD_BOUNDARYPOINTS_ERR");var b=this.extractContents();if(a.hasChildNodes())for(;a.lastChild;)a.removeChild(a.lastChild);g(a,this.startContainer,this.startOffset),a.appendChild(b),this.selectNode(a)},cloneRange:function(){B(this);for(var a,b=new K(c(this)),d=_.length;d--;)a=_[d],b[a]=this[a];return b},toString:function(){B(this);var a=this.startContainer;if(a===this.endContainer&&L.isCharacterDataNode(a))return 3==a.nodeType||4==a.nodeType?a.data.slice(this.startOffset,this.endOffset):"";var b=[],c=new n(this,!0);return i(c,function(a){(3==a.nodeType||4==a.nodeType)&&b.push(a.data)}),c.detach(),b.join("")},compareNode:function(a){B(this);var b=a.parentNode,c=L.getNodeIndex(a);if(!b)throw new N("NOT_FOUND_ERR");var d=this.comparePoint(b,c),e=this.comparePoint(b,c+1);return 0>d?e>0?gb:eb:e>0?fb:hb},comparePoint:function(a,b){return B(this),x(a,"HIERARCHY_REQUEST_ERR"),v(a,this.startContainer),L.comparePoints(a,b,this.startContainer,this.startOffset)<0?-1:L.comparePoints(a,b,this.endContainer,this.endOffset)>0?1:0},createContextualFragment:$,toHtml:function(){B(this);var a=c(this).createElement("div");return a.appendChild(this.cloneContents()),a.innerHTML},intersectsNode:function(a,b){if(B(this),x(a,"NOT_FOUND_ERR"),L.getDocument(a)!==c(this))return!1;var d=a.parentNode,e=L.getNodeIndex(a);x(d,"NOT_FOUND_ERR");var f=L.comparePoints(d,e,this.endContainer,this.endOffset),g=L.comparePoints(d,e+1,this.startContainer,this.startOffset);return b?0>=f&&g>=0:0>f&&g>0},isPointInRange:function(a,b){return B(this),x(a,"HIERARCHY_REQUEST_ERR"),v(a,this.startContainer),L.comparePoints(a,b,this.startContainer,this.startOffset)>=0&&L.comparePoints(a,b,this.endContainer,this.endOffset)<=0},intersectsRange:function(a,b){if(B(this),c(a)!=c(this))throw new N("WRONG_DOCUMENT_ERR");var d=L.comparePoints(this.startContainer,this.startOffset,a.endContainer,a.endOffset),e=L.comparePoints(this.endContainer,this.endOffset,a.startContainer,a.startOffset);return b?0>=d&&e>=0:0>d&&e>0},intersection:function(a){if(this.intersectsRange(a)){var b=L.comparePoints(this.startContainer,this.startOffset,a.startContainer,a.startOffset),c=L.comparePoints(this.endContainer,this.endOffset,a.endContainer,a.endOffset),d=this.cloneRange();return-1==b&&d.setStart(a.startContainer,a.startOffset),1==c&&d.setEnd(a.endContainer,a.endOffset),d}return null},union:function(a){if(this.intersectsRange(a,!0)){var b=this.cloneRange();return-1==L.comparePoints(a.startContainer,a.startOffset,this.startContainer,this.startOffset)&&b.setStart(a.startContainer,a.startOffset),1==L.comparePoints(a.endContainer,a.endOffset,this.endContainer,this.endOffset)&&b.setEnd(a.endContainer,a.endOffset),b}throw new o("Ranges do not intersect")},containsNode:function(a,b){return b?this.intersectsNode(a,!1):this.compareNode(a)==hb},containsNodeContents:function(a){return this.comparePoint(a,0)>=0&&this.comparePoint(a,L.getNodeLength(a))<=0},containsRange:function(a){return this.intersection(a).equals(a)},containsNodeText:function(a){var b=this.cloneRange();b.selectNode(a);var c=b.getNodes([3]);if(c.length>0){b.setStart(c[0],0);var d=c.pop();b.setEnd(d,d.length);var e=this.containsRange(b);return b.detach(),e}return this.containsNodeContents(a)},createNodeIterator:function(a,b){return B(this),new p(this,a,b)},getNodes:function(a,b){return B(this),l(this,a,b)},getDocument:function(){return c(this)},collapseBefore:function(a){s(this),this.setEndBefore(a),this.collapse(!1)},collapseAfter:function(a){s(this),this.setStartAfter(a),this.collapse(!0)},getName:function(){return"DomRange"},equals:function(a){return K.rangesEqual(this,a)},isValid:function(){return A(this)},inspect:function(){return m(this)}},G(K,I,J),a.rangePrototype=C.prototype,K.rangeProperties=_,K.RangeIterator=n,K.copyComparisonConstants=E,K.createPrototypeRange=G,K.inspect=m,K.getRangeDocument=c,K.rangesEqual=function(a,b){return a.startContainer===b.startContainer&&a.startOffset===b.startOffset&&a.endContainer===b.endContainer&&a.endOffset===b.endOffset},a.DomRange=K,a.RangeException=o}),rangy.createModule("WrappedRange",function(a){function b(a){var b=a.parentElement(),c=a.duplicate();c.collapse(!0);var d=c.parentElement();c=a.duplicate(),c.collapse(!1);var e=c.parentElement(),f=d==e?d:g.getCommonAncestor(d,e);return f==b?f:g.getCommonAncestor(b,f)}function c(a){return 0==a.compareEndPoints("StartToEnd",a)}function d(a,b,c,d){var e=a.duplicate();e.collapse(c);var f=e.parentElement();if(g.isAncestorOf(b,f,!0)||(f=b),!f.canHaveHTML)return new h(f.parentNode,g.getNodeIndex(f));var i,j,k,l,m,n=g.getDocument(f).createElement("span"),o=c?"StartToStart":"StartToEnd";do f.insertBefore(n,n.previousSibling),e.moveToElementText(n);while((i=e.compareEndPoints(o,a))>0&&n.previousSibling);if(m=n.nextSibling,-1==i&&m&&g.isCharacterDataNode(m)){e.setEndPoint(c?"EndToStart":"EndToEnd",a);var p;if(/[\r\n]/.test(m.data)){var q=e.duplicate(),r=q.text.replace(/\r\n/g,"\r").length;for(p=q.moveStart("character",r);-1==(i=q.compareEndPoints("StartToEnd",q));)p++,q.moveStart("character",1)}else p=e.text.length;l=new h(m,p)}else j=(d||!c)&&n.previousSibling,k=(d||c)&&n.nextSibling,l=k&&g.isCharacterDataNode(k)?new h(k,0):j&&g.isCharacterDataNode(j)?new h(j,j.length):new h(f,g.getNodeIndex(n));return n.parentNode.removeChild(n),l}function e(a,b){var c,d,e,f,h=a.offset,i=g.getDocument(a.node),j=i.body.createTextRange(),k=g.isCharacterDataNode(a.node);return k?(c=a.node,d=c.parentNode):(f=a.node.childNodes,c=h<f.length?f[h]:null,d=a.node),e=i.createElement("span"),e.innerHTML="&#feff;",c?d.insertBefore(e,c):d.appendChild(e),j.moveToElementText(e),j.collapse(!b),d.removeChild(e),k&&j[b?"moveStart":"moveEnd"]("character",h),j}a.requireModules(["DomUtil","DomRange"]);var f,g=a.dom,h=g.DomPosition,i=a.DomRange;if(!a.features.implementsDomRange||a.features.implementsTextRange&&a.config.preferTextRange){if(a.features.implementsTextRange){f=function(a){this.textRange=a,this.refresh()},f.prototype=new i(document),f.prototype.refresh=function(){var a,e,f=b(this.textRange);c(this.textRange)?e=a=d(this.textRange,f,!0,!0):(a=d(this.textRange,f,!0,!1),e=d(this.textRange,f,!1,!1)),this.setStart(a.node,a.offset),this.setEnd(e.node,e.offset)},i.copyComparisonConstants(f);var j=function(){return this}();"undefined"==typeof j.Range&&(j.Range=f),a.createNativeRange=function(a){return a=a||document,a.body.createTextRange()}}}else!function(){function b(a){for(var b,c=k.length;c--;)b=k[c],a[b]=a.nativeRange[b]}function c(a,b,c,d,e){var f=a.startContainer!==b||a.startOffset!=c,g=a.endContainer!==d||a.endOffset!=e;(f||g)&&(a.setEnd(d,e),a.setStart(b,c))}function d(a){a.nativeRange.detach(),a.detached=!0;for(var b,c=k.length;c--;)b=k[c],a[b]=null}var e,h,j,k=i.rangeProperties;f=function(a){if(!a)throw new Error("Range must be specified");this.nativeRange=a,b(this)},i.createPrototypeRange(f,c,d),e=f.prototype,e.selectNode=function(a){this.nativeRange.selectNode(a),b(this)},e.deleteContents=function(){this.nativeRange.deleteContents(),b(this)},e.extractContents=function(){var a=this.nativeRange.extractContents();return b(this),a},e.cloneContents=function(){return this.nativeRange.cloneContents()},e.surroundContents=function(a){this.nativeRange.surroundContents(a),b(this)},e.collapse=function(a){this.nativeRange.collapse(a),b(this)},e.cloneRange=function(){return new f(this.nativeRange.cloneRange())},e.refresh=function(){b(this)},e.toString=function(){return this.nativeRange.toString()};var l=document.createTextNode("test");g.getBody(document).appendChild(l);var m=document.createRange();m.setStart(l,0),m.setEnd(l,0);try{m.setStart(l,1),h=!0,e.setStart=function(a,c){this.nativeRange.setStart(a,c),b(this)},e.setEnd=function(a,c){this.nativeRange.setEnd(a,c),b(this)},j=function(a){return function(c){this.nativeRange[a](c),b(this)}}}catch(n){h=!1,e.setStart=function(a,c){try{this.nativeRange.setStart(a,c)}catch(d){this.nativeRange.setEnd(a,c),this.nativeRange.setStart(a,c)}b(this)},e.setEnd=function(a,c){try{this.nativeRange.setEnd(a,c)}catch(d){this.nativeRange.setStart(a,c),this.nativeRange.setEnd(a,c)}b(this)},j=function(a,c){return function(d){try{this.nativeRange[a](d)}catch(e){this.nativeRange[c](d),this.nativeRange[a](d)}b(this)}}}e.setStartBefore=j("setStartBefore","setEndBefore"),e.setStartAfter=j("setStartAfter","setEndAfter"),e.setEndBefore=j("setEndBefore","setStartBefore"),e.setEndAfter=j("setEndAfter","setStartAfter"),m.selectNodeContents(l),e.selectNodeContents=m.startContainer==l&&m.endContainer==l&&0==m.startOffset&&m.endOffset==l.length?function(a){this.nativeRange.selectNodeContents(a),b(this)}:function(a){this.setStart(a,0),this.setEnd(a,i.getEndOffset(a))},m.selectNodeContents(l),m.setEnd(l,3);var o=document.createRange();o.selectNodeContents(l),o.setEnd(l,4),o.setStart(l,2),e.compareBoundaryPoints=-1==m.compareBoundaryPoints(m.START_TO_END,o)&1==m.compareBoundaryPoints(m.END_TO_START,o)?function(a,b){return b=b.nativeRange||b,a==b.START_TO_END?a=b.END_TO_START:a==b.END_TO_START&&(a=b.START_TO_END),this.nativeRange.compareBoundaryPoints(a,b)}:function(a,b){return this.nativeRange.compareBoundaryPoints(a,b.nativeRange||b)},a.util.isHostMethod(m,"createContextualFragment")&&(e.createContextualFragment=function(a){return this.nativeRange.createContextualFragment(a)}),g.getBody(document).removeChild(l),m.detach(),o.detach()}(),a.createNativeRange=function(a){return a=a||document,a.createRange()};a.features.implementsTextRange&&(f.rangeToTextRange=function(a){if(a.collapsed){var b=e(new h(a.startContainer,a.startOffset),!0);return b}var c=e(new h(a.startContainer,a.startOffset),!0),d=e(new h(a.endContainer,a.endOffset),!1),f=g.getDocument(a.startContainer).body.createTextRange();return f.setEndPoint("StartToStart",c),f.setEndPoint("EndToEnd",d),f}),f.prototype.getName=function(){return"WrappedRange"},a.WrappedRange=f,a.createRange=function(b){return b=b||document,new f(a.createNativeRange(b))},a.createRangyRange=function(a){return a=a||document,new i(a)},a.createIframeRange=function(b){return a.createRange(g.getIframeDocument(b))},a.createIframeRangyRange=function(b){return a.createRangyRange(g.getIframeDocument(b))},a.addCreateMissingNativeApiListener(function(b){var c=b.document;"undefined"==typeof c.createRange&&(c.createRange=function(){return a.createRange(this)}),c=b=null})}),rangy.createModule("WrappedSelection",function(a,b){function c(a){return(a||window).getSelection()}function d(a){return(a||window).document.selection}function e(a,b,c){var d=c?"end":"start",e=c?"start":"end";a.anchorNode=b[d+"Container"],a.anchorOffset=b[d+"Offset"],a.focusNode=b[e+"Container"],a.focusOffset=b[e+"Offset"]}function f(a){var b=a.nativeSelection;a.anchorNode=b.anchorNode,a.anchorOffset=b.anchorOffset,a.focusNode=b.focusNode,a.focusOffset=b.focusOffset}function g(a){a.anchorNode=a.focusNode=null,a.anchorOffset=a.focusOffset=0,a.rangeCount=0,a.isCollapsed=!0,a._ranges.length=0}function h(b){var c;return b instanceof y?(c=b._selectionNativeRange,c||(c=a.createNativeRange(w.getDocument(b.startContainer)),c.setEnd(b.endContainer,b.endOffset),c.setStart(b.startContainer,b.startOffset),b._selectionNativeRange=c,b.attachListener("detach",function(){this._selectionNativeRange=null}))):b instanceof z?c=b.nativeRange:a.features.implementsDomRange&&b instanceof w.getWindow(b.startContainer).Range&&(c=b),c}function i(a){if(!a.length||1!=a[0].nodeType)return!1;for(var b=1,c=a.length;c>b;++b)if(!w.isAncestorOf(a[0],a[b]))return!1;return!0}function j(a){var b=a.getNodes();if(!i(b))throw new Error("getSingleElementFromRange: range "+a.inspect()+" did not consist of a single element");return b[0]}function k(a){return!!a&&"undefined"!=typeof a.text}function l(a,b){var c=new z(b);a._ranges=[c],e(a,c,!1),a.rangeCount=1,a.isCollapsed=c.collapsed}function m(b){if(b._ranges.length=0,"None"==b.docSelection.type)g(b);else{var c=b.docSelection.createRange();if(k(c))l(b,c);else{b.rangeCount=c.length;for(var d,f=w.getDocument(c.item(0)),h=0;h<b.rangeCount;++h)d=a.createRange(f),d.selectNode(c.item(h)),b._ranges.push(d);b.isCollapsed=1==b.rangeCount&&b._ranges[0].collapsed,e(b,b._ranges[b.rangeCount-1],!1)}}}function n(a,b){for(var c=a.docSelection.createRange(),d=j(b),e=w.getDocument(c.item(0)),f=w.getBody(e).createControlRange(),g=0,h=c.length;h>g;++g)f.add(c.item(g));try{f.add(d)}catch(i){throw new Error("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}f.select(),m(a)}function o(a,b,c){this.nativeSelection=a,this.docSelection=b,this._ranges=[],this.win=c,this.refresh()}function p(a,b){for(var c,d=w.getDocument(b[0].startContainer),e=w.getBody(d).createControlRange(),f=0;rangeCount>f;++f){c=j(b[f]);try{e.add(c)}catch(g){throw new Error("setRanges(): Element within the one of the specified Ranges could not be added to control selection (does it have layout?)")}}e.select(),m(a)}function q(a,b){if(a.anchorNode&&w.getDocument(a.anchorNode)!==w.getDocument(b))throw new A("WRONG_DOCUMENT_ERR")}function r(a){var b=[],c=new B(a.anchorNode,a.anchorOffset),d=new B(a.focusNode,a.focusOffset),e="function"==typeof a.getName?a.getName():"Selection";if("undefined"!=typeof a.rangeCount)for(var f=0,g=a.rangeCount;g>f;++f)b[f]=y.inspect(a.getRangeAt(f));return"["+e+"(Ranges: "+b.join(", ")+")(anchor: "+c.inspect()+", focus: "+d.inspect()+"]"}a.requireModules(["DomUtil","DomRange","WrappedRange"]),a.config.checkSelectionRanges=!0;var s,t,u="boolean",v="_rangySelection",w=a.dom,x=a.util,y=a.DomRange,z=a.WrappedRange,A=a.DOMException,B=w.DomPosition,C="Control",D=a.util.isHostMethod(window,"getSelection"),E=a.util.isHostObject(document,"selection"),F=E&&(!D||a.config.preferTextRange);F?(s=d,a.isSelectionValid=function(a){var b=(a||window).document,c=b.selection;return"None"!=c.type||w.getDocument(c.createRange().parentElement())==b}):D?(s=c,a.isSelectionValid=function(){return!0}):b.fail("Neither document.selection or window.getSelection() detected."),a.getNativeSelection=s;var G=s(),H=a.createNativeRange(document),I=w.getBody(document),J=x.areHostObjects(G,["anchorNode","focusNode"]&&x.areHostProperties(G,["anchorOffset","focusOffset"]));a.features.selectionHasAnchorAndFocus=J;var K=x.isHostMethod(G,"extend");a.features.selectionHasExtend=K;var L="number"==typeof G.rangeCount;a.features.selectionHasRangeCount=L;var M=!1,N=!0;x.areHostMethods(G,["addRange","getRangeAt","removeAllRanges"])&&"number"==typeof G.rangeCount&&a.features.implementsDomRange&&!function(){var a=document.createElement("iframe");a.frameBorder=0,a.style.position="absolute",a.style.left="-10000px",I.appendChild(a);var b=w.getIframeDocument(a);b.open(),b.write("<html><head></head><body>12</body></html>"),b.close();var c=w.getIframeWindow(a).getSelection(),d=b.documentElement,e=d.lastChild,f=e.firstChild,g=b.createRange();g.setStart(f,1),g.collapse(!0),c.addRange(g),N=1==c.rangeCount,c.removeAllRanges();var h=g.cloneRange();g.setStart(f,0),h.setEnd(f,2),c.addRange(g),c.addRange(h),M=2==c.rangeCount,g.detach(),h.detach(),I.removeChild(a)}(),a.features.selectionSupportsMultipleRanges=M,a.features.collapsedNonEditableSelectionsSupported=N;var O,P=!1;I&&x.isHostMethod(I,"createControlRange")&&(O=I.createControlRange(),x.areHostProperties(O,["item","add"])&&(P=!0)),a.features.implementsControlRange=P,t=J?function(a){return a.anchorNode===a.focusNode&&a.anchorOffset===a.focusOffset}:function(a){return a.rangeCount?a.getRangeAt(a.rangeCount-1).collapsed:!1};var Q;x.isHostMethod(G,"getRangeAt")?Q=function(a,b){try{return a.getRangeAt(b)}catch(c){return null}}:J&&(Q=function(b){var c=w.getDocument(b.anchorNode),d=a.createRange(c);return d.setStart(b.anchorNode,b.anchorOffset),d.setEnd(b.focusNode,b.focusOffset),d.collapsed!==this.isCollapsed&&(d.setStart(b.focusNode,b.focusOffset),d.setEnd(b.anchorNode,b.anchorOffset)),d}),a.getSelection=function(a){a=a||window;var b=a[v],c=s(a),e=E?d(a):null;return b?(b.nativeSelection=c,b.docSelection=e,b.refresh(a)):(b=new o(c,e,a),a[v]=b),b},a.getIframeSelection=function(b){return a.getSelection(w.getIframeWindow(b))};var R=o.prototype;if(!F&&J&&x.areHostMethods(G,["removeAllRanges","addRange"])){R.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),g(this)};var S=function(b,c){var d=y.getRangeDocument(c),e=a.createRange(d);e.collapseToPoint(c.endContainer,c.endOffset),b.nativeSelection.addRange(h(e)),b.nativeSelection.extend(c.startContainer,c.startOffset),b.refresh()};R.addRange=L?function(b,c){if(P&&E&&this.docSelection.type==C)n(this,b);else if(c&&K)S(this,b);else{var d;if(M?d=this.rangeCount:(this.removeAllRanges(),d=0),this.nativeSelection.addRange(h(b)),this.rangeCount=this.nativeSelection.rangeCount,this.rangeCount==d+1){if(a.config.checkSelectionRanges){var f=Q(this.nativeSelection,this.rangeCount-1);f&&!y.rangesEqual(f,b)&&(b=new z(f))}this._ranges[this.rangeCount-1]=b,e(this,b,V(this.nativeSelection)),this.isCollapsed=t(this)}else this.refresh()}}:function(a,b){b&&K?S(this,a):(this.nativeSelection.addRange(h(a)),this.refresh())},R.setRanges=function(a){if(P&&a.length>1)p(this,a);else{this.removeAllRanges();for(var b=0,c=a.length;c>b;++b)this.addRange(a[b])}}}else{if(!(x.isHostMethod(G,"empty")&&x.isHostMethod(H,"select")&&P&&F))return b.fail("No means of selecting a Range or TextRange was found"),!1;R.removeAllRanges=function(){try{if(this.docSelection.empty(),"None"!=this.docSelection.type){var a;if(this.anchorNode)a=w.getDocument(this.anchorNode);else if(this.docSelection.type==C){var b=this.docSelection.createRange();b.length&&(a=w.getDocument(b.item(0)).body.createTextRange())}if(a){var c=a.body.createTextRange();c.select(),this.docSelection.empty()}}}catch(d){}g(this)},R.addRange=function(a){this.docSelection.type==C?n(this,a):(z.rangeToTextRange(a).select(),this._ranges[0]=a,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,e(this,a,!1))},R.setRanges=function(a){this.removeAllRanges();var b=a.length;b>1?p(this,a):b&&this.addRange(a[0])}}R.getRangeAt=function(a){if(0>a||a>=this.rangeCount)throw new A("INDEX_SIZE_ERR");return this._ranges[a]};var T;if(F)T=function(b){var c;a.isSelectionValid(b.win)?c=b.docSelection.createRange():(c=w.getBody(b.win.document).createTextRange(),c.collapse(!0)),b.docSelection.type==C?m(b):k(c)?l(b,c):g(b)};else if(x.isHostMethod(G,"getRangeAt")&&"number"==typeof G.rangeCount)T=function(b){if(P&&E&&b.docSelection.type==C)m(b);else if(b._ranges.length=b.rangeCount=b.nativeSelection.rangeCount,b.rangeCount){for(var c=0,d=b.rangeCount;d>c;++c)b._ranges[c]=new a.WrappedRange(b.nativeSelection.getRangeAt(c));e(b,b._ranges[b.rangeCount-1],V(b.nativeSelection)),b.isCollapsed=t(b)}else g(b)};else{if(!J||typeof G.isCollapsed!=u||typeof H.collapsed!=u||!a.features.implementsDomRange)return b.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;T=function(a){var b,c=a.nativeSelection;c.anchorNode?(b=Q(c,0),a._ranges=[b],a.rangeCount=1,f(a),a.isCollapsed=t(a)):g(a)}}R.refresh=function(a){var b=a?this._ranges.slice(0):null;if(T(this),a){var c=b.length;if(c!=this._ranges.length)return!1;for(;c--;)if(!y.rangesEqual(b[c],this._ranges[c]))return!1;return!0}};var U=function(a,b){var c=a.getAllRanges(),d=!1;a.removeAllRanges();for(var e=0,f=c.length;f>e;++e)d||b!==c[e]?a.addRange(c[e]):d=!0;a.rangeCount||g(a)};R.removeRange=P?function(a){if(this.docSelection.type==C){for(var b,c=this.docSelection.createRange(),d=j(a),e=w.getDocument(c.item(0)),f=w.getBody(e).createControlRange(),g=!1,h=0,i=c.length;i>h;++h)b=c.item(h),b!==d||g?f.add(c.item(h)):g=!0;f.select(),m(this)}else U(this,a)}:function(a){U(this,a)};var V;!F&&J&&a.features.implementsDomRange?(V=function(a){var b=!1;return a.anchorNode&&(b=1==w.comparePoints(a.anchorNode,a.anchorOffset,a.focusNode,a.focusOffset)),b},R.isBackwards=function(){return V(this)}):V=R.isBackwards=function(){return!1},R.toString=function(){for(var a=[],b=0,c=this.rangeCount;c>b;++b)a[b]=""+this._ranges[b];return a.join("")},R.collapse=function(b,c){q(this,b);var d=a.createRange(w.getDocument(b));d.collapseToPoint(b,c),this.removeAllRanges(),this.addRange(d),this.isCollapsed=!0
},R.collapseToStart=function(){if(!this.rangeCount)throw new A("INVALID_STATE_ERR");var a=this._ranges[0];this.collapse(a.startContainer,a.startOffset)},R.collapseToEnd=function(){if(!this.rangeCount)throw new A("INVALID_STATE_ERR");var a=this._ranges[this.rangeCount-1];this.collapse(a.endContainer,a.endOffset)},R.selectAllChildren=function(b){q(this,b);var c=a.createRange(w.getDocument(b));c.selectNodeContents(b),this.removeAllRanges(),this.addRange(c)},R.deleteFromDocument=function(){if(P&&E&&this.docSelection.type==C){for(var a,b=this.docSelection.createRange();b.length;)a=b.item(0),b.remove(a),a.parentNode.removeChild(a);this.refresh()}else if(this.rangeCount){var c=this.getAllRanges();this.removeAllRanges();for(var d=0,e=c.length;e>d;++d)c[d].deleteContents();this.addRange(c[e-1])}},R.getAllRanges=function(){return this._ranges.slice(0)},R.setSingleRange=function(a){this.setRanges([a])},R.containsNode=function(a,b){for(var c=0,d=this._ranges.length;d>c;++c)if(this._ranges[c].containsNode(a,b))return!0;return!1},R.toHtml=function(){var a="";if(this.rangeCount){for(var b=y.getRangeDocument(this._ranges[0]).createElement("div"),c=0,d=this._ranges.length;d>c;++c)b.appendChild(this._ranges[c].cloneContents());a=b.innerHTML}return a},R.getName=function(){return"WrappedSelection"},R.inspect=function(){return r(this)},R.detach=function(){this.win[v]=null,this.win=this.anchorNode=this.focusNode=null},o.inspect=r,a.Selection=o,a.selectionPrototype=R,a.addCreateMissingNativeApiListener(function(b){"undefined"==typeof b.getSelection&&(b.getSelection=function(){return a.getSelection(this)}),b=null})}),d("undefined"!=typeof rangy?rangy:window.rangy)}).call(a,void 0,void 0,void 0,function(a){b.exports=a})}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],"rangy-core":[function(a,b){b.exports=a("rmqf9t")},{}],13:[function(a,b){(function(){var c,d,e,f,g,h,i;i=a("lodash"),g=a("./diff_match_patch"),e=a("./op"),d=a("./insert"),f=a("./retain"),h=new g,c=function(){function a(a,b,c){var d;if(this.startLength=a,this.endLength=b,this.ops=c,null==this.ops&&(this.ops=this.endLength,this.endLength=null),this.ops=i.map(this.ops,function(a){if(e.isRetain(a))return a;if(e.isInsert(a))return a;throw new Error("Creating delta with invalid op. Expecting an insert or retain.")}),this.compact(),d=i.reduce(this.ops,function(a,b){return a+b.getLength()},0),null!=this.endLength&&d!==this.endLength)throw new Error("Expecting end length of "+d);this.endLength=d}var b,c;return a.getIdentity=function(b){return new a(b,b,[new f(0,b)])},a.getInitial=function(b){return new a(0,b.length,[new d(b)])},a.isDelta=function(a){var b,c,d,f;if(null!=a&&"object"==typeof a&&"number"==typeof a.startLength&&"number"==typeof a.endLength&&"object"==typeof a.ops){for(f=a.ops,c=0,d=f.length;d>c;c++)if(b=f[c],!e.isRetain(b)&&!e.isInsert(b))return!1;return!0}return!1},a.makeDelta=function(b){return new a(b.startLength,b.endLength,i.map(b.ops,function(a){return e.isInsert(a)?new d(a.value,a.attributes):e.isRetain(a)?new f(a.start,a.end,a.attributes):null}))},a.makeDeleteDelta=function(b,c,d){var e;return e=[],c>0&&e.push(new f(0,c)),b>c+d&&e.push(new f(c+d,b)),new a(b,e)},a.makeInsertDelta=function(b,c,e,g){var h;return h=[new d(e,g)],c>0&&h.unshift(new f(0,c)),b>c&&h.push(new f(c,b)),new a(b,h)},a.makeRetainDelta=function(b,c,d,e){var g;return g=[new f(c,c+d,e)],c>0&&g.unshift(new f(0,c)),b>c+d&&g.push(new f(c+d,b)),new a(b,g)},a.prototype.apply=function(a,b,c,d){var g,h,j;return null==a&&(a=function(){}),null==b&&(b=function(){}),null==c&&(c=function(){}),null==d&&(d=null),this.isIdentity()?void 0:(g=0,h=0,j=[],i.each(this.ops,function(c){return e.isInsert(c)?(a.call(d,g+h,c.value,c.attributes),h+=c.getLength()):e.isRetain(c)?(c.start>g&&(b.call(d,g+h,c.start-g),h-=c.start-g),j.push(new f(c.start+h,c.end+h,c.attributes)),g=c.end):void 0}),this.endLength<this.startLength+h&&b.call(d,this.endLength,this.startLength+h-this.endLength),i.each(j,function(a){return i.each(a.attributes,function(b,e){return null===b?c.call(d,a.start,a.end-a.start,e,b):void 0}),i.each(a.attributes,function(b,e){return null!=b?c.call(d,a.start,a.end-a.start,e,b):void 0})}))},a.prototype.applyToText=function(a){var b,c,d,f,g,h,i;if(c=this,a.length!==c.startLength)throw new Error("Start length of delta: "+c.startLength+" is not equal to the text: "+a.length);for(b=[],i=c.ops,g=0,h=i.length;h>g;g++)d=i[g],b.push(e.isInsert(d)?d.value:a.substring(d.start,d.end));if(f=b.join(""),c.endLength!==f.length)throw new Error("End length of delta: "+c.endLength+" is not equal to result text: "+f.length);return f},a.prototype.canCompose=function(b){return a.isDelta(b)&&this.endLength===b.startLength},a.prototype.compact=function(){var a;return a=[],i.each(this.ops,function(b){var c;if(0!==b.getLength())return 0===a.length?a.push(b):(c=i.last(a),e.isInsert(c)&&e.isInsert(b)&&c.attributesMatch(b)?a[a.length-1]=new d(c.value+b.value,b.attributes):e.isRetain(c)&&e.isRetain(b)&&c.end===b.start&&c.attributesMatch(b)?a[a.length-1]=new f(c.start,b.end,b.attributes):a.push(b))}),this.ops=a},a.prototype.compose=function(b){var c,g,h,j,k,l,m;if(!this.canCompose(b))throw new Error("Cannot compose delta");for(g=this,c=[],m=b.ops,k=0,l=m.length;l>k;k++)if(h=m[k],e.isInsert(h))c.push(h);else{if(!e.isRetain(h))throw new Error("Invalid op in deltaB when composing");j=g.getOpsAt(h.start,h.getLength()),j=i.map(j,function(a){return e.isInsert(a)?new d(a.value,a.composeAttributes(h.attributes)):new f(a.start,a.end,a.composeAttributes(h.attributes))}),c=c.concat(j)}return new a(g.startLength,b.endLength,c)},a.prototype.decompose=function(b){var c,g,h,j,k,l;if(h=this,!a.isDelta(b))throw new Error("Decompose called when deltaA is not a Delta, type: "+typeof b);if(b.startLength!==this.startLength)throw new Error("startLength "+b.startLength+" / startLength "+this.startLength+" mismatch");if(!i.all(b.ops,function(a){return e.isInsert(a)}))throw new Error("DeltaA has retain in decompose");if(!i.all(h.ops,function(a){return e.isInsert(a)}))throw new Error("DeltaC has retain in decompose");return c=function(a,b){var d,e,f;d={};for(e in b)f=b[e],(void 0===a[e]||a[e]!==f)&&(d[e]=null!==a[e]&&"object"==typeof a[e]&&null!==f&&"object"==typeof f?c(a[e],f):f);for(e in a)f=a[e],void 0===b[e]&&(d[e]=null);return d},j=b.diff(h),l=[],k=0,i.each(j.ops,function(a){var g,j;return j=h.getOpsAt(k,a.getLength()),g=0,i.each(j,function(h){var j,k,m;if(e.isInsert(a))j=new d(a.value.substring(g,g+h.getLength()),h.attributes),l.push(j);else{if(!e.isRetain(a))throw new Error("Invalid delta in deltaB when composing");m=b.getOpsAt(a.start+g,h.getLength()),k=0,i.each(m,function(b){var d,e,i;return d=c(b.attributes,h.attributes),i=a.start+k+g,e=new f(i,i+b.getLength(),d),l.push(e),k+=b.getLength()})}return g+=h.getLength()}),k+=a.getLength()}),g=new a(j.startLength,j.endLength,l)},a.prototype.diff=function(b){var c,e,j,k,l,m,n,o,p,q,r,s,t;if(s=i.map([this,b],function(a){return i.map(a.ops,function(a){return null!=a.value?a.value:""}).join("")}),n=s[0],o=s[1],""!==n||""!==o){if(c=h.diff_main(n,o),c.length<=0)throw new Error("diffToDelta called with diff with length <= 0");for(m=0,e=0,l=[],q=0,r=c.length;r>q;q++)switch(t=c[q],k=t[0],p=t[1],k){case g.DIFF_DELETE:m+=p.length;break;case g.DIFF_INSERT:l.push(new d(p)),e+=p.length;break;case g.DIFF_EQUAL:l.push(new f(m,m+p.length)),m+=p.length,e+=p.length}j=new a(m,e,l)}else j=new a(0,0,[]);return j},b=function(a,b,c,d){var e,g;if(g=i.extend({},c),e=Math.min(a.getLength(),b.getLength()),d)if(g.transformOp=new f(g.indexA,g.indexA+e),g.indexA+=e,e===a.getLength())g.elemIndexA++;else{if(!(e<a.getLength()))throw new Error("Invalid elem length in transform");g.elemA=i.last(a.split(e))}else g.transformOp=i.first(b.split(e)),g.indexB+=e,e===b.getLength()?g.elemIndexB++:g.elemB=i.last(b.split(e));return g},c=function(a,b,c){var d,e,g,h,j,k,l,m;if(j=c.indexA,k=c.indexB,e=c.elemIndexA,g=c.elemIndexB,m=i.extend({},c),a.end<b.start)m.indexA+=a.getLength(),m.elemIndexA++;else if(b.end<a.start)m.indexB+=b.getLength(),m.elemIndexB++;else{if(a.start<b.start?(m.indexA+=b.start-a.start,a=m.elemA=new f(b.start,a.end,a.attributes)):b.start<a.start&&(m.indexB+=a.start-b.start,b=m.elemB=new f(a.start,b.end,b.attributes)),h="RetainOps must have same start length in transform",a.start!==b.start)throw new Error(h);l=Math.min(a.end,b.end)-a.start,d=a.addAttributes(b.attributes),m.transformOp=new f(m.indexA,m.indexA+l,d),m.indexA+=l,m.indexB+=l,a.end===b.end?(m.elemIndexA++,m.elemIndexB++):a.end<b.end?(m.elemIndexA++,m.elemB=i.last(b.split(l))):(m.elemIndexB++,m.elemA=i.last(a.split(l)))}return m.elemIndexA!==c.elemIndexA&&(m.elemA=null),m.elemIndexB!==c.elemIndexB&&(m.elemB=null),m},a.prototype.transform=function(d,g){var h,j,k,l,m,n,o,p,q,r,s,t,u,v;if(null==g&&(g=!1),!a.isDelta(d))throw n="Transform called when deltaA is not a Delta, type: ",new Error(n+typeof d);for(d=new a(d.startLength,d.endLength,d.ops),h=new a(this.startLength,this.endLength,this.ops),s=[],o=p=0,l=m=0,u=function(a){return null!=a.indexA&&(o=a.indexA),null!=a.indexB&&(p=a.indexB),null!=a.elemIndexA&&(l=a.elemIndexA),null!=a.elemIndexB&&(m=a.elemIndexB),null!=a.elemA&&(d.ops[l]=a.elemA),null!=a.elemB&&(h.ops[m]=a.elemB),null!=a.transformOp?s.push(a.transformOp):void 0},v=function(){return{indexA:o,indexB:p,elemIndexA:l,elemIndexB:m}};l<d.ops.length&&m<h.ops.length;)j=d.ops[l],k=h.ops[m],e.isInsert(j)&&e.isInsert(k)?(q=b(j,k,v(),g),u(q)):e.isRetain(j)&&e.isRetain(k)?(q=c(j,k,v()),u(q)):e.isInsert(j)&&e.isRetain(k)?(s.push(new f(o,o+j.getLength())),o+=j.getLength(),l++):e.isRetain(j)&&e.isInsert(k)&&(s.push(k),p+=k.getLength(),m++);for(;l<d.ops.length;)j=d.ops[l],e.isInsert(j)&&s.push(new f(o,o+j.getLength())),o+=j.getLength(),l++;for(;m<h.ops.length;)k=h.ops[m],e.isInsert(k)&&s.push(k),p+=k.getLength(),m++;return t=d.endLength,r=i.reduce(s,function(a,b){return a+b.getLength()},0),new a(t,r,s)},a.prototype.getOpsAt=function(a,b){var c,d,e,f,g,h,i,j,k;for(c=[],e=null!=this.savedOpOffset&&this.savedOpOffset<a?this.savedOpOffset:this.savedOpOffset=this.savedOpIndex=0,k=this.ops.slice(this.savedOpIndex),i=0,j=k.length;j>i&&(f=k[i],!(e>=a+b));i++)g=f.getLength(),e+g>a&&(h=Math.max(a-e,0),d=Math.min(g-h,a+b-e-h),c.push(f.getAt(h,d))),e+=g,this.savedOpIndex+=1,this.savedOpOffset+=g;return c},a.prototype.invert=function(a){var b,c,d;if(!this.isInsertsOnly())throw new Error("Invert called on invalid delta containing non-insert ops");return b=this,c=b.compose(a),d=b.decompose(c)},a.prototype.isEqual=function(a){return a?this.startLength!==a.startLength||this.endLength!==a.endLength?!1:i.isArray(a.ops)&&this.ops.length===a.ops.length?i.all(this.ops,function(b,c){return b.isEqual(a.ops[c])}):!1:!1},a.prototype.isIdentity=function(){var a,b,c,d,f;if(this.startLength===this.endLength){if(0===this.ops.length)return!0;for(a=0,f=this.ops,c=0,d=f.length;d>c;c++){if(b=f[c],!e.isRetain(b))return!1;if(b.start!==a)return!1;if(!(0===b.numAttributes()||1===b.numAttributes()&&i.has(b.attributes,"authorId")))return!1;a=b.end}return a!==this.endLength?!1:!0}return!1},a.prototype.isInsertsOnly=function(){return i.every(this.ops,function(a){return e.isInsert(a)})},a.prototype.merge=function(b){var c,d=this;return c=i.map(b.ops,function(a){return e.isRetain(a)?new f(a.start+d.startLength,a.end+d.startLength,a.attributes):a}),c=this.ops.concat(c),new a(this.startLength+b.startLength,c)},a.prototype.split=function(b){var c,d;if(!this.isInsertsOnly())throw new Error("Split only implemented for inserts only");if(!(b>=0&&b<=this.endLength))throw new Error("Split at invalid index");return c=[],d=[],i.reduce(this.ops,function(a,e){var f,g,h;return a+e.getLength()<=b?c.push(e):a>=b?d.push(e):(h=e.split(b-a),f=h[0],g=h[1],c.push(f),d.push(g)),a+e.getLength()},0),[new a(0,c),new a(0,d)]},a.prototype.toString=function(){return"{("+this.startLength+"->"+this.endLength+") ["+this.ops.join(", ")+"]}"},a}(),b.exports=c}).call(this)},{"./diff_match_patch":15,"./insert":16,"./op":17,"./retain":18,lodash:"4HJaAd"}],14:[function(a,b){(function(){var c,d,e,f,g,h,i,j;i=a("lodash"),c=a("./delta"),e=a("./insert"),f=a("./retain"),j={alphabet:"abcdefghijklmnopqrstuvwxyz\n\n\n\n  ",booleanAttributes:{bold:[!0,!1],italic:[!0,!1],strike:[!0,!1]},nonBooleanAttributes:{"back-color":["white","black","red","blue","lime","teal","magenta","yellow"],"fore-color":["white","black","red","blue","lime","teal","magenta","yellow"],"font-name":["monospace","serif"],"font-size":["huge","large","small"]},defaultAttributeValue:{"back-color":"white","fore-color":"black","font-name":"san-serif","font-size":"normal"}},h=function(a){return null!=a?j=a:void 0},g=function(a){if(a=a||j,null==a)throw new Error("Must provide DeltaGenerator with a domain.");if(null==a.alphabet)throw new Error("Domain must define alphabet.");if(null==a.booleanAttributes)throw new Error("Domain must define booleanAttributes.");if(null==a.nonBooleanAttributes)throw new Error("Domain must define nonBooleanAttributes.");if(null==a.defaultAttributeValue)throw new Error("Domain must define defaultAttributeValue.");return{getDomain:function(){return j},getRandomString:function(b){var c;return i.map(function(){c=[];for(var a=0,d=b-1;d>=0?d>=a:a>=d;d>=0?a++:a--)c.push(a);return c}.apply(this),function(){return a.alphabet[i.random(0,a.alphabet.length-1)]}).join("")},getRandomLength:function(){var a;return a=Math.random(),.6>a?i.random(1,2):.8>a?i.random(3,4):.9>a?i.random(5,9):i.random(10,50)},insertAt:function(a,b,c){var d,f,g,h,i,j,k,l,m;for(d=h=0,l=a.ops,j=0,k=l.length;k>j&&(g=l[j],d!==b);j++){if(b<d+g.getLength()){m=g.split(b-d),f=m[0],i=m[1],a.ops.splice(h,1,f,i),h++;break}d+=g.getLength(),h++}return a.ops.splice(h,0,new e(c)),a.endLength+=c.length,a.compact()},deleteAt:function(a,b,c){var d,g,h,j,k,l,m,n,o,p,q;for(d=0,l=[],q=a.ops,o=0,p=q.length;p>o;o++){if(k=q[o],m=d===b||b<d+k.getLength(),c>0&&m){if(g=Math.min(c,k.getLength()-(b-d)),c-=g,e.isInsert(k))j=k.value.substring(0,b-d)+k.value.substring(b-d+g),j.length>0&&l.push(new e(j));else{if(!f.isRetain(k))throw new Error("Expected retain but got "+k);h=new f(k.start,k.start+b-d,i.clone(k.attributes)),n=new f(k.start+b-d+g,k.end,i.clone(k.attributes)),h.start<h.end&&l.push(h),n.start<n.end&&l.push(n)}b+=g}else l.push(k);d+=k.getLength()}return a.ops=l,a.endLength=i.reduce(l,function(a,b){return a+b.getLength()},0)},formatAt:function(b,c,d,g,h){var j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B;for(B=function(a,b,c,d){var g,h,j,k,l,m,n,o,p,q,r,s;if(e.isInsert(a))k=a.value.substring(0,b),j=new e(k,i.clone(a.attributes)),h=a.value.substring(b,b+c),g=new e(h,i.clone(a.attributes)),q=a.value.substring(b+c),p=new e(q,i.clone(a.attributes)),-1!==h.indexOf("\n")&&(m=h.substring(0,h.indexOf("\n")),q=h.substring(h.indexOf("\n"))+q,g=new e(m,i.clone(a.attributes)),p=new e(q,i.clone(a.attributes)));else{if(!f.isRetain(a))throw new Error("Expected retain but got "+a);if(j=new f(a.start,a.start+b,i.clone(a.attributes)),g=new f(j.end,j.end+c,i.clone(a.attributes)),p=new f(g.end,a.end,i.clone(a.attributes)),o=d.getOpsAt(g.start,g.getLength()),!i.every(o,function(a){return e.isInsert(a)}))throw new Error("Non insert op in backref");for(l=g.start,r=0,s=o.length;s>r;r++){if(n=o[r],!e.isInsert(n))throw new Error("Got retainOp in reference delta!");if(-1!==n.value.indexOf("\n")){g=new f(g.start,l+n.value.indexOf("\n"),i.clone(g.attributes)),p=new f(l+n.value.indexOf("\n"),p.end,i.clone(p.attributes));break}l+=n.getLength()}}return[j,g,p]},y=function(a,b,c,d){var e,f,g,h,i,j;for(e=0,g=d[0].attributes[c],j=[],h=0,i=d.length;i>h;h++){if(f=d[h],f.attributes[c]!==g){a.end=a.start+e,b.start=a.end;break}j.push(e+=f.getLength())}return j},s=function(a,b,c,d){var g;if(e.isInsert(a))return null!=a.attributes[c]?delete a.attributes[c]:a.attributes[c]=!0;if(!f.isRetain(a))throw new Error("Expected retain but got "+a);if(null!=a.attributes[c])return delete a.attributes[c];if(g=d.getOpsAt(a.start,a.getLength()),!i.every(g,function(a){return e.isInsert(a)}))throw new Error("Formatting a retain that does not refer to an insert.");if(g.length>0){if(y(a,b,c,g),null!=g[0].attributes[c]){if(!g[0].attributes[c])throw new Error("Boolean attribute on reference delta should only be true!");return a.attributes[c]=null}return a.attributes[c]=!0}},t=function(b,c,d,g){var h,j;if(h=function(b){return i.first(null!=b?i.shuffle(i.without(a.nonBooleanAttributes[d],b)):i.shuffle(i.without(a.nonBooleanAttributes[d],a.defaultAttributeValue[d])))},e.isInsert(b))return b.attributes[d]=h(d,b.attributes[d]);if(!f.isRetain(b))throw new Error("Expected retain but got "+b);if(j=g.getOpsAt(b.start,b.getLength()),!i.every(j,function(a){return e.isInsert(a)}))throw new Error("Formatting a retain that does not refer to an insert.");return j.length>0?(y(b,c,d,j),null!=b.attributes[d]&&Math.random()<.5?delete b.attributes[d]:b.attributes[d]=h(b.attributes[d])):void 0},k=0,p=[],z=b.ops,u=0,w=z.length;w>u;u++){if(o=z[u],q=k===c||k+o.getLength()>c,d>0&&q){for(m=Math.min(d,o.getLength()-(c-k)),d-=m,A=B(o,c-k,m,h),n=A[0],l=A[1],r=A[2],p.push(n),p.push(l),p.push(r),v=0,x=g.length;x>v;v++)if(j=g[v],i.has(a.booleanAttributes,j))s(l,r,j,h);else{if(!i.has(a.nonBooleanAttributes,j))throw new Error("Received unknown attribute: "+j);t(l,r,j,h)}c+=m}else p.push(o);k+=o.getLength()}return b.endLength=i.reduce(p,function(a,b){return a+b.getLength()},0),b.ops=p,b.compact()},addRandomOp:function(b,c){var d,e,f,g,h,j,k;if(e=c.endLength-1,g=i.random(0,e),j=Math.random(),.5>j)h=this.getRandomLength(),this.insertAt(b,g,this.getRandomString(h));else if(.75>j){if(c.endLength<=1)return b;g=i.random(0,e-1),h=i.random(1,e-g),this.deleteAt(b,g,h)}else k=i.shuffle(i.keys(a.booleanAttributes).concat(i.keys(a.nonBooleanAttributes))),f=i.random(1,k.length),d=k.slice(0,f),h=i.random(1,e-g),this.formatAt(b,g,h,d,c);return b},getRandomDelta:function(a,b){var d,e,g;for(e=new c(a.endLength,a.endLength,[new f(0,a.endLength)]),b||(b=i.random(1,10)),d=g=0;b>=0?b>g:g>b;d=b>=0?++g:--g)this.addRandomOp(e,a);return e}}},d={setDomain:h,getUtils:g},b.exports=d}).call(this)},{"./delta":13,"./insert":16,"./retain":18,lodash:"4HJaAd"}],15:[function(a,b){(function(){var c;c=a("googlediff"),c.DIFF_DELETE=-1,c.DIFF_INSERT=1,c.DIFF_EQUAL=0,b.exports=c}).call(this)},{googlediff:21}],16:[function(a,b){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=a("lodash"),d=a("./op"),c=function(a){function b(a,b){this.value=a,null==b&&(b={}),this.attributes=e.clone(b)}return g(b,a),b.prototype.getAt=function(a,c){return new b(this.value.substr(a,c),this.attributes)},b.prototype.getLength=function(){return this.value.length},b.prototype.isEqual=function(a){return null!=a&&this.value===a.value&&e.isEqual(this.attributes,a.attributes)},b.prototype.join=function(a){if(e.isEqual(this.attributes,a.attributes))return new b(this.value+second.value,this.attributes);throw Error},b.prototype.split=function(a){var c,d;return c=new b(this.value.substr(0,a),this.attributes),d=new b(this.value.substr(a),this.attributes),[c,d]},b.prototype.toString=function(){return"{"+this.value+", "+this.printAttributes()+"}"},b}(d),b.exports=c}).call(this)},{"./op":17,lodash:"4HJaAd"}],17:[function(a,b){(function(){var c,d;d=a("lodash"),c=function(){function a(a){null==a&&(a={}),this.attributes=d.clone(a)}return a.isInsert=function(a){return null!=a&&"string"==typeof a.value},a.isRetain=function(a){return null!=a&&"number"==typeof a.start&&"number"==typeof a.end},a.prototype.addAttributes=function(a){var b,c,d;b={};for(c in a)d=a[c],void 0===this.attributes[c]&&(b[c]=d);return b},a.prototype.attributesMatch=function(a){var b;return b=a.attributes||{},d.isEqual(this.attributes,b)},a.prototype.composeAttributes=function(b){var c,e=this;return(c=function(b,f){var g,h,i;if(!f)return b;h=d.clone(b);for(g in f)i=f[g],a.isInsert(e)&&null===i?delete h[g]:"undefined"!=typeof i&&(h[g]="object"==typeof h[g]&&"object"==typeof i&&d.all([h[g],f[g]],function(a){return null!==a})?c(h[g],i):i);return h})(this.attributes,b)},a.prototype.numAttributes=function(){return d.keys(this.attributes).length},a.prototype.printAttributes=function(){return JSON.stringify(this.attributes)},a}(),b.exports=c}).call(this)},{lodash:"4HJaAd"}],18:[function(a,b){(function(){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};e=a("lodash"),c=a("./op"),d=function(a){function b(a,b,c){this.start=a,this.end=b,null==c&&(c={}),this.attributes=e.clone(c)}return g(b,a),b.prototype.getAt=function(a,c){return new b(this.start+a,this.start+a+c,this.attributes)},b.prototype.getLength=function(){return this.end-this.start},b.prototype.isEqual=function(a){return null!=a&&this.start===a.start&&this.end===a.end&&e.isEqual(this.attributes,a.attributes)},b.prototype.split=function(a){var c,d;return c=new b(this.start,this.start+a,this.attributes),d=new b(this.start+a,this.end,this.attributes),[c,d]},b.prototype.toString=function(){return"{{"+this.start+" - "+this.end+"), "+this.printAttributes()+"}"},b}(c),b.exports=d}).call(this)},{"./op":17,lodash:"4HJaAd"}],"38mxji":[function(a,b){(function(){b.exports={Delta:a("./delta"),DeltaGen:a("./delta_generator"),Op:a("./op"),InsertOp:a("./insert"),RetainOp:a("./retain")}}).call(this)},{"./delta":13,"./delta_generator":14,"./insert":16,"./op":17,"./retain":18}],"tandem-core":[function(a,b){b.exports=a("38mxji")},{}],21:[function(a,b){b.exports=a("./javascript/diff_match_patch_uncompressed.js").diff_match_patch},{"./javascript/diff_match_patch_uncompressed.js":22}],22:[function(){function a(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32}var b=-1,c=1,d=0;a.Diff,a.prototype.diff_main=function(a,b,c,e){"undefined"==typeof e&&(e=this.Diff_Timeout<=0?Number.MAX_VALUE:(new Date).getTime()+1e3*this.Diff_Timeout);var f=e;if(null==a||null==b)throw new Error("Null input. (diff_main)");if(a==b)return a?[[d,a]]:[];"undefined"==typeof c&&(c=!0);var g=c,h=this.diff_commonPrefix(a,b),i=a.substring(0,h);a=a.substring(h),b=b.substring(h),h=this.diff_commonSuffix(a,b);var j=a.substring(a.length-h);a=a.substring(0,a.length-h),b=b.substring(0,b.length-h);var k=this.diff_compute_(a,b,g,f);return i&&k.unshift([d,i]),j&&k.push([d,j]),this.diff_cleanupMerge(k),k},a.prototype.diff_compute_=function(a,e,f,g){var h;if(!a)return[[c,e]];if(!e)return[[b,a]];var i=a.length>e.length?a:e,j=a.length>e.length?e:a,k=i.indexOf(j);if(-1!=k)return h=[[c,i.substring(0,k)],[d,j],[c,i.substring(k+j.length)]],a.length>e.length&&(h[0][0]=h[2][0]=b),h;if(1==j.length)return[[b,a],[c,e]];var l=this.diff_halfMatch_(a,e);if(l){var m=l[0],n=l[1],o=l[2],p=l[3],q=l[4],r=this.diff_main(m,o,f,g),s=this.diff_main(n,p,f,g);return r.concat([[d,q]],s)}return f&&a.length>100&&e.length>100?this.diff_lineMode_(a,e,g):this.diff_bisect_(a,e,g)},a.prototype.diff_lineMode_=function(a,e,f){var g=this.diff_linesToChars_(a,e);a=g.chars1,e=g.chars2;var h=g.lineArray,i=this.diff_main(a,e,!1,f);this.diff_charsToLines_(i,h),this.diff_cleanupSemantic(i),i.push([d,""]);for(var j=0,k=0,l=0,m="",n="";j<i.length;){switch(i[j][0]){case c:l++,n+=i[j][1];break;case b:k++,m+=i[j][1];break;case d:if(k>=1&&l>=1){i.splice(j-k-l,k+l),j=j-k-l;for(var g=this.diff_main(m,n,!1,f),o=g.length-1;o>=0;o--)i.splice(j,0,g[o]);j+=g.length}l=0,k=0,m="",n=""}j++}return i.pop(),i},a.prototype.diff_bisect_=function(a,d,e){for(var f=a.length,g=d.length,h=Math.ceil((f+g)/2),i=h,j=2*h,k=new Array(j),l=new Array(j),m=0;j>m;m++)k[m]=-1,l[m]=-1;k[i+1]=0,l[i+1]=0;for(var n=f-g,o=n%2!=0,p=0,q=0,r=0,s=0,t=0;h>t&&!((new Date).getTime()>e);t++){for(var u=-t+p;t-q>=u;u+=2){var v,w=i+u;v=u==-t||u!=t&&k[w-1]<k[w+1]?k[w+1]:k[w-1]+1;for(var x=v-u;f>v&&g>x&&a.charAt(v)==d.charAt(x);)v++,x++;if(k[w]=v,v>f)q+=2;else if(x>g)p+=2;else if(o){var y=i+n-u;if(y>=0&&j>y&&-1!=l[y]){var z=f-l[y];if(v>=z)return this.diff_bisectSplit_(a,d,v,x,e)}}}for(var A=-t+r;t-s>=A;A+=2){var z,y=i+A;z=A==-t||A!=t&&l[y-1]<l[y+1]?l[y+1]:l[y-1]+1;for(var B=z-A;f>z&&g>B&&a.charAt(f-z-1)==d.charAt(g-B-1);)z++,B++;if(l[y]=z,z>f)s+=2;else if(B>g)r+=2;else if(!o){var w=i+n-A;if(w>=0&&j>w&&-1!=k[w]){var v=k[w],x=i+v-w;if(z=f-z,v>=z)return this.diff_bisectSplit_(a,d,v,x,e)}}}}return[[b,a],[c,d]]},a.prototype.diff_bisectSplit_=function(a,b,c,d,e){var f=a.substring(0,c),g=b.substring(0,d),h=a.substring(c),i=b.substring(d),j=this.diff_main(f,g,!1,e),k=this.diff_main(h,i,!1,e);return j.concat(k)},a.prototype.diff_linesToChars_=function(a,b){function c(a){for(var b="",c=0,f=-1,g=d.length;f<a.length-1;){f=a.indexOf("\n",c),-1==f&&(f=a.length-1);var h=a.substring(c,f+1);c=f+1,(e.hasOwnProperty?e.hasOwnProperty(h):void 0!==e[h])?b+=String.fromCharCode(e[h]):(b+=String.fromCharCode(g),e[h]=g,d[g++]=h)}return b}var d=[],e={};d[0]="";var f=c(a),g=c(b);return{chars1:f,chars2:g,lineArray:d}},a.prototype.diff_charsToLines_=function(a,b){for(var c=0;c<a.length;c++){for(var d=a[c][1],e=[],f=0;f<d.length;f++)e[f]=b[d.charCodeAt(f)];a[c][1]=e.join("")}},a.prototype.diff_commonPrefix=function(a,b){if(!a||!b||a.charAt(0)!=b.charAt(0))return 0;for(var c=0,d=Math.min(a.length,b.length),e=d,f=0;e>c;)a.substring(f,e)==b.substring(f,e)?(c=e,f=c):d=e,e=Math.floor((d-c)/2+c);return e},a.prototype.diff_commonSuffix=function(a,b){if(!a||!b||a.charAt(a.length-1)!=b.charAt(b.length-1))return 0;for(var c=0,d=Math.min(a.length,b.length),e=d,f=0;e>c;)a.substring(a.length-e,a.length-f)==b.substring(b.length-e,b.length-f)?(c=e,f=c):d=e,e=Math.floor((d-c)/2+c);return e},a.prototype.diff_commonOverlap_=function(a,b){var c=a.length,d=b.length;if(0==c||0==d)return 0;c>d?a=a.substring(c-d):d>c&&(b=b.substring(0,c));var e=Math.min(c,d);if(a==b)return e;for(var f=0,g=1;;){var h=a.substring(e-g),i=b.indexOf(h);if(-1==i)return f;g+=i,(0==i||a.substring(e-g)==b.substring(0,g))&&(f=g,g++)}},a.prototype.diff_halfMatch_=function(a,b){function c(a,b,c){for(var d,e,f,h,i=a.substring(c,c+Math.floor(a.length/4)),j=-1,k="";-1!=(j=b.indexOf(i,j+1));){var l=g.diff_commonPrefix(a.substring(c),b.substring(j)),m=g.diff_commonSuffix(a.substring(0,c),b.substring(0,j));k.length<m+l&&(k=b.substring(j-m,j)+b.substring(j,j+l),d=a.substring(0,c-m),e=a.substring(c+l),f=b.substring(0,j-m),h=b.substring(j+l))}return 2*k.length>=a.length?[d,e,f,h,k]:null}if(this.Diff_Timeout<=0)return null;var d=a.length>b.length?a:b,e=a.length>b.length?b:a;if(d.length<4||2*e.length<d.length)return null;var f,g=this,h=c(d,e,Math.ceil(d.length/4)),i=c(d,e,Math.ceil(d.length/2));if(!h&&!i)return null;f=i?h&&h[4].length>i[4].length?h:i:h;var j,k,l,m;a.length>b.length?(j=f[0],k=f[1],l=f[2],m=f[3]):(l=f[0],m=f[1],j=f[2],k=f[3]);var n=f[4];return[j,k,l,m,n]},a.prototype.diff_cleanupSemantic=function(a){for(var e=!1,f=[],g=0,h=null,i=0,j=0,k=0,l=0,m=0;i<a.length;)a[i][0]==d?(f[g++]=i,j=l,k=m,l=0,m=0,h=a[i][1]):(a[i][0]==c?l+=a[i][1].length:m+=a[i][1].length,h&&h.length<=Math.max(j,k)&&h.length<=Math.max(l,m)&&(a.splice(f[g-1],0,[b,h]),a[f[g-1]+1][0]=c,g--,g--,i=g>0?f[g-1]:-1,j=0,k=0,l=0,m=0,h=null,e=!0)),i++;for(e&&this.diff_cleanupMerge(a),this.diff_cleanupSemanticLossless(a),i=1;i<a.length;){if(a[i-1][0]==b&&a[i][0]==c){var n=a[i-1][1],o=a[i][1],p=this.diff_commonOverlap_(n,o),q=this.diff_commonOverlap_(o,n);p>=q?(p>=n.length/2||p>=o.length/2)&&(a.splice(i,0,[d,o.substring(0,p)]),a[i-1][1]=n.substring(0,n.length-p),a[i+1][1]=o.substring(p),i++):(q>=n.length/2||q>=o.length/2)&&(a.splice(i,0,[d,n.substring(0,q)]),a[i-1][0]=c,a[i-1][1]=o.substring(0,o.length-q),a[i+1][0]=b,a[i+1][1]=n.substring(q),i++),i++}i++}},a.prototype.diff_cleanupSemanticLossless=function(b){function c(b,c){if(!b||!c)return 6;var d=b.charAt(b.length-1),e=c.charAt(0),f=d.match(a.nonAlphaNumericRegex_),g=e.match(a.nonAlphaNumericRegex_),h=f&&d.match(a.whitespaceRegex_),i=g&&e.match(a.whitespaceRegex_),j=h&&d.match(a.linebreakRegex_),k=i&&e.match(a.linebreakRegex_),l=j&&b.match(a.blanklineEndRegex_),m=k&&c.match(a.blanklineStartRegex_);return l||m?5:j||k?4:f&&!h&&i?3:h||i?2:f||g?1:0}for(var e=1;e<b.length-1;){if(b[e-1][0]==d&&b[e+1][0]==d){var f=b[e-1][1],g=b[e][1],h=b[e+1][1],i=this.diff_commonSuffix(f,g);if(i){var j=g.substring(g.length-i);f=f.substring(0,f.length-i),g=j+g.substring(0,g.length-i),h=j+h}for(var k=f,l=g,m=h,n=c(f,g)+c(g,h);g.charAt(0)===h.charAt(0);){f+=g.charAt(0),g=g.substring(1)+h.charAt(0),h=h.substring(1);var o=c(f,g)+c(g,h);o>=n&&(n=o,k=f,l=g,m=h)}b[e-1][1]!=k&&(k?b[e-1][1]=k:(b.splice(e-1,1),e--),b[e][1]=l,m?b[e+1][1]=m:(b.splice(e+1,1),e--))}e++}},a.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,a.whitespaceRegex_=/\s/,a.linebreakRegex_=/[\r\n]/,a.blanklineEndRegex_=/\n\r?\n$/,a.blanklineStartRegex_=/^\r?\n\r?\n/,a.prototype.diff_cleanupEfficiency=function(a){for(var e=!1,f=[],g=0,h=null,i=0,j=!1,k=!1,l=!1,m=!1;i<a.length;)a[i][0]==d?(a[i][1].length<this.Diff_EditCost&&(l||m)?(f[g++]=i,j=l,k=m,h=a[i][1]):(g=0,h=null),l=m=!1):(a[i][0]==b?m=!0:l=!0,h&&(j&&k&&l&&m||h.length<this.Diff_EditCost/2&&j+k+l+m==3)&&(a.splice(f[g-1],0,[b,h]),a[f[g-1]+1][0]=c,g--,h=null,j&&k?(l=m=!0,g=0):(g--,i=g>0?f[g-1]:-1,l=m=!1),e=!0)),i++;e&&this.diff_cleanupMerge(a)},a.prototype.diff_cleanupMerge=function(a){a.push([d,""]);for(var e,f=0,g=0,h=0,i="",j="";f<a.length;)switch(a[f][0]){case c:h++,j+=a[f][1],f++;break;case b:g++,i+=a[f][1],f++;break;case d:g+h>1?(0!==g&&0!==h&&(e=this.diff_commonPrefix(j,i),0!==e&&(f-g-h>0&&a[f-g-h-1][0]==d?a[f-g-h-1][1]+=j.substring(0,e):(a.splice(0,0,[d,j.substring(0,e)]),f++),j=j.substring(e),i=i.substring(e)),e=this.diff_commonSuffix(j,i),0!==e&&(a[f][1]=j.substring(j.length-e)+a[f][1],j=j.substring(0,j.length-e),i=i.substring(0,i.length-e))),0===g?a.splice(f-h,g+h,[c,j]):0===h?a.splice(f-g,g+h,[b,i]):a.splice(f-g-h,g+h,[b,i],[c,j]),f=f-g-h+(g?1:0)+(h?1:0)+1):0!==f&&a[f-1][0]==d?(a[f-1][1]+=a[f][1],a.splice(f,1)):f++,h=0,g=0,i="",j=""}""===a[a.length-1][1]&&a.pop();var k=!1;for(f=1;f<a.length-1;)a[f-1][0]==d&&a[f+1][0]==d&&(a[f][1].substring(a[f][1].length-a[f-1][1].length)==a[f-1][1]?(a[f][1]=a[f-1][1]+a[f][1].substring(0,a[f][1].length-a[f-1][1].length),a[f+1][1]=a[f-1][1]+a[f+1][1],a.splice(f-1,1),k=!0):a[f][1].substring(0,a[f+1][1].length)==a[f+1][1]&&(a[f-1][1]+=a[f+1][1],a[f][1]=a[f][1].substring(a[f+1][1].length)+a[f+1][1],a.splice(f+1,1),k=!0)),f++;k&&this.diff_cleanupMerge(a)},a.prototype.diff_xIndex=function(a,d){var e,f=0,g=0,h=0,i=0;for(e=0;e<a.length&&(a[e][0]!==c&&(f+=a[e][1].length),a[e][0]!==b&&(g+=a[e][1].length),!(f>d));e++)h=f,i=g;return a.length!=e&&a[e][0]===b?i:i+(d-h)},a.prototype.diff_prettyHtml=function(a){for(var e=[],f=/&/g,g=/</g,h=/>/g,i=/\n/g,j=0;j<a.length;j++){var k=a[j][0],l=a[j][1],m=l.replace(f,"&amp;").replace(g,"&lt;").replace(h,"&gt;").replace(i,"&para;<br>");switch(k){case c:e[j]='<ins style="background:#e6ffe6;">'+m+"</ins>";break;case b:e[j]='<del style="background:#ffe6e6;">'+m+"</del>";break;case d:e[j]="<span>"+m+"</span>"}}return e.join("")},a.prototype.diff_text1=function(a){for(var b=[],d=0;d<a.length;d++)a[d][0]!==c&&(b[d]=a[d][1]);return b.join("")},a.prototype.diff_text2=function(a){for(var c=[],d=0;d<a.length;d++)a[d][0]!==b&&(c[d]=a[d][1]);return c.join("")},a.prototype.diff_levenshtein=function(a){for(var e=0,f=0,g=0,h=0;h<a.length;h++){var i=a[h][0],j=a[h][1];switch(i){case c:f+=j.length;break;case b:g+=j.length;break;case d:e+=Math.max(f,g),f=0,g=0}}return e+=Math.max(f,g)},a.prototype.diff_toDelta=function(a){for(var e=[],f=0;f<a.length;f++)switch(a[f][0]){case c:e[f]="+"+encodeURI(a[f][1]);break;case b:e[f]="-"+a[f][1].length;break;case d:e[f]="="+a[f][1].length}return e.join("  ").replace(/%20/g," ")},a.prototype.diff_fromDelta=function(a,e){for(var f=[],g=0,h=0,i=e.split(/\t/g),j=0;j<i.length;j++){var k=i[j].substring(1);switch(i[j].charAt(0)){case"+":try{f[g++]=[c,decodeURI(k)]
}catch(l){throw new Error("Illegal escape in diff_fromDelta: "+k)}break;case"-":case"=":var m=parseInt(k,10);if(isNaN(m)||0>m)throw new Error("Invalid number in diff_fromDelta: "+k);var n=a.substring(h,h+=m);f[g++]="="==i[j].charAt(0)?[d,n]:[b,n];break;default:if(i[j])throw new Error("Invalid diff operation in diff_fromDelta: "+i[j])}}if(h!=a.length)throw new Error("Delta length ("+h+") does not equal source text length ("+a.length+").");return f},a.prototype.match_main=function(a,b,c){if(null==a||null==b||null==c)throw new Error("Null input. (match_main)");return c=Math.max(0,Math.min(c,a.length)),a==b?0:a.length?a.substring(c,c+b.length)==b?c:this.match_bitap_(a,b,c):-1},a.prototype.match_bitap_=function(a,b,c){function d(a,d){var e=a/b.length,g=Math.abs(c-d);return f.Match_Distance?e+g/f.Match_Distance:g?1:e}if(b.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var e=this.match_alphabet_(b),f=this,g=this.Match_Threshold,h=a.indexOf(b,c);-1!=h&&(g=Math.min(d(0,h),g),h=a.lastIndexOf(b,c+b.length),-1!=h&&(g=Math.min(d(0,h),g)));var i=1<<b.length-1;h=-1;for(var j,k,l,m=b.length+a.length,n=0;n<b.length;n++){for(j=0,k=m;k>j;)d(n,c+k)<=g?j=k:m=k,k=Math.floor((m-j)/2+j);m=k;var o=Math.max(1,c-k+1),p=Math.min(c+k,a.length)+b.length,q=Array(p+2);q[p+1]=(1<<n)-1;for(var r=p;r>=o;r--){var s=e[a.charAt(r-1)];if(q[r]=0===n?(q[r+1]<<1|1)&s:(q[r+1]<<1|1)&s|((l[r+1]|l[r])<<1|1)|l[r+1],q[r]&i){var t=d(n,r-1);if(g>=t){if(g=t,h=r-1,!(h>c))break;o=Math.max(1,2*c-h)}}}if(d(n+1,c)>g)break;l=q}return h},a.prototype.match_alphabet_=function(a){for(var b={},c=0;c<a.length;c++)b[a.charAt(c)]=0;for(var c=0;c<a.length;c++)b[a.charAt(c)]|=1<<a.length-c-1;return b},a.prototype.patch_addContext_=function(a,b){if(0!=b.length){for(var c=b.substring(a.start2,a.start2+a.length1),e=0;b.indexOf(c)!=b.lastIndexOf(c)&&c.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)e+=this.Patch_Margin,c=b.substring(a.start2-e,a.start2+a.length1+e);e+=this.Patch_Margin;var f=b.substring(a.start2-e,a.start2);f&&a.diffs.unshift([d,f]);var g=b.substring(a.start2+a.length1,a.start2+a.length1+e);g&&a.diffs.push([d,g]),a.start1-=f.length,a.start2-=f.length,a.length1+=f.length+g.length,a.length2+=f.length+g.length}},a.prototype.patch_make=function(e,f,g){var h,i;if("string"==typeof e&&"string"==typeof f&&"undefined"==typeof g)h=e,i=this.diff_main(h,f,!0),i.length>2&&(this.diff_cleanupSemantic(i),this.diff_cleanupEfficiency(i));else if(e&&"object"==typeof e&&"undefined"==typeof f&&"undefined"==typeof g)i=e,h=this.diff_text1(i);else if("string"==typeof e&&f&&"object"==typeof f&&"undefined"==typeof g)h=e,i=f;else{if("string"!=typeof e||"string"!=typeof f||!g||"object"!=typeof g)throw new Error("Unknown call format to patch_make.");h=e,i=g}if(0===i.length)return[];for(var j=[],k=new a.patch_obj,l=0,m=0,n=0,o=h,p=h,q=0;q<i.length;q++){var r=i[q][0],s=i[q][1];switch(l||r===d||(k.start1=m,k.start2=n),r){case c:k.diffs[l++]=i[q],k.length2+=s.length,p=p.substring(0,n)+s+p.substring(n);break;case b:k.length1+=s.length,k.diffs[l++]=i[q],p=p.substring(0,n)+p.substring(n+s.length);break;case d:s.length<=2*this.Patch_Margin&&l&&i.length!=q+1?(k.diffs[l++]=i[q],k.length1+=s.length,k.length2+=s.length):s.length>=2*this.Patch_Margin&&l&&(this.patch_addContext_(k,o),j.push(k),k=new a.patch_obj,l=0,o=p,m=n)}r!==c&&(m+=s.length),r!==b&&(n+=s.length)}return l&&(this.patch_addContext_(k,o),j.push(k)),j},a.prototype.patch_deepCopy=function(b){for(var c=[],d=0;d<b.length;d++){var e=b[d],f=new a.patch_obj;f.diffs=[];for(var g=0;g<e.diffs.length;g++)f.diffs[g]=e.diffs[g].slice();f.start1=e.start1,f.start2=e.start2,f.length1=e.length1,f.length2=e.length2,c[d]=f}return c},a.prototype.patch_apply=function(a,e){if(0==a.length)return[e,[]];a=this.patch_deepCopy(a);var f=this.patch_addPadding(a);e=f+e+f,this.patch_splitMax(a);for(var g=0,h=[],i=0;i<a.length;i++){var j,k=a[i].start2+g,l=this.diff_text1(a[i].diffs),m=-1;if(l.length>this.Match_MaxBits?(j=this.match_main(e,l.substring(0,this.Match_MaxBits),k),-1!=j&&(m=this.match_main(e,l.substring(l.length-this.Match_MaxBits),k+l.length-this.Match_MaxBits),(-1==m||j>=m)&&(j=-1))):j=this.match_main(e,l,k),-1==j)h[i]=!1,g-=a[i].length2-a[i].length1;else{h[i]=!0,g=j-k;var n;if(n=-1==m?e.substring(j,j+l.length):e.substring(j,m+this.Match_MaxBits),l==n)e=e.substring(0,j)+this.diff_text2(a[i].diffs)+e.substring(j+l.length);else{var o=this.diff_main(l,n,!1);if(l.length>this.Match_MaxBits&&this.diff_levenshtein(o)/l.length>this.Patch_DeleteThreshold)h[i]=!1;else{this.diff_cleanupSemanticLossless(o);for(var p,q=0,r=0;r<a[i].diffs.length;r++){var s=a[i].diffs[r];s[0]!==d&&(p=this.diff_xIndex(o,q)),s[0]===c?e=e.substring(0,j+p)+s[1]+e.substring(j+p):s[0]===b&&(e=e.substring(0,j+p)+e.substring(j+this.diff_xIndex(o,q+s[1].length))),s[0]!==b&&(q+=s[1].length)}}}}}return e=e.substring(f.length,e.length-f.length),[e,h]},a.prototype.patch_addPadding=function(a){for(var b=this.Patch_Margin,c="",e=1;b>=e;e++)c+=String.fromCharCode(e);for(var e=0;e<a.length;e++)a[e].start1+=b,a[e].start2+=b;var f=a[0],g=f.diffs;if(0==g.length||g[0][0]!=d)g.unshift([d,c]),f.start1-=b,f.start2-=b,f.length1+=b,f.length2+=b;else if(b>g[0][1].length){var h=b-g[0][1].length;g[0][1]=c.substring(g[0][1].length)+g[0][1],f.start1-=h,f.start2-=h,f.length1+=h,f.length2+=h}if(f=a[a.length-1],g=f.diffs,0==g.length||g[g.length-1][0]!=d)g.push([d,c]),f.length1+=b,f.length2+=b;else if(b>g[g.length-1][1].length){var h=b-g[g.length-1][1].length;g[g.length-1][1]+=c.substring(0,h),f.length1+=h,f.length2+=h}return c},a.prototype.patch_splitMax=function(e){for(var f=this.Match_MaxBits,g=0;g<e.length;g++)if(!(e[g].length1<=f)){var h=e[g];e.splice(g--,1);for(var i=h.start1,j=h.start2,k="";0!==h.diffs.length;){var l=new a.patch_obj,m=!0;for(l.start1=i-k.length,l.start2=j-k.length,""!==k&&(l.length1=l.length2=k.length,l.diffs.push([d,k]));0!==h.diffs.length&&l.length1<f-this.Patch_Margin;){var n=h.diffs[0][0],o=h.diffs[0][1];n===c?(l.length2+=o.length,j+=o.length,l.diffs.push(h.diffs.shift()),m=!1):n===b&&1==l.diffs.length&&l.diffs[0][0]==d&&o.length>2*f?(l.length1+=o.length,i+=o.length,m=!1,l.diffs.push([n,o]),h.diffs.shift()):(o=o.substring(0,f-l.length1-this.Patch_Margin),l.length1+=o.length,i+=o.length,n===d?(l.length2+=o.length,j+=o.length):m=!1,l.diffs.push([n,o]),o==h.diffs[0][1]?h.diffs.shift():h.diffs[0][1]=h.diffs[0][1].substring(o.length))}k=this.diff_text2(l.diffs),k=k.substring(k.length-this.Patch_Margin);var p=this.diff_text1(h.diffs).substring(0,this.Patch_Margin);""!==p&&(l.length1+=p.length,l.length2+=p.length,0!==l.diffs.length&&l.diffs[l.diffs.length-1][0]===d?l.diffs[l.diffs.length-1][1]+=p:l.diffs.push([d,p])),m||e.splice(++g,0,l)}}},a.prototype.patch_toText=function(a){for(var b=[],c=0;c<a.length;c++)b[c]=a[c];return b.join("")},a.prototype.patch_fromText=function(e){var f=[];if(!e)return f;for(var g=e.split("\n"),h=0,i=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;h<g.length;){var j=g[h].match(i);if(!j)throw new Error("Invalid patch string: "+g[h]);var k=new a.patch_obj;for(f.push(k),k.start1=parseInt(j[1],10),""===j[2]?(k.start1--,k.length1=1):"0"==j[2]?k.length1=0:(k.start1--,k.length1=parseInt(j[2],10)),k.start2=parseInt(j[3],10),""===j[4]?(k.start2--,k.length2=1):"0"==j[4]?k.length2=0:(k.start2--,k.length2=parseInt(j[4],10)),h++;h<g.length;){var l=g[h].charAt(0);try{var m=decodeURI(g[h].substring(1))}catch(n){throw new Error("Illegal escape in patch_fromText: "+m)}if("-"==l)k.diffs.push([b,m]);else if("+"==l)k.diffs.push([c,m]);else if(" "==l)k.diffs.push([d,m]);else{if("@"==l)break;if(""!==l)throw new Error('Invalid patch mode "'+l+'" in: '+m)}h++}}return f},a.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0},a.patch_obj.prototype.toString=function(){var a,e;a=0===this.length1?this.start1+",0":1==this.length1?this.start1+1:this.start1+1+","+this.length1,e=0===this.length2?this.start2+",0":1==this.length2?this.start2+1:this.start2+1+","+this.length2;for(var f,g=["@@ -"+a+" +"+e+" @@\n"],h=0;h<this.diffs.length;h++){switch(this.diffs[h][0]){case c:f="+";break;case b:f="-";break;case d:f=" "}g[h+1]=f+encodeURI(this.diffs[h][1])+"\n"}return g.join("").replace(/%20/g," ")},this.diff_match_patch=a,this.DIFF_DELETE=b,this.DIFF_INSERT=c,this.DIFF_EQUAL=d},{}],"underscore.string":[function(a,b){b.exports=a("Fq7WE+")},{}],"Fq7WE+":[function(b,c,d){!function(b,e){"use strict";function f(a,b){var c,d,e=a.toLowerCase();for(b=[].concat(b),c=0;c<b.length;c+=1)if(d=b[c]){if(d.test&&d.test(a))return!0;if(d.toLowerCase()===e)return!0}}var g=e.prototype.trim,h=e.prototype.trimRight,i=e.prototype.trimLeft,j=function(a){return 1*a||0},k=function(a,b){if(1>b)return"";for(var c="";b>0;)1&b&&(c+=a),b>>=1,a+=a;return c},l=[].slice,m=function(a){return null==a?"\\s":a.source?a.source:"["+r.escapeRegExp(a)+"]"},n={lt:"<",gt:">",quot:'"',amp:"&",apos:"'"},o={};for(var p in n)o[n[p]]=p;o["'"]="#39";var q=function(){function a(a){return Object.prototype.toString.call(a).slice(8,-1).toLowerCase()}var b=k,c=function(){return c.cache.hasOwnProperty(arguments[0])||(c.cache[arguments[0]]=c.parse(arguments[0])),c.format.call(null,c.cache[arguments[0]],arguments)};return c.format=function(c,d){var f,g,h,i,j,k,l,m=1,n=c.length,o="",p=[];for(g=0;n>g;g++)if(o=a(c[g]),"string"===o)p.push(c[g]);else if("array"===o){if(i=c[g],i[2])for(f=d[m],h=0;h<i[2].length;h++){if(!f.hasOwnProperty(i[2][h]))throw new Error(q('[_.sprintf] property "%s" does not exist',i[2][h]));f=f[i[2][h]]}else f=i[1]?d[i[1]]:d[m++];if(/[^s]/.test(i[8])&&"number"!=a(f))throw new Error(q("[_.sprintf] expecting number but found %s",a(f)));switch(i[8]){case"b":f=f.toString(2);break;case"c":f=e.fromCharCode(f);break;case"d":f=parseInt(f,10);break;case"e":f=i[7]?f.toExponential(i[7]):f.toExponential();break;case"f":f=i[7]?parseFloat(f).toFixed(i[7]):parseFloat(f);break;case"o":f=f.toString(8);break;case"s":f=(f=e(f))&&i[7]?f.substring(0,i[7]):f;break;case"u":f=Math.abs(f);break;case"x":f=f.toString(16);break;case"X":f=f.toString(16).toUpperCase()}f=/[def]/.test(i[8])&&i[3]&&f>=0?"+"+f:f,k=i[4]?"0"==i[4]?"0":i[4].charAt(1):" ",l=i[6]-e(f).length,j=i[6]?b(k,l):"",p.push(i[5]?f+j:j+f)}return p.join("")},c.cache={},c.parse=function(a){for(var b=a,c=[],d=[],e=0;b;){if(null!==(c=/^[^\x25]+/.exec(b)))d.push(c[0]);else if(null!==(c=/^\x25{2}/.exec(b)))d.push("%");else{if(null===(c=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(b)))throw new Error("[_.sprintf] huh?");if(c[2]){e|=1;var f=[],g=c[2],h=[];if(null===(h=/^([a-z_][a-z_\d]*)/i.exec(g)))throw new Error("[_.sprintf] huh?");for(f.push(h[1]);""!==(g=g.substring(h[0].length));)if(null!==(h=/^\.([a-z_][a-z_\d]*)/i.exec(g)))f.push(h[1]);else{if(null===(h=/^\[(\d+)\]/.exec(g)))throw new Error("[_.sprintf] huh?");f.push(h[1])}c[2]=f}else e|=2;if(3===e)throw new Error("[_.sprintf] mixing positional and named placeholders is not (yet) supported");d.push(c)}b=b.substring(c[0].length)}return d},c}(),r={VERSION:"2.3.0",isBlank:function(a){return null==a&&(a=""),/^\s*$/.test(a)},stripTags:function(a){return null==a?"":e(a).replace(/<\/?[^>]+>/g,"")},capitalize:function(a){return a=null==a?"":e(a),a.charAt(0).toUpperCase()+a.slice(1)},chop:function(a,b){return null==a?[]:(a=e(a),b=~~b,b>0?a.match(new RegExp(".{1,"+b+"}","g")):[a])},clean:function(a){return r.strip(a).replace(/\s+/g," ")},count:function(a,b){if(null==a||null==b)return 0;a=e(a),b=e(b);for(var c=0,d=0,f=b.length;;){if(d=a.indexOf(b,d),-1===d)break;c++,d+=f}return c},chars:function(a){return null==a?[]:e(a).split("")},swapCase:function(a){return null==a?"":e(a).replace(/\S/g,function(a){return a===a.toUpperCase()?a.toLowerCase():a.toUpperCase()})},escapeHTML:function(a){return null==a?"":e(a).replace(/[&<>"']/g,function(a){return"&"+o[a]+";"})},unescapeHTML:function(a){return null==a?"":e(a).replace(/\&([^;]+);/g,function(a,b){var c;return b in n?n[b]:(c=b.match(/^#x([\da-fA-F]+)$/))?e.fromCharCode(parseInt(c[1],16)):(c=b.match(/^#(\d+)$/))?e.fromCharCode(~~c[1]):a})},escapeRegExp:function(a){return null==a?"":e(a).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")},splice:function(a,b,c,d){var e=r.chars(a);return e.splice(~~b,~~c,d),e.join("")},insert:function(a,b,c){return r.splice(a,b,0,c)},include:function(a,b){return""===b?!0:null==a?!1:-1!==e(a).indexOf(b)},join:function(){var a=l.call(arguments),b=a.shift();return null==b&&(b=""),a.join(b)},lines:function(a){return null==a?[]:e(a).split("\n")},reverse:function(a){return r.chars(a).reverse().join("")},startsWith:function(a,b){return""===b?!0:null==a||null==b?!1:(a=e(a),b=e(b),a.length>=b.length&&a.slice(0,b.length)===b)},endsWith:function(a,b){return""===b?!0:null==a||null==b?!1:(a=e(a),b=e(b),a.length>=b.length&&a.slice(a.length-b.length)===b)},succ:function(a){return null==a?"":(a=e(a),a.slice(0,-1)+e.fromCharCode(a.charCodeAt(a.length-1)+1))},titleize:function(a){return null==a?"":(a=e(a).toLowerCase(),a.replace(/(?:^|\s|-)\S/g,function(a){return a.toUpperCase()}))},camelize:function(a){return r.trim(a).replace(/[-_\s]+(.)?/g,function(a,b){return b?b.toUpperCase():""})},underscored:function(a){return r.trim(a).replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/[-\s]+/g,"_").toLowerCase()},dasherize:function(a){return r.trim(a).replace(/([A-Z])/g,"-$1").replace(/[-_\s]+/g,"-").toLowerCase()},classify:function(a){return r.titleize(e(a).replace(/[\W_]/g," ")).replace(/\s/g,"")},humanize:function(a){return r.capitalize(r.underscored(a).replace(/_id$/,"").replace(/_/g," "))},trim:function(a,b){return null==a?"":!b&&g?g.call(a):(b=m(b),e(a).replace(new RegExp("^"+b+"+|"+b+"+$","g"),""))},ltrim:function(a,b){return null==a?"":!b&&i?i.call(a):(b=m(b),e(a).replace(new RegExp("^"+b+"+"),""))},rtrim:function(a,b){return null==a?"":!b&&h?h.call(a):(b=m(b),e(a).replace(new RegExp(b+"+$"),""))},truncate:function(a,b,c){return null==a?"":(a=e(a),c=c||"...",b=~~b,a.length>b?a.slice(0,b)+c:a)},prune:function(a,b,c){if(null==a)return"";if(a=e(a),b=~~b,c=null!=c?e(c):"...",a.length<=b)return a;var d=function(a){return a.toUpperCase()!==a.toLowerCase()?"A":" "},f=a.slice(0,b+1).replace(/.(?=\W*\w*$)/g,d);return f=f.slice(f.length-2).match(/\w\w/)?f.replace(/\s*\S+$/,""):r.rtrim(f.slice(0,f.length-1)),(f+c).length>a.length?a:a.slice(0,f.length)+c},words:function(a,b){return r.isBlank(a)?[]:r.trim(a,b).split(b||/\s+/)},pad:function(a,b,c,d){a=null==a?"":e(a),b=~~b;var f=0;switch(c?c.length>1&&(c=c.charAt(0)):c=" ",d){case"right":return f=b-a.length,a+k(c,f);case"both":return f=b-a.length,k(c,Math.ceil(f/2))+a+k(c,Math.floor(f/2));default:return f=b-a.length,k(c,f)+a}},lpad:function(a,b,c){return r.pad(a,b,c)},rpad:function(a,b,c){return r.pad(a,b,c,"right")},lrpad:function(a,b,c){return r.pad(a,b,c,"both")},sprintf:q,vsprintf:function(a,b){return b.unshift(a),q.apply(null,b)},toNumber:function(a,b){return a?(a=r.trim(a),a.match(/^-?\d+(?:\.\d+)?$/)?j(j(a).toFixed(~~b)):0/0):0},numberFormat:function(a,b,c,d){if(isNaN(a)||null==a)return"";a=a.toFixed(~~b),d="string"==typeof d?d:",";var e=a.split("."),f=e[0],g=e[1]?(c||".")+e[1]:"";return f.replace(/(\d)(?=(?:\d{3})+$)/g,"$1"+d)+g},strRight:function(a,b){if(null==a)return"";a=e(a),b=null!=b?e(b):b;var c=b?a.indexOf(b):-1;return~c?a.slice(c+b.length,a.length):a},strRightBack:function(a,b){if(null==a)return"";a=e(a),b=null!=b?e(b):b;var c=b?a.lastIndexOf(b):-1;return~c?a.slice(c+b.length,a.length):a},strLeft:function(a,b){if(null==a)return"";a=e(a),b=null!=b?e(b):b;var c=b?a.indexOf(b):-1;return~c?a.slice(0,c):a},strLeftBack:function(a,b){if(null==a)return"";a+="",b=null!=b?""+b:b;var c=a.lastIndexOf(b);return~c?a.slice(0,c):a},toSentence:function(a,b,c,d){b=b||", ",c=c||" and ";var e=a.slice(),f=e.pop();return a.length>2&&d&&(c=r.rtrim(b)+c),e.length?e.join(b)+c+f:f},toSentenceSerial:function(){var a=l.call(arguments);return a[3]=!0,r.toSentence.apply(r,a)},slugify:function(a){if(null==a)return"";var b="ąàáäâãåæăćęèéëêìíïîłńòóöôõøśșțùúüûñçżź",c="aaaaaaaaaceeeeeiiiilnoooooosstuuuunczz",d=new RegExp(m(b),"g");return a=e(a).toLowerCase().replace(d,function(a){var d=b.indexOf(a);return c.charAt(d)||"-"}),r.dasherize(a.replace(/[^\w\s-]/g,""))},surround:function(a,b){return[b,a,b].join("")},quote:function(a,b){return r.surround(a,b||'"')},unquote:function(a,b){return b=b||'"',a[0]===b&&a[a.length-1]===b?a.slice(1,a.length-1):a},exports:function(){var a={};for(var b in this)this.hasOwnProperty(b)&&!b.match(/^(?:include|contains|reverse)$/)&&(a[b]=this[b]);return a},repeat:function(a,b,c){if(null==a)return"";if(b=~~b,null==c)return k(e(a),b);for(var d=[];b>0;d[--b]=a);return d.join(c)},naturalCmp:function(a,b){if(a==b)return 0;if(!a)return-1;if(!b)return 1;for(var c=/(\.\d+)|(\d+)|(\D+)/g,d=e(a).toLowerCase().match(c),f=e(b).toLowerCase().match(c),g=Math.min(d.length,f.length),h=0;g>h;h++){var i=d[h],j=f[h];if(i!==j){var k=parseInt(i,10);if(!isNaN(k)){var l=parseInt(j,10);if(!isNaN(l)&&k-l)return k-l}return j>i?-1:1}}return d.length===f.length?d.length-f.length:b>a?-1:1},levenshtein:function(a,b){if(null==a&&null==b)return 0;if(null==a)return e(b).length;if(null==b)return e(a).length;a=e(a),b=e(b);for(var c,d,f=[],g=0;g<=b.length;g++)for(var h=0;h<=a.length;h++)d=g&&h?a.charAt(h-1)===b.charAt(g-1)?c:Math.min(f[h],f[h-1],c)+1:g+h,c=f[h],f[h]=d;return f.pop()},toBoolean:function(a,b,c){return"number"==typeof a&&(a=""+a),"string"!=typeof a?!!a:(a=r.trim(a),f(a,b||["true","1"])?!0:f(a,c||["false","0"])?!1:void 0)}};r.strip=r.trim,r.lstrip=r.ltrim,r.rstrip=r.rtrim,r.center=r.lrpad,r.rjust=r.lpad,r.ljust=r.rpad,r.contains=r.include,r.q=r.quote,r.toBool=r.toBoolean,"undefined"!=typeof d&&("undefined"!=typeof c&&c.exports&&(c.exports=r),d._s=r),"function"==typeof a&&a.amd&&a("underscore.string",[],function(){return r}),b._=b._||{},b._.string=b._.str=r}(this,String)},{}],25:[function(a,b){b.exports={name:"scribe",version:"0.11.1",description:"Cross browser rich text editor",contributors:[{name:"Jason Chen",email:"jhchen7@gmail.com"},{name:"Byron Milligan",email:"byronner@gmail.com"},{name:"Keegan Poppen",email:"keegan.poppen@gmail.com"}],dependencies:{"es5-shim":"~2.3.0",eventemitter2:"~0.4.13",lodash:"~2.4.1","rangy-browser":"1.2.3-1","tandem-core":"~0.5.2","underscore.string":"~2.3.3"},devDependencies:{async:"~0.2.10","expect.js":"~0.3.1",grunt:"~0.4.3","grunt-browserify":"~1.3.1",coffeeify:"~0.6.0","grunt-concurrent":"~0.5.0","grunt-contrib-clean":"~0.5.0","grunt-contrib-coffee":"~0.10.1","grunt-contrib-concat":"~0.3.0","grunt-contrib-copy":"~0.5.0","grunt-contrib-jade":"~0.11.0","grunt-contrib-stylus":"~0.13.2","grunt-contrib-uglify":"~0.4.0","grunt-contrib-watch":"~0.5.3","grunt-karma":"~0.8.0","grunt-newer":"~0.6.1","grunt-shell":"~0.6.4",istanbul:"~0.2.6",karma:"~0.12.0","karma-chrome-launcher":"~0.1.2","karma-coverage":"~0.2.0","karma-firefox-launcher":"~0.1.3","karma-html2js-preprocessor":"~0.1.0","karma-mocha":"~0.1.1","karma-phantomjs-launcher":"~0.1.2","karma-safari-launcher":"~0.1.1","karma-sauce-launcher":"~0.2.1","load-grunt-tasks":"~0.4.0",mocha:"~1.17.1",phantomjs:"~1.9.7-1"},engine:{node:">=0.8"},license:{type:"BSD",url:"https://github.com/stypi/scribe/blob/master/LICENSE"},repository:{type:"git",url:"https://github.com/stypi/scribe"},scripts:{test:"grunt test:local"}}},{}],26:[function(a,b){var c,d,e,f,g,h,i,j,k;k=a("lodash"),c=a("linked-list"),d=a("./dom"),f=a("./format-manager"),g=a("./line"),h=a("./normalizer"),i=a("./utils"),j=a("tandem-core"),e=function(){function a(a,b){this.root=a,null==b&&(b={}),this.formatManager=new f(this.root,b),this.normalizer=new h(this.root,this.formatManager),this.root.innerHTML=h.normalizeHtml(this.root.innerHTML),this.lines=new c,this.lineMap={},this.normalizer.normalizeDoc(),k.each(this.root.childNodes,function(a){return function(b){return a.appendLine(b)}}(this))}return a.prototype.appendLine=function(a){return this.insertLineBefore(a,null)},a.prototype.findLeaf=function(a){var b,c;for(c=a.parentNode;null!=c&&!i.isLineNode(c);)c=c.parentNode;return null==c?null:(b=this.findLine(c),b.findLeaf(a))},a.prototype.findLine=function(a){return a=this.findLineNode(a),null!=a?this.lineMap[a.id]:null},a.prototype.findLineAtOffset=function(a){var b;for(b=this.lines.first;null!=b;){if(a<=b.length)return[b,a];a-=b.length+1,b=b.next}return[null,a]},a.prototype.findLineNode=function(a){for(;null!=a&&!i.isLineNode(a);)a=a.parentNode;return a},a.prototype.insertLineBefore=function(a,b){var c;return c=new g(this,a),null!==b?this.lines.insertAfter(b.prev,c):this.lines.append(c),this.lineMap[c.id]=c,c},a.prototype.mergeLines=function(a,b){return null!=a&&null!=b?(k.each(k.clone(b.node.childNodes),function(b){return a.node.appendChild(b)}),d.removeNode(b.node),this.removeLine(b),a.rebuild()):void 0},a.prototype.removeLine=function(a){return delete this.lineMap[a.id],this.lines.remove(a)},a.prototype.splitLine=function(a,b){var c,d,e,f;return f=i.splitNode(a.node,b,!0),c=f[0],d=f[1],a.node=c,this.updateLine(a),e=this.insertLineBefore(d,a.next),e.resetContent(),e},a.prototype.toDelta=function(){var a,b,c,d;return c=this.lines.toArray(),a=c.length>0,d=k.flatten(k.map(c,function(b){return b.length>0&&(a=!1),d=k.clone(b.delta.ops),null!=b.next&&d.push(new j.InsertOp("\n",b.formats)),d}),!0),a&&d.push(new j.InsertOp("\n",this.lines.last.formats)),b=new j.Delta(0,d)},a.prototype.updateLine=function(a){return a.rebuild()},a}(),b.exports=e},{"./dom":27,"./format-manager":29,"./line":34,"./normalizer":40,"./utils":52,"linked-list":"uyMq3L",lodash:"4HJaAd","tandem-core":"38mxji"}],27:[function(a,b){var c,d;d=a("lodash"),c={ELEMENT_NODE:1,NOBREAK_SPACE:"&nbsp;",TEXT_NODE:3,ZERO_WIDTH_NOBREAK_SPACE:"﻿",addClass:function(a,b){return c.hasClass(a,b)?void 0:null!=a.classList?a.classList.add(b):null!=a.className?a.className+=" "+b:void 0},addEventListener:function(a,b,e){var f,g;if(g=b.split(" "),g.length>1)return d.each(g,function(b){return c.addEventListener(a,b,e)});if(f=function(b){var d;return null==b&&(b=c.getWindow(a).event),null==b.target&&(b.target=b.srcElement),null==b.which&&(b.which=b.keyCode),d=e.call(null,b),d===!1&&(null!=b.preventDefault?b.preventDefault():b.returnValue=!1,null!=b.stopPropagation?b.stopPropagation():b.cancelBubble=!0),d},null!=a.addEventListener)return a.addEventListener(b,f);if(null!=a.attachEvent)return a.attachEvent("on"+b,f);throw new Error("No add event support")},getAttributes:function(a){var b,c,d,e,f,g,h;if(null==a.attributes)return{};for(c={},h=a.attributes,d=f=0,g=h.length;g>f;d=++f)e=h[d],b=a.attributes[d],c[b.name]=b.value;return c},getChildIndex:function(a){var b;for(b=0;null!=a.previousSibling;)a=previousSibling,b+=1;return b},getChildNodes:function(a){var b,c;for(c=[],b=a.firstChild;null!=b;)c.push(b),b=b.nextSibling;return c},getClasses:function(a){return a.className.split(/\s+/)},getDefaultOption:function(a){var b,c,d,e,f,g;if(d=a.querySelector("option[selected]"),null!=d)return d;for(g=a.options,b=e=0,f=g.length;f>e;b=++e)if(c=g[b],c.defaultSelected)return c;return null},getText:function(a){switch(a.nodeType){case c.ELEMENT_NODE:return"BR"===a.tagName?"":a.textContent||a.innerText||"";case c.TEXT_NODE:return a.data||"";default:return""}},getWindow:function(a){return a.ownerDocument.defaultView||a.ownerDocument.parentWindow},hasClass:function(a,b){return null!=a.classList?a.classList.contains(b):null!=a.className?d.indexOf(c.getClasses(a),b)>-1:!1},mergeNodes:function(a,b){return null==a?b:null==b?a:(this.moveChildren(a,b),b.parentNode.removeChild(b),a)},moveChildren:function(a,b){return d.each(c.getChildNodes(b),function(b){return a.appendChild(b)})},normalize:function(a){var b,c,d;for(b=a.firstChild,d=[];b;){if(3===b.nodeType)for(;(c=b.nextSibling)&&3===c.nodeType;)b.appendData(c.data),a.removeChild(c);d.push(b=b.nextSibling)}return d},removeAttributes:function(a,b){return null==b&&(b=[]),d.isString(b)&&(b=[b]),d.each(c.getAttributes(a),function(c,e){return d.indexOf(b,e)>-1?void 0:a.removeAttribute(e)})},removeClass:function(a,b){var e;if(c.hasClass(a,b))return null!=a.classList?a.classList.remove(b):null!=a.className?(e=c.getClasses(a),e.splice(d.indexOf(e,b),1),a.className=e.join(" ")):void 0},removeNode:function(a){var b;return null!=(b=a.parentNode)?b.removeChild(a):void 0},resetSelect:function(a){var b;return b=c.getDefaultOption(a),null!=b?(b.selected=!0,c.triggerEvent(a,"change")):a.selectedIndex=null},setText:function(a,b){switch(a.nodeType){case c.ELEMENT_NODE:return null!=a.textContent?a.textContent=b:a.innerText=b;case c.TEXT_NODE:return a.data=b}},switchTag:function(a,b){var c;if(a.tagName!==b)return c=a.ownerDocument.createElement(b),this.moveChildren(c,a),a.parentNode.replaceChild(c,a),a.className&&(c.className=a.className),a.id&&(c.id=a.id),c},toggleClass:function(a,b,d){return null==d&&(d=!c.hasClass(a,b)),d?c.addClass(a,b):c.removeClass(a,b)},triggerEvent:function(a,b,c,d){var e;return a.ownerDocument.createEvent?(e=a.ownerDocument.createEvent("HTMLEvents"),e.initEvent(b,c,d),a.dispatchEvent(e)):a.fireEvent("on"+b,d)},unwrap:function(a){var b,e;return e=a.firstChild,b=a.nextSibling,d.each(c.getChildNodes(a),function(c){return a.parentNode.insertBefore(c,b)}),a.parentNode.removeChild(a),e},wrap:function(a,b){return b.parentNode.insertBefore(a,b),a.appendChild(b),a}},b.exports=c},{lodash:"4HJaAd"}],28:[function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y={}.hasOwnProperty,z=function(a,b){function c(){this.constructor=a}for(var d in b)y.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},A=[].slice;r=a("lodash"),d=a("eventemitter2").EventEmitter2,e=a("./dom"),f=a("./document"),h=a("./keyboard"),i=a("./line"),j=a("./logger"),k=a("./normalizer"),l=a("./paste-manager"),m=a("./renderer"),n=a("./selection"),o=a("./undo-manager"),p=a("./utils"),q=a("tandem-core"),c={silent:!1,source:"api"},s=function(a,b){return 0>=b?void 0:this.selection.preserve(a,-1*b,function(c){return function(){var d,f,g,h,i,j;for(j=c.doc.findLineAtOffset(a),g=j[0],i=j[1],d=g;null!=d&&b>0;)f=Math.min(b,d.length-i),h=d.next,d.length===f?(e.removeNode(d.node),c.doc.removeLine(d)):d.deleteText(i,f),b-=f,d=h,i=0;return null!=g?c.doc.mergeLines(g,g.next):void 0}}(this))},t=function(a,b,c,d){return this.selection.preserve(a,0,function(e){return function(){var f,g,h,j;for(h=e.doc.findLineAtOffset(a),f=h[0],g=h[1],j=[];null!=f&&b>0;)null!=i.FORMATS[c]?b>f.length-g&&f.format(c,d):f.formatText(g,Math.min(b,f.length-g),c,d),b-=f.length-g,g=0,j.push(f=f.next);return j}}(this))},u=function(a,b,c){return null==c&&(c={}),this.selection.preserve(a,b.length,function(d){return function(){var e,f,g,h,i;return b=b.replace(/\r\n/g,"\n"),b=b.replace(/\r/g,"\n"),g=b.split("\n"),i=d.doc.findLineAtOffset(a),e=i[0],h=i[1],null==e&&(f=d.root.ownerDocument.createElement("div"),d.root.appendChild(f),f.appendChild(d.root.ownerDocument.createElement("br")),e=d.doc.appendLine(f),h=0,g.length>1&&""===g[0]&&""===g[1]&&g.shift()),r.each(g,function(a,b){return e.insertText(h,a,c),b<g.length-1?(e=d.doc.splitLine(e,h+a.length),h=0):void 0})}}(this))},v=function(a,b){var c;if(c=this.doc.formatManager.formats[a],null==c)throw new Error("Unsupported format "+a+" "+b);return c.preformat(b)},w=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;l=null!=(o=this.savedRange)?o.start.index:void 0,a(),h=this.doc.toDelta();try{i=null!=(p=this.selection.getRange())?p.start.index:void 0,null!=l&&null!=i&&l<=this.delta.endLength&&i<=h.endLength&&(q=this.delta.split(l),m=q[0],n=q[1],r=h.split(i),j=r[0],k=r[1],e=j.decompose(m),f=k.decompose(n),c=e.merge(f))}catch(s){g=s}return d=h.decompose(this.delta),b=c&&d?c.ops.length<d.ops.length?c:d:c||d},x=function(){var a;return a=w.call(this,function(a){return function(){return a.doSilently(function(){return k.normalizeEmptyLines(a.root),a.selection.preserve(function(){var b,c,d,e;for(k.breakBlocks(a.root),c=a.doc.lines.toArray(),b=a.root.firstChild,r.each(c,function(c){for(var d;c.node!==b;){if(c.node.parentNode!==a.root)return a.doc.removeLine(c);a.doc.normalizer.normalizeLine(b),d=a.doc.insertLineBefore(b,c),b=b.nextSibling}return a.doc.updateLine(c),b=b.nextSibling}),e=[];null!==b;)a.doc.normalizer.normalizeLine(b),d=a.doc.appendLine(b),e.push(b=b.nextSibling);return e})})}}(this)),a.isIdentity()?!1:a},g=function(a){function b(a,c,d){this.iframeContainer=a,this.scribe=c,this.options=null!=d?d:{},r.isString(this.iframeContainer)&&(this.iframeContainer=document.querySelector(this.iframeContainer)),this.logger=new j(this,this.options.logLevel),this.init(),setInterval(this.checkUpdate.bind(this),this.options.pollInterval),this.on(b.events.SELECTION_CHANGE,function(a){return function(b){return a.savedRange=b}}(this)),this.options.readOnly||this.enable()}return z(b,a),b.editors=[],b.events={FOCUS_CHANGE:"focus-change",POST_EVENT:"post-event",PRE_EVENT:"pre-event",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change"},b.prototype.disable=function(){return this.doSilently(function(a){return function(){return a.root.setAttribute("contenteditable",!1)}}(this))},b.prototype.enable=function(){return this.doSilently(function(a){return function(){return a.root.setAttribute("contenteditable",!0)}}(this))},b.prototype.init=function(){return this.ignoreDomChanges=!0,this.renderer=new m(this.iframeContainer,this.options),this.contentWindow=this.renderer.iframe.contentWindow,this.root=this.renderer.root,this.doc=new f(this.root,this.options),this.delta=this.doc.toDelta(),this.keyboard=new h(this),this.selection=new n(this),this.undoManager=new o(this,this.options),this.pasteManager=new l(this),this.ignoreDomChanges=!1},b.prototype.applyDelta=function(a,d){return null==d&&(d={}),d=r.defaults(d,c),a.isIdentity()?void 0:this.doSilently(function(c){return function(){var e,f,g;if(e=c.update(),e&&(c.delta=c.delta.compose(e),g=e,e=e.transform(a,!0),a=a.transform(g,!1)),!a.isIdentity()){if(a.startLength!==c.delta.endLength)throw new Error("Trying to apply delta to incorrect doc length");a.apply(u,s,t,c),f=c.delta,c.delta=f.compose(a),d.silent||c.emit(b.events.TEXT_CHANGE,a,d.source)}return e&&!e.isIdentity()&&c.emit(b.events.TEXT_CHANGE,e,"user"),c.innerHTML=c.root.innerHTML}}(this))},b.prototype.checkUpdate=function(){var a,c;return a=this.update(),a&&(c=this.delta,this.delta=c.compose(a),this.emit(b.events.TEXT_CHANGE,a,"user")),this.selection.update(a!==!1)},b.prototype.doSilently=function(a){var b;return b=this.ignoreDomChanges,this.ignoreDomChanges=!0,a(),this.ignoreDomChanges=b},b.prototype.emit=function(){var a,c,d;return c=arguments[0],a=2<=arguments.length?A.call(arguments,1):[],b.__super__.emit.apply(this,[b.events.PRE_EVENT,c].concat(A.call(a))),r.indexOf(r.values(b.events),c)>-1&&(d=this.logger).info.apply(d,[c].concat(A.call(a))),b.__super__.emit.apply(this,[c].concat(A.call(a))),b.__super__.emit.apply(this,[b.events.POST_EVENT,c].concat(A.call(a)))},b.prototype.insertAt=function(a,b,c,d){var e;return null==d&&(d={}),e=q.Delta.makeInsertDelta(this.delta.endLength,a,b,c),this.applyDelta(e,d)},b.prototype.deleteAt=function(a,b,c){var d;return null==c&&(c={}),d=q.Delta.makeDeleteDelta(this.delta.endLength,a,b),this.applyDelta(d,c)},b.prototype.formatAt=function(a,b,c,d,e){var f;return null==e&&(e={}),b>0?(f={},f[c]=d,this.applyDelta(q.Delta.makeRetainDelta(this.delta.endLength,a,b,f),e)):v.call(this,c,d)},b.prototype.getDelta=function(){return this.delta},b.prototype.getSelection=function(){return this.selection.getRange()},b.prototype.setSelection=function(a,b){return null==b&&(b=!1),this.selection.setRange(a,b)},b.prototype.update=function(){var a;return this.innerHTML!==this.root.innerHTML?(a=x.call(this),this.innerHTML=this.root.innerHTML,a):!1},b}(d),b.exports=g},{"./document":26,"./dom":27,"./keyboard":31,"./line":34,"./logger":35,"./normalizer":40,"./paste-manager":41,"./renderer":44,"./selection":46,"./undo-manager":51,"./utils":52,eventemitter2:"x/3aRz",lodash:"4HJaAd","tandem-core":"38mxji"}],29:[function(a,b){var c,d,e;e=a("lodash"),e.str=a("underscore.string"),c=a("./format"),d=function(){function a(a,b){this.container=a,this.options=null!=b?b:{},this.formats={},e.each(this.options.formats,function(a){return function(b){var d;
return d=e.str.classify(b),a.addFormat(b,new c[d](a.container))}}(this))}return a.prototype.addFormat=function(a,b){return this.formats[a]=b},a.prototype.createFormatContainer=function(a,b){return this.formats[a]?this.formats[a].createContainer(b):this.container.ownerDocument.createElement("SPAN")},a.prototype.getFormat=function(a){var b,c,d,e,f,g;e=[],c=[],g=this.formats;for(d in g)b=g[d],f=b.matchContainer(a),f&&(e.push(d),c.push(f));switch(e.length){case 0:return[];case 1:return[e[0],c[0]];default:return[e,c]}},a}(),b.exports=d},{"./format":30,lodash:"4HJaAd","underscore.string":"Fq7WE+"}],30:[function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u={}.hasOwnProperty,v=function(a,b){function c(){this.constructor=a}for(var d in b)u.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};t=a("lodash"),t.str=a("underscore.string"),g=a("./dom"),s=a("./utils"),l=function(){function a(a,b){this.root=a,this.keyName=b}return a.prototype.clean=function(a){return g.removeAttributes(a),a},a.prototype.createContainer=function(){throw new Error("Descendants should implement")},a.prototype.matchContainer=function(){throw new Error("Descendants should implement")},a.prototype.preformat=function(){throw new Error("Descendants should implement")},a}(),q=function(a){function b(a,c,d){this.root=a,this.keyName=c,this.tagName=d,b.__super__.constructor.apply(this,arguments)}return v(b,a),b.prototype.approximate=function(a){if(!a)throw new Error("Tag format must have truthy value");return!0},b.prototype.clean=function(a){return a=b.__super__.clean.call(this,a),a.tagName!==this.tagName&&(a=g.switchTag(a,this.tagName)),a},b.prototype.createContainer=function(){return this.root.ownerDocument.createElement(this.tagName)},b.prototype.matchContainer=function(a){return a.tagName===this.tagName},b.prototype.preformat=function(a){return this.root.ownerDocument.execCommand(this.keyName,!1,a)},b}(l),n=function(a){function b(a,c){this.root=a,this.keyName=c,b.__super__.constructor.call(this,this.root,this.keyName,"SPAN")}return v(b,a),b.prototype.clean=function(a){return a.tagName!==this.tagName&&(a=g.switchTag(a,this.tagName)),a},b.prototype.approximate=function(){throw new Error("Descendants should implement")},b}(q),e=function(a){function b(a,c){this.root=a,this.keyName=c,b.__super__.constructor.apply(this,arguments)}return v(b,a),b.prototype.approximate=function(a){var b;return b=a.split("-"),b.length>1&&b[0]===this.keyName?b.slice(1).join("-"):!1},b.prototype.clean=function(a){return g.removeAttributes(a,"class"),a},b.prototype.createContainer=function(a){var c;return c=b.__super__.createContainer.call(this,a),g.addClass(c,""+this.keyName+"-"+a),c},b.prototype.matchContainer=function(a){var c,d,e,f,h;if(b.__super__.matchContainer.call(this,a))for(c=g.getClasses(a),f=0,h=c.length;h>f;f++)if(d=c[f],e=this.approximate(d))return e;return!1},b}(n),p=function(a){function b(a,c,d,e,f){this.root=a,this.keyName=c,this.cssName=d,this.defaultStyle=e,this.styles=f,b.__super__.constructor.apply(this,arguments)}return v(b,a),b.getStyleObject=function(a){var b,c;return c=a.getAttribute("style")||"",b=t.reduce(c.split(";"),function(a,b){var c,d,e;return e=b.split(":"),c=e[0],d=e[1],c&&d&&(c=t.str.trim(c),d=t.str.trim(d),a[c.toLowerCase()]=d),a},{})},b.prototype.approximate=function(a){var b,c,d;d=this.styles;for(b in d)if(c=d[b],c.toUpperCase()===a.toUpperCase())return b===this.defaultStyle?!1:b;return!1},b.prototype.clean=function(a){var c,d;return a=b.__super__.clean.call(this,a),g.removeAttributes(a,"style"),d=b.getStyleObject(a),a.removeAttribute("style"),d[this.cssName]&&(c=this.approximate(d[this.cssName]),c&&a.setAttribute("style",""+this.cssName+": "+this.styles[c]+";")),a},b.prototype.createContainer=function(a){var c,d,e;return c=b.__super__.createContainer.call(this,a),d=t.str.camelize(this.cssName),e=this.approximate(a),e&&c.setAttribute("style",""+this.cssName+": "+this.styles[e]+";"),c},b.prototype.matchContainer=function(a){var b,c;return b=null!=(c=a.style)?c[t.str.camelize(this.cssName)]:void 0,b?this.approximate(b):!1},b.prototype.preformat=function(a){return a=this.approximate(a)||this.defaultStyle,this.root.ownerDocument.execCommand(t.str.camelize(this.keyName),!1,this.styles[a])},b}(n),d=function(a){function b(a){this.root=a,b.__super__.constructor.call(this,this.root,"bold","B")}return v(b,a),b.prototype.matchContainer=function(a){var c;return b.__super__.matchContainer.call(this,a)||"bold"===(null!=(c=a.style)?c.fontWeight:void 0)},b}(q),k=function(a){function b(a){this.root=a,b.__super__.constructor.call(this,this.root,"italic","I")}return v(b,a),b.prototype.matchContainer=function(a){var c;return b.__super__.matchContainer.call(this,a)||"italic"===(null!=(c=a.style)?c.fontStyle:void 0)},b}(q),o=function(a){function b(a){this.root=a,b.__super__.constructor.call(this,this.root,"strike","S")}return v(b,a),b.prototype.matchContainer=function(a){var c;return b.__super__.matchContainer.call(this,a)||"line-through"===(null!=(c=a.style)?c.textDecoration:void 0)},b.prototype.preformat=function(a){return this.root.ownerDocument.execCommand("strikeThrough",!1,a)},b}(q),r=function(a){function b(a){this.root=a,b.__super__.constructor.call(this,this.root,"underline","U")}return v(b,a),b.prototype.matchContainer=function(a){var c;return b.__super__.matchContainer.call(this,a)||"underline"===(null!=(c=a.style)?c.textDecoration:void 0)},b}(q),m=function(a){function b(a){this.root=a,b.__super__.constructor.call(this,this.root,"link","A")}return v(b,a),b.prototype.approximate=function(a){return a.match(/^https?:\/\//)||(a="http://"+a),a},b.prototype.clean=function(a){return g.removeAttributes(a,["href","title"]),a},b.prototype.createContainer=function(a){var c;return c=b.__super__.createContainer.call(this,a),c.href=this.approximate(a),c.title=c.href,c},b.prototype.matchContainer=function(a){return b.__super__.matchContainer.call(this,a)?a.getAttribute("href"):!1},b}(q),f=function(a){function b(a,c,d,e,f){this.root=a,this.keyName=c,this.cssName=d,this.defaultStyle=e,this.styles=f,b.__super__.constructor.apply(this,arguments)}return v(b,a),b.COLORS={black:"rgb(0, 0, 0)",red:"rgb(255, 0, 0)",blue:"rgb(0, 0, 255)",lime:"rgb(0, 255, 0)",teal:"rgb(0, 255, 255)",magenta:"rgb(255, 0, 255)",yellow:"rgb(255, 255, 0)",white:"rgb(255, 255, 255)"},b.normalizeColor=function(a){var b;return a=a.replace(/\ /g,""),"#"===a[0]&&4===a.length?t.map(a.slice(1),function(a){return parseInt(a+a,16)}):"#"===a[0]&&7===a.length?[parseInt(a.slice(1,3),16),parseInt(a.slice(3,5),16),parseInt(a.slice(5,7),16)]:0===a.indexOf("rgb")?(b=a.slice(a.indexOf("(")+1,a.indexOf(")")).split(","),t.map(b,function(a){return parseInt(a)})):[0,0,0]},b.prototype.approximate=function(a){var c;return a?null!=this.styles[a]?a:(c=s.findClosestPoint(a,this.styles,b.normalizeColor),c===this.defaultStyle?!1:c):!1},b}(p),c=function(a){function b(a){this.root=a,b.__super__.constructor.call(this,this.root,"back-color","background-color","white",f.COLORS)}return v(b,a),b}(f),h=function(a){function b(a){this.root=a,b.__super__.constructor.call(this,this.root,"font-name","font-family","sans-serif",{"sans-serif":"'Helvetica', 'Arial', sans-serif",serif:"'Times New Roman', serif",monospace:"'Courier New', monospace"})}return v(b,a),b.normalizeFont=function(a){return t.map(a.toUpperCase().split(","),function(a){return t.str.trim(a,"'\" ")})},b.prototype.approximate=function(a){var c,d,e,f;e=b.normalizeFont(a),f=this.styles;for(d in f)if(c=f[d],c=b.normalizeFont(c),t.intersection(c,e).length>0)return d;return!1},b}(p),i=function(a){function b(a){this.root=a,b.__super__.constructor.call(this,this.root,"font-size","font-size","normal",{huge:"32px",large:"18px",normal:"13px",small:"10px"})}return v(b,a),b.SCALE=6.75,b.prototype.approximate=function(a){var c;return null!=this.styles[a]?a:(a=t.isString(a)&&a.indexOf("px")>-1?parseInt(a):parseInt(a)*b.SCALE,c=s.findClosestPoint(a,this.styles,parseInt),c===this.defaultStyle?!1:c)},b.prototype.preformat=function(a){var c;return a=this.approximate(a)||this.defaultStyle,c=Math.round(parseInt(this.styles[a])/b.SCALE),this.root.ownerDocument.execCommand(t.str.camelize(this.keyName),!1,c)},b}(p),j=function(a){function b(a){this.root=a,b.__super__.constructor.call(this,this.root,"fore-color","color","black",f.COLORS)}return v(b,a),b}(f),b.exports={Leaf:l,Tag:q,Span:n,Class:e,Style:p,Bold:d,Italic:k,Link:m,Strike:o,Underline:r,BackColor:c,FontName:h,FontSize:i,ForeColor:j}},{"./dom":27,"./utils":52,lodash:"4HJaAd","underscore.string":"Fq7WE+"}],31:[function(a,b){var c,d,e,f,g,h,i,j,k,l;h=a("lodash"),c=a("./dom"),e=a("./line"),f=a("./position"),g=a("./range"),i=function(){return h.each([d.keys.DELETE,d.keys.BACKSPACE],function(a){return function(b){return a.addHotkey(b,function(){return a.editor.scribe.getLength()>1})}}(this))},j=function(){return this.addHotkey(d.hotkeys.OUTDENT,function(a){return function(b){return l.call(a,b,!0),!1}}(this)),this.addHotkey(d.hotkeys.INDENT,function(a){return function(b){return l.call(a,b,!1),!1}}(this)),h.each(["bold","italic","underline"],function(a){return function(b){return a.addHotkey(d.hotkeys[b.toUpperCase()],function(c){return a.toggleFormat(c,b),!1})}}(this))},k=function(){return c.addEventListener(this.editor.root,"keydown",function(a){return function(b){var c;return null!=a.hotkeys[b.which]&&(c=!1,h.each(a.hotkeys[b.which],function(d){var e;if(!(null!=d.meta&&b.metaKey!==d.meta&&b.ctrlKey!==d.meta||null!=d.shift&&b.shiftKey!==d.shift||(a.editor.selection.update(!0),e=a.editor.getSelection(),null==e)))return c=d.callback.call(null,e)===!1||c})),!c}}(this))},l=function(a,b){var c,d,e,i,j;return null==b&&(b=!1),e=a.getLines(),e.length>1?(d=f.getIndex(e[0].node),j=a.start.index+(b?-1:1),i=0,h.each(e,function(c){return function(f){return b?" "===f.leaves.first.text[0]?(c.editor.deleteAt(d,1,{source:"user"}),i-=1):f===e[0]&&(j=a.start.index):(c.editor.insertAt(d," ",{},{source:"user"}),i+=1),d+=f.length}}(this)),c=a.end.index+i,this.editor.setSelection(new g(this.editor,j,c))):(a.deleteContents({source:"user"}),a.insertContents(0,"  ",{},{source:"user"}),this.editor.setSelection(new g(this.editor,a.start.index+1,a.start.index+1)))},d=function(){function a(a){this.editor=a,this.hotkeys={},k.call(this),j.call(this),i.call(this)}return a.keys={BACKSPACE:8,TAB:9,ENTER:13,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46},a.hotkeys={BOLD:{key:"B",meta:!0},INDENT:{key:a.keys.TAB,shift:!1},ITALIC:{key:"I",meta:!0},OUTDENT:{key:a.keys.TAB,shift:!0},UNDERLINE:{key:"U",meta:!0},UNDO:{key:"Z",meta:!0,shift:!1},REDO:{key:"Z",meta:!0,shift:!0},SELECT_ALL:{key:"A",meta:!0}},a.NAVIGATION=[a.keys.UP,a.keys.DOWN,a.keys.LEFT,a.keys.RIGHT],a.prototype.addHotkey=function(a,b){var c,d;return a=h.isObject(a)?h.clone(a):{key:a},h.isString(a.key)&&(a.key=a.key.toUpperCase().charCodeAt(0)),a.callback=b,null==(c=this.hotkeys)[d=a.key]&&(c[d]=[]),this.hotkeys[a.key].push(a)},a.prototype.indent=function(a,b){var c,d;return d=a.getLines(),c=function(a){return function(c,d){var f,g;return b?(f=h.isNumber(c.formats[d])?c.formats[d]:c.formats[d]?1:0,f+=b,f=Math.min(Math.max(f,e.MIN_INDENT),e.MAX_INDENT)):f=!1,g=Position.getIndex(c.node,0),a.editor.formatAt(g,0,d,f)}}(this),h.each(d,function(){return function(a){return null!=a.formats.bullet?c(a,"bullet"):null!=a.formats.list?c(a,"list"):c(a,"indent")}}(this))},a.prototype.toggleFormat=function(a,b){var c,d;return c=a.getFormats(),d=!c[b],a.format(b,d,{source:"user"})},a}(),b.exports=d},{"./dom":27,"./line":34,"./position":42,"./range":43,lodash:"4HJaAd"}],32:[function(a,b){var c;c=function(){function a(a,b){this.start=a,this.end=b,this.cur=this.start}return a.prototype.next=function(){var a,b;if(b=this.cur,this.cur===this.end||null===this.cur)this.cur=null;else if(null!=this.cur.next)this.cur=this.cur.next;else{for(a=this.cur.line.next;null!=a&&0===a.leaves.length;)a=a.next;this.cur=null!=a?a.leaves.first:null}return b},a.prototype.toArray=function(){var b,c,d;for(b=[],c=new a(this.start,this.end);d=c.next();)b.push(d);return b},a}(),b.exports=c},{}],33:[function(a,b){var c,d,e,f,g,h,i={}.hasOwnProperty,j=function(a,b){function c(){this.constructor=a}for(var d in b)i.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};h=a("lodash"),c=a("linked-list"),d=a("./dom"),f=a("./position"),g=a("./utils"),e=function(a){function b(a,c,e){this.line=a,this.node=c,this.formats=h.clone(e),this.id=h.uniqueId(b.ID_PREFIX),this.text=d.getText(this.node),this.length=this.text.length}return j(b,a),b.ID_PREFIX="leaf-",b.isLeafNode=function(a){return(null!=a?a.nodeType:void 0)!==d.ELEMENT_NODE?!1:"BR"===a.tagName?!0:1===a.childNodes.length&&a.firstChild.nodeType===d.TEXT_NODE?!0:!1},b.isLeafParent=function(a){return(null!=a?a.nodeType:void 0)!==d.ELEMENT_NODE?!1:0===a.childNodes.length?!1:a.childNodes.length>1||a.firstChild.nodeType!==d.TEXT_NODE?!0:!1},b.prototype.getFormats=function(){return h.extend({},this.formats,this.line.formats)},b.prototype.getLineOffset=function(){return f.getIndex(this.node,0,this.line.node)},b.prototype.insertText=function(a,b){var c,e,f,h;return this.text=this.text.substring(0,a)+b+this.text.substring(a),h=g.findDeepestNode(this.node,a),f=h[0],e=h[1],c=d.getText(f),d.setText(f,c.substring(0,e)+b+c.substring(e)),this.length=this.text.length},b}(c.Node),b.exports=e},{"./dom":27,"./position":42,"./utils":52,"linked-list":"uyMq3L",lodash:"4HJaAd"}],34:[function(a,b){var c,d,e,f,g,h,i,j={}.hasOwnProperty,k=function(a,b){function c(){this.constructor=a}for(var d in b)j.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};i=a("lodash"),c=a("linked-list"),d=a("./dom"),e=a("./leaf"),f=a("./line"),g=a("./utils"),h=a("tandem-core"),f=function(a){function b(a,c){this.doc=a,this.node=c,this.id=i.uniqueId(b.ID_PREFIX),this.node.id=this.id,d.addClass(this.node,b.CLASS_NAME),this.rebuild(),b.__super__.constructor.call(this,this.node)}return k(b,a),b.CLASS_NAME="line",b.ID_PREFIX="line-",b.FORMATS=["center","justify","left","right"],b.MAX_INDENT=9,b.MIN_INDENT=1,b.prototype.applyToContents=function(a,b,c){var d,e,f,h,i,j;if(!(0>=b))return i=this.splitContents(a),f=i[0],h=i[1],j=this.splitContents(a+b),d=j[0],e=j[1],g.traverseSiblings(h,d,c)},b.prototype.buildLeaves=function(a,b){return i.each(a.childNodes,function(a){return function(c){var d,f,g,h;return g=i.clone(b),h=a.doc.formatManager.getFormat(c),d=h[0],f=h[1],null!=d&&(g[d]=f),e.isLeafNode(c)&&a.leaves.append(new e(a,c,g)),e.isLeafParent(c)?a.buildLeaves(c,g):void 0}}(this))},b.prototype.deleteText=function(a,b){return b>0?(this.applyToContents(a,b,function(a){return d.removeNode(a)}),this.rebuild()):void 0},b.prototype.findLeaf=function(a){var b;for(b=this.leaves.first;null!=b;){if(b.node===a)return b;b=b.next}return null},b.prototype.findLeafAtOffset=function(a){var b,c,d,e;for(e=this.leaves.toArray(),c=0,d=e.length;d>c;c++){if(b=e[c],a<=b.length)return[b,a];a-=b.length}return[b,a]},b.prototype.format=function(){throw new Error("Unimplemented")},b.prototype.formatText=function(a,b,c,d){for(var e,f,h,j;b>0&&(h=i.first(this.delta.getOpsAt(a,1)),!(d&&h.attributes[c]!==d||!d&&null!=h.attributes[c]));)a+=1,b-=1;for(;b>0&&(h=i.first(this.delta.getOpsAt(a+b-1,1)),!(d&&h.attributes[c]!==d||!d&&null!=h.attributes[c]));)b-=1;if(b>0){if(e=this.doc.formatManager.formats[c],null==e)throw new Error("Unrecognized format "+c);return d?(j=null,f=this.doc.formatManager.createFormatContainer(c,d),this.applyToContents(a,b,function(){return function(a){return j=a.nextSibling,f.appendChild(a),g.removeFormatFromSubtree(a,e)}}(this)),this.node.insertBefore(f,j)):this.applyToContents(a,b,function(){return function(a){return g.removeFormatFromSubtree(a,e)}}(this)),this.rebuild()}},b.prototype.insertText=function(a,b,c){var e,f,g,h,j,k,l,m;return null==c&&(c={}),(null!=b?b.length:void 0)>0?(l=this.findLeafAtOffset(a),e=l[0],f=l[1],i.isEqual(e.formats,c)&&this.length>1&&a>0?(e.insertText(f,b),this.resetContent()):(k=this.node.ownerDocument.createElement("span"),d.setText(k,b),0===a?this.node.insertBefore(k,this.node.firstChild):(m=this.splitContents(a),j=m[0],g=m[1],h=(null!=j?j.parentNode:void 0)||(null!=g?g.parentNode:void 0),h.insertBefore(k,g)),this.rebuild(),i.each(c,function(c){return function(d,e){return c.formatText(a,b.length,e,d)}}(this)))):void 0},b.prototype.rebuild=function(a){var b;if(null==a&&(a=!1),this.node.parentNode===this.doc.root){if(!a&&null!=this.outerHTML&&this.outerHTML===this.node.outerHTML)return!1;for(;(null!=(b=this.leaves)?b.length:void 0)>0;)this.leaves.remove(this.leaves.first);this.leaves=new c,this.doc.normalizer.normalizeLine(this.node),this.buildLeaves(this.node,{}),this.resetContent()}else this.doc.removeLine(this);return!0},b.prototype.resetContent=function(){var a,b,c,d;return this.length=i.reduce(this.leaves.toArray(),function(a,b){return b.length+a},0),this.outerHTML=this.node.outerHTML,this.formats={},d=this.doc.formatManager.getFormat(this.node),a=d[0],b=d[1],null!=a&&(this.formats[a]=b),c=i.map(this.leaves.toArray(),function(a){return new h.InsertOp(a.text,a.getFormats(!0))}),this.delta=new h.Delta(0,this.length,c)},b.prototype.splitContents=function(a){var b,c;return c=g.getChildAtOffset(this.node,a),b=c[0],a=c[1],g.splitNode(b,a)},b}(c.Node),b.exports=f},{"./dom":27,"./leaf":33,"./line":34,"./utils":52,"linked-list":"uyMq3L",lodash:"4HJaAd","tandem-core":"38mxji"}],35:[function(a,b){var c,d,e=[].slice;d=a("lodash"),c=function(){function a(a,b){switch(this.editor=a,this.logLevel=b,this.logLevel){case"debug":this.logLevel=3;break;case"info":this.logLevel=2;break;case"warn":this.logLevel=1;break;case"error":this.logLevel=0;break;case!1:this.logLevel=-1}}return a}(),d.each(["error","warn","info","debug"],function(a,b){return c.prototype[a]=function(){var c,d;if(c=1<=arguments.length?e.call(arguments,0):[],"undefined"!=typeof console&&null!==console&&this.logLevel>=b){if(d="debug"===a?"log":a,this.editor.scribe.constructor.editors.length>1&&c.unshift(this.editor.options.id),null!=console[d].apply)return console[d].apply(console,c);switch(c.length){case 1:return console[d](c[0]);case 2:return console[d](c[0],c[1]);case 3:return console[d](c[0],c[1],c[2]);case 4:return console[d](c[0],c[1],c[2],c[3]);case 5:return console[d](c[0],c[1],c[2],c[3],c[4]);default:return console[d](c[0],c[1],c[2],c[3],c[4],c.slice(5))}}}}),b.exports=c},{lodash:"4HJaAd"}],36:[function(a,b){var c,d,e,f,g;g=a("lodash"),d=a("../dom"),e=a("../format"),f=a("tandem-core"),c=function(){function a(b,c){this.editor=b,this.options=g.defaults(c,a.DEFAULTS),null!=this.options.button&&this.attachButton(this.options.button),this.options.enabled&&this.enable(),this.editor.doc.formatManager.addFormat("author",new e.Class(this.editor.renderer.root,"author")),null!=this.options.authorId&&(this.editor.on(this.editor.constructor.events.PRE_EVENT,function(a){return function(b,c,d){var e,h;return b===a.editor.constructor.events.TEXT_CHANGE&&"user"===d?(g.each(c.ops,function(b){return f.InsertOp.isInsert(b)||g.keys(b.attributes).length>0?b.attributes.author=a.options.authorId:void 0}),h=new f.Delta(c.endLength,[new f.RetainOp(0,c.endLength)]),e={},e.author=a.options.authorId,c.apply(function(a,b){return g.each(b.split("\n"),function(b){return h=h.compose(f.Delta.makeRetainDelta(c.endLength,a,b.length,e)),a+=b.length+1})},function(){},function(a,b){return h=h.compose(f.Delta.makeRetainDelta(c.endLength,a,b,e))}),a.editor.applyDelta(h,{silent:!0})):void 0}}(this)),this.addAuthor(this.options.authorId,this.options.color))}return a.prototype.DEFAULTS={authorId:null,color:"blue",enabled:!1},a.prototype.addAuthor=function(a,b){var c;return c={},c[".authorship .author-"+a]={"background-color":""+b},this.editor.renderer.addStyles(c)},a.prototype.attachButton=function(a){return d.addEventListener(a,"click",function(b){return function(){return d.toggleClass(a,"sc-on"),b.enable(d.hasClass(a,"sc-on"))}}(this))},a.prototype.enable=function(a){return null==a&&(a=!0),d.toggleClass(this.editor.root,"authorship",a)},a.prototype.disable=function(){return this.enable(!1)},a}(),b.exports=c},{"../dom":27,"../format":30,lodash:"4HJaAd","tandem-core":"38mxji"}],37:[function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p;p=a("lodash"),c=a("../dom"),d=a("../keyboard"),f=a("../position"),g=a("../range"),h=function(a){return a=n(a),c.addClass(this.tooltip,"editing"),this.tooltipInput.focus(),this.tooltipInput.value=a},i=function(){var a;return(null!=this.savedLink||c.getText(this.tooltipLink)!==this.tooltipInput.value)&&(a=n(this.tooltipInput.value),this.tooltipLink.href=a,c.setText(this.tooltipLink,a),null!=this.savedLink?(this.savedLink.href=a,this.savedLink=null):j.call(this,this.tooltipInput.value)),c.removeClass(this.tooltip,"editing")},j=function(a){return this.editor.setSelection(this.savedRange,!0),this.savedRange.format("link",a,{source:"user"})},k=function(){return this.tooltip.style.left="-10000px"},l=function(){return c.addEventListener(this.editor.root,"mouseup",function(a){return function(b){var d,e;for(d=b.target;null!=d&&"DIV"!==d.tagName&&"BODY"!==d.tagName;){if("A"===d.tagName)return e=n(d.href),a.tooltipLink.href=e,c.setText(a.tooltipLink,e),c.removeClass(a.tooltip,"editing"),o.call(a,d.getBoundingClientRect()),void(a.savedLink=d);d=d.parentNode}return k.call(a)}}(this)),c.addEventListener(this.options.button,"click",function(a){return function(){var b;return a.savedRange=a.editor.getSelection(),null==a.savedRange||a.savedRange.isCollapsed()?void 0:c.hasClass(a.options.button,"active")?(j.call(a,!1),k.call(a)):(b=n(a.savedRange.getText()),/\w+\.\w+/.test(b)?(a.editor.root.focus(),j.call(a,b)):(c.addClass(a.tooltip,"editing"),o.call(a,a.editor.selection.getDimensions()),h.call(a,b)))}}(this)),c.addEventListener(this.tooltipChange,"click",function(a){return function(){return h.call(a,c.getText(a.tooltipLink))}}(this)),c.addEventListener(this.tooltipDone,"click",function(a){return function(){return i.call(a)}}(this)),c.addEventListener(this.tooltipInput,"keyup",function(a){return function(b){return b.which===d.keys.ENTER?i.call(a):void 0}}(this))},m=function(){return this.tooltip=this.options.button.ownerDocument.createElement("div"),c.addClass(this.tooltip,"link-tooltip-container"),this.tooltip.innerHTML='<span class="title">Visit URL:</span> <a href="#" class="url" target="_blank" href="about:blank"></a> <input class="input" type="text"> <span>&#45;</span> <a href="javascript:;" class="change">Change</a> <a href="javascript:;" class="done">Done</a>',this.tooltipLink=this.tooltip.querySelector(".url"),this.tooltipInput=this.tooltip.querySelector(".input"),this.tooltipChange=this.tooltip.querySelector(".change"),this.tooltipDone=this.tooltip.querySelector(".done"),this.editor.renderer.addStyles({".link-tooltip-container":{"background-color":"#fff",border:"1px solid #000",height:"23px",padding:"5px 10px",position:"absolute","white-space":"nowrap"},".link-tooltip-container a":{cursor:"pointer","text-decoration":"none"},".link-tooltip-container > a, .link-tooltip-container > span":{display:"inline-block","line-height":"23px"},".link-tooltip-container .input":{display:"none",width:"170px"},".link-tooltip-container .done":{display:"none"},".link-tooltip-container.editing .input":{display:"inline-block"},".link-tooltip-container.editing .done":{display:"inline-block"},".link-tooltip-container.editing .url":{display:"none"},".link-tooltip-container.editing .change":{display:"none"}}),k.call(this),p.defer(this.editor.renderer.addContainer.bind(this.editor.renderer,this.tooltip))},n=function(a){return/^https?:\/\//.test(a)||(a="http://"+a),"/"===a.slice(a.length-1)&&(a=a.slice(0,a.length-1)),a},o=function(a,b){var c,d,e,f,g,h;return null==b&&(b=5),e=this.tooltip.getBoundingClientRect(),f=e.bottom-e.top,g=e.right-e.left,d=this.editor.root.getBoundingClientRect(),c=Math.max(d.left,a.left+(a.right-a.left)/2-g/2),c+g>d.right&&d.right-g>d.left&&(c=d.right-g),h=a.bottom+b,h+f>d.bottom&&a.top-f-b>d.top&&(h=a.top-f-b),this.tooltip.style.left=c+"px",this.tooltip.style.top=h+(this.tooltip.offsetTop-e.top)+"px"},e=function(){function a(b,c){this.editor=b,null==c&&(c={}),this.options=p.defaults(c,a.DEFAULTS),m.call(this),l.call(this)}return a.DEFAULTS={button:null},a}(),b.exports=e},{"../dom":27,"../keyboard":31,"../position":42,"../range":43,lodash:"4HJaAd"}],38:[function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n={}.hasOwnProperty,o=function(a,b){function c(){this.constructor=a}for(var d in b)n.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};i=a("lodash"),c=a("eventemitter2").EventEmitter2,d=a("../dom"),f=a("../position"),g=a("../renderer"),h=a("../utils"),j=function(a){return a.apply(function(a){return function(b,c,d){return a.shiftCursors(b,c.length,d.author,!1)}}(this),function(a){return function(b,c){return a.shiftCursors(b,-1*c,null,!1)}}(this),function(a){return function(b){return a.shiftCursors(b,0,null,!1)}}(this)),this.update()},k=function(a,b){var c,e,f,g;return c=this.container.ownerDocument.createElement("span"),d.addClass(c,"cursor"),c.innerHTML=this.options.template,f=c.querySelector(".cursor-flag"),g=c.querySelector(".cursor-name"),d.setText(g,a),e=c.querySelector(".cursor-caret"),e.style.backgroundColor=g.style.backgroundColor=b,this.container.appendChild(c),c},l=function(a,b){var c;return a.elem.style.top=b.offsetTop+"px",a.elem.style.left=b.offsetLeft+"px",a.elem.style.height=b.offsetHeight+"px",c=a.elem.querySelector(".cursor-flag"),d.toggleClass(a.elem,"top",parseInt(a.elem.style.top)<=c.offsetHeight),d.toggleClass(a.elem,"left",parseInt(a.elem.style.left)<=c.offsetWidth),d.toggleClass(a.elem,"right",this.editor.root.offsetWidth-parseInt(a.elem.style.left)<=c.offsetWidth),this.emit(e.events.CURSOR_MOVED,a)},m=function(a){return this.editor.doSilently(function(b){return function(){var c,e,g,i,j,k;return i=new f(b.editor,a.index),e=b.container.ownerDocument.createElement("span"),null==i.leafNode.firstChild?(d.setText(e,d.NOBREAK_SPACE),i.leafNode.parentNode.insertBefore(e,i.leafNode),l.call(b,a,e)):(d.setText(e,d.ZERO_WIDTH_NOBREAK_SPACE),k=h.splitNode(i.leafNode.firstChild,i.offset),g=k[0],j=k[1],c=k[2],null!=j?(j.parentNode.insertBefore(e,j),l.call(b,a,e)):null!=g&&(g.parentNode.appendChild(e),l.call(b,a,e))),e.parentNode.removeChild(e),c?d.normalize(i.leafNode):void 0}}(this)),a.dirty=!1},e=function(a){function b(a,c){this.editor=a,null==c&&(c={}),this.options=i.defaults(c,b.DEFAULTS),this.cursors={},this.container=this.editor.root.ownerDocument.createElement("div"),this.container.id="cursor-container",this.editor.renderer.addContainer(this.container,!0),this.editor.renderer.addStyles({"#cursor-container":{position:"absolute","z-index":"1000"},".cursor":{"margin-left":"-1px",position:"absolute"},".cursor-flag":{bottom:"100%",position:"absolute","white-space":"nowrap"},".cursor-name":{display:"inline-block",color:"white",padding:"2px 8px"},".cursor-caret":{height:"100%",position:"absolute",width:"2px"},".cursor.hidden .cursor-flag":{display:"none"},".cursor.top > .cursor-flag":{bottom:"auto",top:"100%"},".cursor.right > .cursor-flag":{right:"-2px"}}),this.editor.renderer.on(g.events.UPDATE,function(a){return function(){return i.defer(function(){return a.container.style.top=a.editor.root.offsetTop+"px",a.container.style.left=a.editor.root.offsetLeft+"px",a.update(!0)})}}(this)),this.editor.on(this.editor.constructor.events.TEXT_CHANGE,function(a){return function(b){return j.call(a,b)}}(this))}return o(b,a),b.DEFAULTS={template:'<span class="cursor-flag"> <span class="cursor-name"></span> </span> <span class="cursor-caret"></span>',timeout:2500},b.events={CURSOR_ADDED:"cursor-addded",CURSOR_MOVED:"cursor-moved",CURSOR_REMOVED:"cursor-removed"},b.prototype.clearCursors=function(){return i.each(i.keys(this.cursors),function(a){return function(b){return a.removeCursor(b)}}(this)),this.cursors={}},b.prototype.moveCursor=function(a,b,c){var e;return null==c&&(c=!0),e=this.cursors[a],e.index=b,e.dirty=!0,d.removeClass(e.elem,"hidden"),clearTimeout(e.timer),e.timer=setTimeout(function(){return function(){return d.addClass(e.elem,"hidden"),e.timer=null}}(this),this.options.timeout),c&&m.call(this,e),e},b.prototype.removeCursor=function(a){var c;return c=this.cursors[a],this.emit(b.events.CURSOR_REMOVED,c),c.elem.parentNode.removeChild(c.elem)in(null!=c),delete this.cursors[a]},b.prototype.setCursor=function(a,c,d,e,f){var g;return null==f&&(f=!0),null==this.cursors[a]&&(this.cursors[a]=g={userId:a,index:c,color:e,elem:k.call(this,d,e)},this.emit(b.events.CURSOR_ADDED,g)),this.moveCursor(a,c,f)},b.prototype.shiftCursors=function(a,b,c,d){return null==c&&(c=null),null==d&&(d=!0),i.each(this.cursors,function(){return function(d){return d&&(d.index>a||d.userId===c)?(d.index+=Math.max(b,a-d.index),d.dirty=!0):void 0}}(this)),d?this.update():void 0},b.prototype.update=function(a){return null==a&&(a=!1),i.each(this.cursors,function(b){return function(c){return null!=c&&(c.dirty||a)?m.call(b,c):void 0}}(this))},b}(c),b.exports=e},{"../dom":27,"../position":42,"../renderer":44,"../utils":52,eventemitter2:"x/3aRz",lodash:"4HJaAd"}],39:[function(a,b){var c,d,e,f,g,h,i,j,k;i=a("lodash"),c=a("../dom"),d=a("../keyboard"),f=a("../range"),e=a("./link-tooltip"),h=a("../utils"),j=function(a){var b,c;return c=".sc-"+a,i.indexOf(g.formats.SELECT,a)>-1&&(c="select"+c),b=this.container.querySelector(c)},k=function(){return i.each(g.formats,function(a){return function(b,d){return i.each(b,function(b){var e,f;return f=j.call(a,b),null!=f?(a.editor.logger.debug("Toolbar binding",b,f),"link"===b?a.editor.scribe.addModule("link-tooltip",{button:f}):(e="SELECT"===d?"change":"click",c.addEventListener(f,e,function(){var d,g,i;if(!a.triggering)return a.editor.logger.debug("Toolbar event",e,b,f),i="SELECT"===f.tagName?f.options[f.selectedIndex].value:!c.hasClass(f,"sc-active"),g=a.editor.getSelection(),null!=g&&(h.isIE(8)&&(a.editor.root.focus(),a.editor.setSelection(g)),g.format(b,i,{source:"user"})),d={},d[b]=i,a.updateActive(d),!1}),c.addEventListener(f,"mousedown",function(){return a.editor.checkUpdate(),!0}))):void 0})}}(this)),i.each(["BOLD","ITALIC","UNDERLINE"],function(a){return function(b){return a.editor.keyboard.addHotkey(d.hotkeys[b],function(){var d,e;return d={},e=j.call(a,b.toLowerCase()),null!=e&&(d[b.toLowerCase()]=!c.hasClass(e,"sc-active")),a.updateActive(d)})}}(this))},g=function(){function a(b,d){this.editor=b,null==d&&(d={}),this.options=i.defaults(d,a.DEFAULTS),this.container=i.isString(this.options.container)?document.querySelector(this.options.container):this.options.container,k.call(this),this.editor.on(this.editor.constructor.events.POST_EVENT,function(a){return function(b){return b===a.editor.constructor.events.TEXT_CHANGE||b===a.editor.constructor.events.SELECTION_CHANGE?a.updateActive():void 0}}(this)),i.defer(c.addClass.bind(this,this.container,"sc-toolbar-container"))}return a.DEFAULTS={container:null},a.formats={BUTTON:["bold","italic","strike","underline","link","indent","outdent"],SELECT:["back-color","fore-color","font-name","font-size"]},a.prototype.updateActive=function(a){var b;return null==a&&(a={}),this.triggering=!0,b=this.editor.getSelection(),i.each(this.container.querySelectorAll("select"),c.resetSelect.bind(this)),i.each(this.container.querySelectorAll(".sc-active"),function(){return function(a){return c.removeClass(a,"sc-active")}}(this)),null!=b&&i.each(i.extend(b.getFormats(),a),function(a){return function(b,d){var e;if(b){if(e=j.call(a,d),null==e)return;return"SELECT"===e.tagName?(i.isArray(b)&&(b=""),e.value=b,c.triggerEvent(e,"change")):c.addClass(e,"sc-active")}}}(this)),this.triggering=!1},a}(),b.exports=g},{"../dom":27,"../keyboard":31,"../range":43,"../utils":52,"./link-tooltip":37,lodash:"4HJaAd"}],40:[function(a,b){var c,d,e,f;f=a("lodash"),c=a("./dom"),e=a("./utils"),d=function(){function a(a,b){this.container=a,this.formatManager=b
}return a.TAG_RULES={A:{},ADDRESSS:{rename:"div"},B:{},BLOCKQUOTE:{rename:"div"},BR:{},BIG:{rename:"span"},CENTER:{rename:"span"},DD:{rename:"div"},DEL:{rename:"s"},DIV:{},DL:{rename:"div"},EM:{rename:"i"},FONT:function(a,b){var d;return d=c.unwrap(b),f.each({color:"fore-color",face:"font-name",size:"font-size"},function(e,f){var g;return b.hasAttribute(f)?(g=a.createFormatContainer(e,b.getAttribute(f)),d=c.wrap(g,d)):void 0}),d},H1:{rename:"div"},H2:{rename:"div"},H3:{rename:"div"},H4:{rename:"div"},H5:{rename:"div"},H6:{rename:"div"},HR:{rename:"br"},I:{},INS:{rename:"span"},LI:{rename:"div"},OL:{rename:"div"},P:{rename:"div"},PRE:{rename:"div"},S:{},SMALL:{rename:"span"},SPAN:{},STRIKE:{rename:"s"},STRONG:{rename:"b"},TABLE:{rename:"div"},TBODY:{rename:"div"},TD:{rename:"span"},TFOOT:{rename:"div"},TH:{rename:"span"},THEAD:{rename:"div"},TR:{rename:"div"},U:{},UL:{rename:"div"}},a.breakBlocks=function(b){return a.groupBlocks(b),f.each(f.clone(b.querySelectorAll("br")),a.normalizeBreak.bind("this",b)),f.each(b.childNodes,a.breakLine.bind(this))},a.breakLine=function(b){return 1!==b.childNodes.length||"BR"!==b.firstChild.tagName?e.traversePostorder(b,function(){return function(d){var f;if(e.isBlock(d)){if("DIV"!==d.tagName&&(d=c.switchTag(d,"div")),null!=d.nextSibling){for(f=b.ownerDocument.createElement("div"),b.parentNode.insertBefore(f,b.nextSibling);null!=d.nextSibling;)f.appendChild(d.nextSibling);a.breakLine(f)}return c.unwrap(d)}return d}}(this)):void 0},a.groupBlocks=function(a){var b,c,d,f;for(b=a.firstChild,f=[];null!=b;)if(e.isBlock(b))f.push(b=b.nextSibling);else{for(c=a.ownerDocument.createElement("div"),a.insertBefore(c,b);null!=b&&!e.isBlock(b);)d=b.nextSibling,c.appendChild(b),b=d;f.push(b=c)}return f},a.normalizeBreak=function(b,d){if(d!==b){if(null!=d.previousSibling)return null!=d.nextSibling&&e.splitBefore(d,b),d.parentNode.removeChild(d);if(null!=d.nextSibling){if(e.splitBefore(d.nextSibling,b))return a.normalizeBreak(b,d)}else if(d.parentNode!==b&&d.parentNode.parentNode!==b)return c.unwrap(d.parentNode),a.normalizeBreak(b,d)}},a.normalizeEmptyLines=function(a){return e.isIE()?f.each(a.querySelectorAll("br"),function(a){return null!=a.previousSibling||null!=a.nextSibling?c.removeNode(a):void 0}):void 0},a.normalizeHtml=function(a){return a=a.replace(/^\s\s*/,"").replace(/\s\s*$/,""),a=a.replace(/\>\s+\</g,"><"),a=a.replace(/<br><\/br>/,"<br/>")},a.requireLeaf=function(a){return 0===a.childNodes.length?a.appendChild(a.ownerDocument.createElement("br")):void 0},a.wrapText=function(a){return e.traversePreorder(a,0,function(){return function(b){var d;return c.normalize(b),b.nodeType!==c.TEXT_NODE||null==b.nextSibling&&null==b.previousSibling&&b.parentNode!==a&&"LI"!==b.parentNode.tagName||(d=b.ownerDocument.createElement("span"),c.wrap(d,b),b=d),b}}(this))},a.prototype.applyRules=function(b){return e.traversePreorder(b,0,function(b){return function(d){var e;return d.nodeType===c.ELEMENT_NODE&&(e=a.TAG_RULES[d.tagName],null!=e?f.isFunction(e)?d=e.call(null,b.formatManager,d):f.isObject(e)&&f.each(e,function(a,b){switch(b){case"rename":return d=c.switchTag(d,a)}}):d=c.unwrap(d)),d}}(this))},a.prototype.normalizeDoc=function(){return this.applyRules(this.container),a.breakBlocks(this.container),f.each(this.container.childNodes,function(a){return function(b){return a.normalizeLine(b)}}(this))},a.prototype.normalizeLine=function(b){return 1!==b.childNodes.length||"BR"!==b.firstChild.tagName?(this.applyRules(b),this.normalizeTags(b),this.removeRedundant(b),a.requireLeaf(b),a.wrapText(b)):void 0},a.prototype.normalizeTags=function(a){return e.traversePreorder(a,0,function(a){return function(b){var d,e,g,h;return d=b,h=a.formatManager.getFormat(b),e=h[0],g=h[1],f.isArray(e)&&(f.each(e.slice(1),function(e,f){var h;return null!=a.formatManager.formats[e]?(h=a.formatManager.formats[e].createContainer(g[f+1]),d=c.wrap(h,b)):void 0}),e=e[0],g=g[0]),null!=a.formatManager.formats[e]?a.formatManager.formats[e].clean(b):c.removeAttributes(b),d}}(this))},a.prototype.removeRedundant=function(a){var b,d;return d=[a],b=[{}],e.traversePreorder(a,0,function(g){return function(h){var i,j,k,l,m,n;return n=g.formatManager.getFormat(h),i=n[0],j=n[1],l=b[f.indexOf(d,h.parentNode)],m=function(b){return b.nodeType!==c.ELEMENT_NODE?!1:0===e.getNodeLength(b)?"BR"!==b.tagName||b.parentNode.childNodes.length>1:null!=i?null!=l[i]:"SPAN"!==b.tagName?!1:0!==b.childNodes.length&&f.any(b.childNodes,function(a){return a.nodeType!==c.ELEMENT_NODE})?null===b.previousSibling&&null===b.nextSibling&&b.parentNode!==a&&"LI"!==b.parentNode.tagName?!0:!1:!0}(h),m&&(h=c.unwrap(h)),null!=h&&(d.push(h),null!=i?(k=f.clone(l),k[i]=j,b.push(k)):b.push(l)),h}}(this))},a}(),b.exports=d},{"./dom":27,"./utils":52,lodash:"4HJaAd"}],41:[function(a,b){var c,d,e,f,g,h;h=a("lodash"),c=a("./dom"),d=a("./document"),f=a("./range"),g=a("tandem-core"),e=function(){function a(a){this.editor=a,this.container=this.editor.root.ownerDocument.createElement("div"),c.addClass(this.container,"paste-container"),this.container.setAttribute("contenteditable",!0),this.editor.renderer.addStyles({".paste-container":{left:"-10000px",position:"absolute",top:"50%"}}),this.editor.renderer.addContainer(this.container),this.initListeners()}return a.prototype.initListeners=function(){return c.addEventListener(this.editor.root,"paste",function(a){return function(){var b,c;return b=a.editor.scribe.getLength(),c=a.editor.getSelection(),null!=c?(a.container.innerHTML="",a.container.focus(),h.defer(function(){var e,h,i;return h=new d(a.container,a.editor.options),e=h.toDelta(),e=e.compose(g.Delta.makeDeleteDelta(e.endLength,e.endLength-1,1)),i=e.endLength,c.start.index>0&&e.ops.unshift(new g.RetainOp(0,c.start.index)),c.end.index<b&&e.ops.push(new g.RetainOp(c.end.index,b)),e.endLength+=a.editor.scribe.getLength()-(c.end.index-c.start.index),e.startLength=b,a.editor.applyDelta(e,{source:"user"}),a.editor.root.focus(),a.editor.setSelection(new f(a.editor,c.start.index+i,c.start.index+i))})):void 0}}(this))},a}(),b.exports=e},{"./document":26,"./dom":27,"./range":43,lodash:"4HJaAd","tandem-core":"38mxji"}],42:[function(a,b){var c,d,e,f;f=a("lodash"),c=a("./dom"),e=a("./utils"),d=function(){function a(b,c,d){var e;this.editor=b,this.leafNode=c,this.offset=d,f.isNumber(this.leafNode)?(this.offset=this.index=this.leafNode,this.leafNode=this.editor.root):this.index=a.getIndex(this.leafNode,this.offset),e=a.findLeafNode(this.editor,this.leafNode,this.offset),this.leafNode=e[0],this.offset=e[1]}return a.findLeafNode=function(b,d,f){var g;return g=e.findDeepestNode(d,f),d=g[0],f=g[1],d.nodeType===c.TEXT_NODE&&(f=a.getIndex(d,f,d.parentNode),d=d.parentNode),[d,f]},a.getIndex=function(a,b,d){for(null==b&&(b=0),null==d&&(d=null);a!==d&&null!=a.ownerDocument&&!c.hasClass(a,"editor-container");){for(;null!=a.previousSibling;)a=a.previousSibling,b+=e.getNodeLength(a);a=a.parentNode}return b},a.prototype.getLeaf=function(){return null!=this.leaf?this.leaf:(this.leaf=this.editor.doc.findLeaf(this.leafNode),this.leaf)},a.prototype.getIndex=function(){return a.getIndex(this.leafNode,this.offset,this.editor.root)},a}(),b.exports=d},{"./dom":27,"./utils":52,lodash:"4HJaAd"}],43:[function(a,b){var c,d,e,f;f=a("lodash"),c=a("./leaf-iterator"),d=a("./position"),e=function(){function a(a,b,c){this.editor=a,this.start=b,this.end=c,f.isNumber(this.start)&&(this.start=new d(this.editor,this.start)),f.isNumber(this.end)&&(this.end=new d(this.editor,this.end))}return a.prototype.deleteContents=function(a){return this.isCollapsed()?void 0:this.editor.deleteAt(this.start.index,this.end.index-this.start.index,a)},a.prototype.equals=function(a){return null==a?!1:a.start.leafNode===this.start.leafNode&&a.end.leafNode===this.end.leafNode&&a.start.offset===this.start.offset&&a.end.offset===this.end.offset},a.prototype.format=function(a,b,c){return this.editor.formatAt(this.start.index,this.end.index-this.start.index,a,b,c)},a.prototype.getFormats=function(){var a,b,c,d;return d=this.start.getLeaf(),a=this.end.getLeaf(),null==d||null==a?{}:this.isCollapsed()?d.getFormats():(c=this.getLeaves(),c.length>1&&0===this.end.offset&&c.pop(),c.length>1&&this.start.offset===c[0].length&&c.splice(0,1),b=c.length>0?c[0].getFormats():{},f.all(c.slice(1),function(a){var c;return""===a.text?!0:(c=a.getFormats(),f.each(b,function(a,d){return c[d]?c[d]!==a?(f.isArray(a)||(b[d]=[a]),b[d].push(c[d])):void 0:delete b[d]}),f.keys(b).length>0)}),f.each(b,function(a,c){return f.isArray(a)?b[c]=f.uniq(a):void 0}),b)},a.prototype.getLeafNodes=function(){var a,b;return this.isCollapsed()?[this.start.leafNode]:(a=new c(this.start.getLeaf(),this.end.getLeaf()),b=f.pluck(a.toArray(),"node"),(b[b.length-1]!==this.end.leafNode||0===this.end.offset)&&b.pop(),b)},a.prototype.getLeaves=function(){var a,b;return b=new c(this.start.getLeaf(),this.end.getLeaf()),a=b.toArray()},a.prototype.getLineNodes=function(){var a,b,c;if(c=this.editor.doc.findLineNode(this.start.leafNode),a=this.editor.doc.findLineNode(this.end.leafNode),c===a)return[c];for(b=[];c!==a;)b.push(c),c=c.nextSibling;return b.push(a),b},a.prototype.getLines=function(){return f.map(this.getLineNodes(),function(a){return function(b){return a.editor.doc.findLine(b)}}(this))},a.prototype.getText=function(){var a,b;return a=this.getLeaves(),0===a.length?"":(b=a[0].line,f.map(a,function(a){return function(c){var d;return d=c.text,c===a.end.getLeaf()&&(d=d.substring(0,a.end.offset)),c===a.start.getLeaf()&&(d=d.substring(a.start.offset)),b!==c.line&&(d="\n"+d,b=c.line),d}}(this)).join(""))},a.prototype.insertContents=function(a,b,c,d){return this.editor.insertAt(this.start.index+a,b,c,d)},a.prototype.isCollapsed=function(){return this.start.leafNode===this.end.leafNode&&this.start.offset===this.end.offset},a}(),b.exports=e},{"./leaf-iterator":32,"./position":42,lodash:"4HJaAd"}],44:[function(a,b){var c,d,e,f,g,h,i,j,k={}.hasOwnProperty,l=function(a,b){function c(){this.constructor=a}for(var d in b)k.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};j=a("lodash"),d=a("eventemitter2").EventEmitter2,f=a("./dom"),i=a("./utils"),g=a("./normalizer"),c={body:{"box-sizing":"border-box",cursor:"text","font-family":"'Helvetica', 'Arial', sans-serif","font-size":"13px",height:"100%","line-height":"1.42",margin:"0px","overflow-x":"hidden","overflow-y":"auto",padding:"12px 15px"},".editor-container":{height:"100%",outline:"none",position:"relative","tab-size":"4","white-space":"pre-wrap"},".editor-container a":{"text-decoration":"underline"},".editor-container b":{"font-weight":"bold"},".editor-container i":{"font-style":"italic"},".editor-container s":{"text-decoration":"line-through"},".editor-container u":{"text-decoration":"underline"},".editor-container ol":{margin:"0px",padding:"0px"},".editor-container ul":{"list-style-type":"disc",margin:"0px",padding:"0px"}},e=["decimal","lower-alpha","lower-roman"],j.each([1,2,3,4,5,6,7,8,9],function(a){return c[".editor-container .indent-"+a]={"margin-left":""+2*a+"em"},c[".editor-container ol.indent-"+a]={"list-style-type":e[(a-1)%3]}}),i.isIE()&&(c.br={display:"none"}),h=function(a){function b(a,b){this.container=a,this.options=null!=b?b:{},this.buildFrame(),this.addStyles(c),null!=b.styles&&j.defer(this.addStyles.bind(this,this.options.styles))}return l(b,a),b.events={UPDATE:"renderer-update"},b.objToCss=function(a){return j.map(a,function(a,b){var c;return c=j.map(a,function(a,b){return""+b+": "+a+";"}).join(" "),""+b+" { "+c+" }"}).join("\n")},b.prototype.addContainer=function(a,b){var c;return null==b&&(b=!1),c=b?this.root:null,this.root.parentNode.insertBefore(a,c)},b.prototype.addStyles=function(a){var c;return c=this.root.ownerDocument.createElement("style"),c.type="text/css",j.isString(a)||(a=b.objToCss(a)),null!=c.styleSheet?c.styleSheet.cssText=a:c.appendChild(this.root.ownerDocument.createTextNode(a)),j.defer(function(d){return function(){return d.root.ownerDocument.querySelector("head").appendChild(c),d.emit(b.events.UPDATE,a),f.addClass(d.container,"sc-container")}}(this))},b.prototype.buildFrame=function(){var a,b,c;return b=this.container.innerHTML,this.container.innerHTML="",this.options.iframe?(this.iframe=this.container.ownerDocument.createElement("iframe"),this.iframe.frameBorder="0",this.container.appendChild(this.iframe),a=this.getDocument(),this.iframe.height=this.iframe.width="100%",a.open(),a.write("<!DOCTYPE html>"),a.close(),c=a.querySelector("html"),c.style.height=a.body.style.height="100%"):(this.iframe=this.container,a=this.getDocument()),this.root=a.createElement("div"),f.addClass(this.root,"editor-container"),this.root.id=this.options.id,this.options.iframe?a.body.appendChild(this.root):this.container.appendChild(this.root),this.root.innerHTML=g.normalizeHtml(b),f.addEventListener(this.container,"focus",function(a){return function(){return a.root.focus()}}(this))},b.prototype.checkFocus=function(){return this.root.ownerDocument.activeElement===this.root},b.prototype.getDocument=function(){var a;return null==this.iframe.parentNode?null:this.options.iframe?null!=(a=this.iframe.contentWindow)?a.document:void 0:this.iframe.ownerDocument},b}(d),b.exports=h},{"./dom":27,"./normalizer":40,"./utils":52,eventemitter2:"x/3aRz",lodash:"4HJaAd"}],45:[function(a,b){var c,d,e,f,g,h,i,j,k,l,m={}.hasOwnProperty,n=function(a,b){function c(){this.constructor=a}for(var d in b)m.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},o=[].slice;l=a("lodash"),j=a("es5-shim"),k=a("../package.json"),c=a("eventemitter2").EventEmitter2,f=a("./editor"),e=a("./themes/default"),g=a("./themes/snow"),h=a("tandem-core"),i=function(a,b){var c;return l.isString(a)?(c={},c[a]=b):c=l.isObject(a)?a:{},c},d=function(a){function b(a,c){null==c&&(c={}),this.options=l.defaults(c,b.DEFAULTS),this.options.id=this.id="scribe-"+(b.editors.length+1),this.options.emitter=this,this.modules={},this.editor=new f(a,this,this.options),b.editors.push(this.editor),this.theme=new b.themes[this.options.theme](this.editor),l.each(this.options.modules,function(a){return function(b,c){return a.addModule(c,b)}}(this)),l.each(f.events,function(a){return function(b){return a.editor.on(b,function(){var c;return c=1<=arguments.length?o.call(arguments,0):[],a.emit.apply(a,[b].concat(o.call(c)))})}}(this))}return n(b,a),b.version=k.version,b.editors=[],b.DEFAULTS={readOnly:!1,iframe:!0,logLevel:!1,pollInterval:100,formats:["bold","italic","strike","underline","link","back-color","font-name","fore-color","font-size"],theme:"default",undoDelay:1e3,undoMaxStack:100},b.themes={"default":e,snow:g},b.events={FOCUS_CHANGE:"focus-change",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change"},b.prototype.addModule=function(a,b){return l.isObject(b)||(b={}),this.modules[a]=this.theme.addModule(a,b),this.modules[a]},b.prototype.deleteText=function(a,b){var c;return c=h.Delta.makeDeleteDelta(this.getLength(),a,b),this.editor.applyDelta(c)},b.prototype.formatText=function(a,b,c,d){var e,f;return f=i(c,d),e=h.Delta.makeRetainDelta(this.getLength(),a,b,f),this.editor.applyDelta(e)},b.prototype.getContents=function(a,b){var c;return null==a&&(a=0),null==b&&(b=this.getLength()-a),c=this.editor.getDelta().getOpsAt(a,b),new h.Delta(0,c)},b.prototype.getHTML=function(){return this.editor.root.innerHTML},b.prototype.getLength=function(){return this.editor.getDelta().endLength},b.prototype.getModule=function(a){return this.modules[a]},b.prototype.getText=function(a,b){return l.pluck(this.getContents(a,b).ops,"value").join("")},b.prototype.insertText=function(a,b,c,d){var e,f;return f=i(c,d),e=h.Delta.makeInsertDelta(this.getLength(),a,b,f),this.editor.applyDelta(e)},b.prototype.setContents=function(a){return a=l.isArray(a)?new h.Delta(0,a):h.Delta.makeDelta(a),a.startLength=this.getLength(),this.editor.applyDelta(a)},b.prototype.setHTML=function(a){return this.editor.root.innerHTML=a},b.prototype.updateContents=function(a){return this.editor.applyDelta(a)},b}(c),b.exports=d},{"../package.json":25,"./editor":28,"./themes/default":48,"./themes/snow":50,"es5-shim":"4VPpiv",eventemitter2:"x/3aRz",lodash:"4HJaAd","tandem-core":"38mxji"}],46:[function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;n=a("lodash"),m=a("rangy-core"),c=a("./dom"),e=a("./line"),d=a("./keyboard"),f=a("./position"),g=a("./range"),i=a("./utils"),j=function(a,b){return a===b?!0:null==a||null==b?!1:a.equals(b)},k=function(a,b){return(null!=a?a.nodeType:void 0)===c.ELEMENT_NODE?null==a.firstChild?[a,0]:(b=Math.min(a.childNodes.length,b),b<a.childNodes.length?k(a.childNodes[b],0):a.lastChild.nodeType===c.ELEMENT_NODE?k(a.lastChild,a.lastChild.childNodes.length):[a.lastChild,i.getNodeLength(a.lastChild)]):[a,b]},l=function(a){var b,c,d,e,f,g;return null==a?null:(f=k(a.startContainer,a.startOffset),d=f[0],e=f[1],g=k(a.endContainer,a.endOffset),b=g[0],c=g[1],{startContainer:d,startOffset:e,endContainer:b,endOffset:c,isBackwards:a.isBackwards})},o=function(a){var b,c,d;return null==a?null:(d=new f(this.editor,a.startContainer,a.startOffset),b=new f(this.editor,a.endContainer,a.endOffset),d.index<=b.index?(c=new g(this.editor,d,b),c.isBackwards=!1):(c=new g(this.editor,b,d),c.isBackwards=!0),a.isBackwards&&(c.isBackwards=!0),c)},p=function(a,b,c,d){var e,f,h,i;return f=o.call(this,a),i=n.map([f.start,f.end],function(a){return b>=a.index?a.index:Math.max(a.index+c,b)}),h=i[0],e=i[1],d.call(null),this.setRange(new g(this.editor,h,e),!0)},q=function(a,b){var c,d,e,h,j;return e=n.map([{container:a.startContainer,offset:a.startOffset},{container:a.endContainer,offset:a.endOffset}],function(a){return function(b){var c,d;return c=i.findAncestor(b.container,i.isLineNode)||a.editor.root,{lineNode:c,offset:f.getIndex(b.container,b.offset,c),nextLine:"BR"===(null!=(d=b.container.previousSibling)?d.tagName:void 0)}}}(this)),b.call(null),d=this.getNativeRange(!0),n.isEqual(d,a)?void 0:(j=n.map(e,function(a){return function(b){return b.nextLine&&null!=b.lineNode.nextSibling&&(b.lineNode=b.lineNode.nextSibling,b.offset=0),new f(a.editor,b.lineNode,b.offset)}}(this)),h=j[0],c=j[1],this.setRange(new g(this.editor,h,c),!0))},r=function(a){var b;return b=this.editor.renderer.checkFocus(),a||this.hasFocus===b||(b?this.blurTimer?(clearTimeout(this.blurTimer),this.blurTimer=null):this.editor.emit(this.editor.constructor.events.FOCUS_CHANGE,!0):null==this.blurTimer&&(this.blurTimer=setTimeout(function(a){return function(){return a.hasFocus===!1&&a.editor.emit(a.editor.constructor.events.FOCUS_CHANGE,!1),a.blurTimer=null}}(this),200))),this.hasFocus=b},h=function(){function a(a){this.editor=a,this.range=null,this.blurTimer=null,m.init(),this.editor.renderer.options.iframe?null!=this.editor.renderer.iframe.parentNode&&(this.nativeSelection=m.getIframeSelection(this.editor.renderer.iframe)):this.nativeSelection=m.getSelection(),this.setRange(null,!0),this.hasFocus=this.editor.renderer.checkFocus(),c.addEventListener(this.editor.root,"focus",function(a){return function(){return n.defer(function(){return a.editor.checkUpdate()})}}(this)),c.addEventListener(this.editor.root,"beforedeactivate blur mouseup",function(a){return function(){return a.editor.checkUpdate()}}(this))}return a.prototype.getDimensions=function(){var a;return null==this.range?null:(a=this.range.nativeRange||this.range.textRange,a.getBoundingClientRect())},a.prototype.getNativeRange=function(a){var b,c;return null==a&&(a=!1),this.editor.renderer.checkFocus()?this.nativeSelection?(this.nativeSelection.refresh(),b=(null!=(c=this.nativeSelection)?c.rangeCount:void 0)>0?this.nativeSelection.getRangeAt(0):null,null==b||m.dom.isAncestorOf(this.editor.root,b.startContainer,!0)&&m.dom.isAncestorOf(this.editor.root,b.endContainer,!0)||(b=null),b?(a&&(b=l(b)),this.nativeSelection.isBackwards()&&(b.isBackwards=!0),b):null):null:this.range},a.prototype.getRange=function(){var a;return a=this.getNativeRange(!0),null!=a?o.call(this,a):null},a.prototype.preserve=function(a,b,c){var d;return n.isFunction(a)&&(c=a),d=this.getNativeRange(!0),null!=this.range?n.isFunction(a)?q.call(this,d,a):p.call(this,d,a,b,c):c.call(null)},a.prototype.setRange=function(a,b){var d;return null==b&&(b=!1),null!=this.nativeSelection?(this.editor.renderer.checkFocus()&&this.nativeSelection.removeAllRanges(),null!=a?(d=m.createRangyRange(this.editor.renderer.getDocument()),n.each([a.start,a.end],function(a,b){var e,f,g,h;return h=i.findDeepestNode(a.leafNode,a.offset),f=h[0],g=h[1],g=Math.min(c.getText(f).length,g),"BR"===f.tagName&&("BR"===f.tagName&&(f=f.parentNode),i.isIE()&&(g=1)),e=0===b?"setStart":"setEnd",d[e].call(d,f,g)}),this.nativeSelection.addRange(d,a.isBackwards),this.range=d):this.range=null,b?void 0:this.editor.emit(this.editor.constructor.events.SELECTION_CHANGE,a)):void 0},a.prototype.update=function(a){var b,c;if(null==a&&(a=!1),r.call(this,a),this.hasFocus){if(b=this.getNativeRange(!1),j(b,this.range))return;if(this.range=b,c=o.call(this,l(this.range)),i.isEmptyDoc(this.editor.root))return this.setRange(c,a);if(!a)return this.editor.emit(this.editor.constructor.events.SELECTION_CHANGE,c)}},a}(),b.exports=h},{"./dom":27,"./keyboard":31,"./line":34,"./position":42,"./range":43,"./utils":52,lodash:"4HJaAd","rangy-core":"rmqf9t"}],47:[function(a,b){var c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=a("../dom"),e=a("./picker"),c=function(a){function b(){b.__super__.constructor.apply(this,arguments),d.addClass(this.container,"sc-color-picker")}return g(b,a),b.prototype.buildItem=function(a,c,e){var f;return f=b.__super__.buildItem.call(this,a,c,e),f.style.backgroundColor=c.value,d.setText(f,""),f},b.prototype.selectItem=function(a){return b.__super__.selectItem.call(this,a),this.label.innerHTML=""},b}(e),b.exports=c},{"../dom":27,"./picker":49}],48:[function(a,b){var c,d,e,f,g;c=a("../modules/authorship"),e=a("../modules/link-tooltip"),f=a("../modules/multi-cursor"),g=a("../modules/toolbar"),d=function(){function a(a){this.editor=a}return a.stylesheets={},a.prototype.addModule=function(a,b){switch(a){case"authorship":return new c(this.editor,b);case"link-tooltip":return new e(this.editor,b);case"multi-cursor":return new f(this.editor,b);case"toolbar":return new g(this.editor,b);default:return null}},a}(),b.exports=d},{"../modules/authorship":36,"../modules/link-tooltip":37,"../modules/multi-cursor":38,"../modules/toolbar":39}],49:[function(a,b){var c,d,e;e=a("lodash"),c=a("../dom"),d=function(){function a(a){var b,d,f;this.select=a,this.container=this.select.ownerDocument.createElement("div"),e.each(c.getClasses(this.select),function(a){return function(b){return c.addClass(a.container,b)}}(this)),f=this.select.getAttribute("title"),f&&this.container.setAttribute("title",f),c.addClass(this.container,"sc-picker"),this.label=this.select.ownerDocument.createElement("div"),c.addClass(this.label,"sc-picker-label"),this.container.appendChild(this.label),b=this.buildPicker(),this.container.appendChild(b),d=b.querySelector(".sc-selected"),null!=d&&c.setText(this.label,c.getText(d)),c.addEventListener(this.label,"click",function(a){return function(){var b;return b=c.hasClass(a.container,"sc-expanded"),e.defer(function(){return c.toggleClass(a.container,"sc-expanded",!b)})}}(this)),c.addEventListener(this.select.ownerDocument,"click",function(a){return function(){return c.removeClass(a.container,"sc-expanded")}}(this)),c.addEventListener(this.select,"change",function(a){return function(){var b;return b=a.container.querySelectorAll(".sc-picker-item")[a.select.selectedIndex],a.selectItem(b),c.toggleClass(a.label,"sc-active",b!==d)}}(this)),this.select.parentNode.insertBefore(this.container,this.select)}return a.prototype.buildItem=function(a,b,d){var e;return e=this.select.ownerDocument.createElement("div"),c.addClass(e,"sc-picker-item"),c.setText(e,c.getText(b)),this.select.selectedIndex===d&&c.addClass(e,"sc-selected"),c.addEventListener(e,"click",function(a){return function(){return a.selectItem(e),a.select.selectedIndex=d,c.triggerEvent(a.select,"change",!0,!0),!0}}(this)),e},a.prototype.buildPicker=function(){var a;return a=this.select.ownerDocument.createElement("div"),c.addClass(a,"sc-picker-options"),e.each(this.select.querySelectorAll("option"),function(b){return function(c,d){var e;return e=b.buildItem(a,c,d),a.appendChild(e)}}(this)),this.select.style.display="none",a},a.prototype.close=function(){return c.removeClass(this.container,"sc-expanded")},a.prototype.selectItem=function(a){var b;return b=this.container.querySelector(".sc-selected"),null!=b&&c.removeClass(b,"sc-selected"),null!=a?(c.addClass(a,"sc-selected"),c.setText(this.label,c.getText(a))):this.label.innerHTML="&nbsp;"},a}(),b.exports=d},{"../dom":27,lodash:"4HJaAd"}],50:[function(a,b){var c,d,e,f,g,h,i={}.hasOwnProperty,j=function(a,b){function c(){this.constructor=a}for(var d in b)i.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};h=a("lodash"),c=a("../color-picker"),e=a("../default"),d=a("../../dom"),f=a("../picker"),g=function(a){function b(a){this.editor=a,this.pickers=[],this.editor.on(this.editor.constructor.events.SELECTION_CHANGE,function(a){return function(){return h.each(a.pickers,function(a){return a.close()})}}(this)),d.addClass(this.editor.root.parentNode,"snow"),b.__super__.constructor.apply(this,arguments)}return j(b,a),b.COLORS=["#000000","#e60000","#ff9900","#ffff00","#008A00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],b.OPTIONS={"multi-cursor":{template:'<span class="cursor-flag"> <span class="cursor-triangle top"></span> <span class="cursor-name"></span> <span class="cursor-triangle bottom"></span> </span> <span class="cursor-caret"></span>'}},b.prototype.addModule=function(a,c){var d;switch(c=h.defaults(b.OPTIONS[a]||{},c),d=b.__super__.addModule.call(this,a,c),a){case"authorship":this.extendAuthorship(d);break;case"link-tooltip":this.extendLinkTooltip(d);break;case"multi-cursor":this.extendMultiCursor(d);break;case"toolbar":this.extendToolbar(d)}return d},b.prototype.extendAuthorship=function(){},b.prototype.extendLinkTooltip=function(){return this.editor.renderer.addStyles({".snow a":{color:"#06c"},".snow .link-tooltip-container":{border:"1px solid #ccc","box-shadow":"0px 0px 5px #ddd",color:"#222"},".snow .link-tooltip-container a":{color:"#06c"},".snow .link-tooltip-container .input":{border:"1px solid #ccc",margin:"0px",padding:"3px"}})},b.prototype.extendMultiCursor=function(a){return this.editor.renderer.addStyles({".snow .cursor-name":{"border-radius":"4px","font-size":"11px","font-family":"Arial","margin-left":"-50%",padding:"4px 10px"},".snow .cursor-triangle":{"border-left":"4px solid transparent","border-right":"4px solid transparent",height:"0px","margin-left":"-3px",width:"0px"},".snow .cursor.left .cursor-name":{"margin-left":"-8px"},".snow .cursor.right .cursor-flag":{right:"auto"},".snow .cursor.right .cursor-name":{"margin-left":"-100%","margin-right":"-8px"},".snow .cursor-triangle.bottom":{"border-top":"4px solid transparent",display:"block","margin-bottom":"-1px"},".snow .cursor-triangle.top":{"border-bottom":"4px solid transparent",display:"none","margin-top":"-1px"},".snow .cursor.top .cursor-triangle.bottom":{display:"none"},".snow .cursor.top .cursor-triangle.top":{display:"block"}}),a.on(a.constructor.events.CURSOR_ADDED,function(a){var b,c;return b=a.elem.querySelector(".cursor-triangle.bottom"),c=a.elem.querySelector(".cursor-triangle.top"),b.style.borderTopColor=c.style.borderBottomColor=a.color})},b.prototype.extendToolbar=function(a){return h.each(a.container.querySelectorAll(".sc-font-name, .sc-font-size"),function(a){return function(b){var c;return c=new f(b),a.pickers.push(c)}}(this)),h.each(["fore-color","back-color"],function(e){return function(f){var g,i,j;return j=a.container.querySelector(".sc-"+f),null!=j?(i=new c(j),e.pickers.push(i),d.addClass(i.container.querySelector(".sc-picker-label"),"sc-format-button"),h.each(i.container.querySelectorAll(".sc-picker-item"),function(a,b){return 7>b?d.addClass(a,"sc-primary-color"):void 0}),g=e.editor.doc.formatManager.formats[f],null!=g?(g.styles=h.reduce(b.COLORS,function(a,b){return a[b]="rgb("+parseInt(b.substr(1,2),16)+", "+parseInt(b.substr(3,2),16)+", "+parseInt(b.substr(5,2),16)+")",a},{}),g.defaultStyle="sc-fore-color"===f?"#000000":"#ffffff"):void 0):void 0}}(this))},b}(e),b.exports=g},{"../../dom":27,"../color-picker":47,"../default":48,"../picker":49,lodash:"4HJaAd"}],51:[function(a,b){var c,d,e,f,g,h,i,j;h=a("lodash"),c=a("./keyboard"),d=a("./range"),f=a("tandem-core"),g=function(a){var b,c,d;return c=b=d=0,h.each(a.ops,function(a){return f.InsertOp.isInsert(a)?(d+=a.getLength(),c=b+d):f.RetainOp.isRetain(a)?(a.start>b&&(c=b+d,d-=a.start-b),h.keys(a.attributes).length>0&&(c=a.end+d),b=a.end):void 0}),a.endLength<a.startLength+d&&(c=a.endLength),c},i=function(a,b){var c;return this.stack[a].length>0?(c=this.stack[a].pop(),this.lastRecorded=0,j.call(this,function(b){return function(){var e;return b.editor.applyDelta(c[a],{source:"user"}),e=g(c[a]),b.editor.setSelection(new d(b.editor,e,e))}}(this)),this.stack[b].push(c)):void 0},j=function(a){var b;return b=this.ignoringChanges,this.ignoringChanges=!0,a.call(this),this.ignoringChanges=b},e=function(){function a(a,b){this.editor=a,this.options=null!=b?b:{},this.lastRecorded=0,this.clear(),this.initListeners()}return a.prototype.initListeners=function(){return this.editor.keyboard.addHotkey(c.hotkeys.UNDO,function(a){return function(){return a.undo(),!1}}(this)),this.editor.keyboard.addHotkey(c.hotkeys.REDO,function(a){return function(){return a.redo(),!1}}(this)),this.ignoringChanges=!1,this.editor.on(this.editor.constructor.events.TEXT_CHANGE,function(a){return function(b,c){return a.ignoringChanges&&"user"===c||a.record(b,a.oldDelta),a.oldDelta=a.editor.getDelta()}}(this))},a.prototype.clear=function(){return this.stack={undo:[],redo:[]},this.oldDelta=this.editor.getDelta()},a.prototype.record=function(a,b){var c,d,e,f;if(!a.isIdentity()){this.stack.redo=[];try{return f=b.invert(a),e=(new Date).getTime(),this.lastRecorded+this.options.undoDelay>e&&this.stack.undo.length>0?(c=this.stack.undo.pop(),f.canCompose(c.undo)&&c.redo.canCompose(a)?(f=f.compose(c.undo),a=c.redo.compose(a)):("undefined"!=typeof console&&null!==console&&console.warn("Unable to compose change, clearing undo stack"),this.clear(),this.lastRecorded=e)):this.lastRecorded=e,this.stack.undo.push({redo:a,undo:f}),this.stack.undo.length>this.options.undoMaxStack&&this.stack.undo.unshift(),!0}catch(g){return d=g,this.clear(),!1}}},a.prototype.redo=function(){return i.call(this,"redo","undo")},a.prototype.undo=function(){return i.call(this,"undo","redo")},a}(),b.exports=e},{"./keyboard":31,"./range":43,lodash:"4HJaAd","tandem-core":"38mxji"}],52:[function(a,b){var c,d,e,f,g=[].slice;f=a("lodash"),c=a("./dom"),e=function(){var a;return a=navigator.userAgent.match(/MSIE [0-9\.]+/),null!=a?parseInt(a[0].slice("MSIE".length)):null}(),d={BLOCK_TAGS:["ADDRESS","BLOCKQUOTE","DD","DIV","DL","H1","H2","H3","H4","H5","H6","LI","OL","P","PRE","TABLE","TBODY","TD","TFOOT","TH","THEAD","TR","UL"],findAncestor:function(a,b){for(;null!=a&&!b(a);)a=a.parentNode;return a},findClosestPoint:function(a,b,c){var d,e,g,h,i;null==c&&(c=function(){}),a=c.call(null,a),f.isArray(a)||(a=[a]),d=1/0,e=!1;for(i in b){if(g=b[i],g=c.call(null,g),f.isArray(g)||(g=[g]),h=f.reduce(g,function(b,c,d){return b+Math.pow(c-a[d],2)},0),h=Math.sqrt(h),0===h)return i;d>h&&(d=h,e=i)}return e},findDeepestNode:function(a,b){var c,e,g,h,i;if(null!=a.firstChild){for(i=f.clone(a.childNodes),g=0,h=i.length;h>g;g++){if(c=i[g],e=d.getNodeLength(c),e>b)return d.findDeepestNode(c,b);
b-=e}return d.findDeepestNode(c,b+e)}return[a,b]},getChildAtOffset:function(a,b){var c,e;for(c=a.firstChild,e=d.getNodeLength(c);null!=c&&!(e>b);)b-=e,c=c.nextSibling,e=d.getNodeLength(c);return null==c&&(c=a.lastChild,b=d.getNodeLength(c)),[c,b]},getNodeLength:function(a){return null==a?0:a.nodeType===c.ELEMENT_NODE?f.reduce(a.childNodes,function(a,b){return a+d.getNodeLength(b)},d.isLineNode(a)?1:0):a.nodeType===c.TEXT_NODE?c.getText(a).length:0},isBlock:function(a){return f.indexOf(d.BLOCK_TAGS,a.tagName,!0)>-1},isEmptyDoc:function(a){var b;return b=a.firstChild,null===b?!0:null===b.firstChild?!0:b.firstChild===b.lastChild&&"BR"===b.firstChild.tagName?!0:!1},isIE:function(a){return null==a&&(a=10),null!=e&&a>=e},isLineNode:function(a){return null!=(null!=a?a.parentNode:void 0)&&c.hasClass(a.parentNode,"editor-container")&&d.isBlock(a)},removeFormatFromSubtree:function(a,b){return b.matchContainer(a)&&(a=c.unwrap(a)),f.each(a.childNodes,function(a){return d.removeFormatFromSubtree(a,b)}),a},splitBefore:function(a,b){var c,e;if(a===b||a.parentNode===b)return!1;for(e=a.parentNode,c=e.cloneNode(!1),e.parentNode.insertBefore(c,e);null!=a.previousSibling;)c.insertBefore(a.previousSibling,c.firstChild);return d.splitBefore(e,b)},splitNode:function(a,b,e){var f,g,h,i,j,k,l,m,n,o;if(null==e&&(e=!1),l=d.getNodeLength(a),b=Math.max(0,b),b=Math.min(b,l),!e&&0===b)return[a.previousSibling,a,!1];if(!e&&b===l)return[a,a.nextSibling,!1];if(a.nodeType===c.TEXT_NODE)return f=a.splitText(b),[a,f,!0];for(j=a,m=a.cloneNode(!1),a.parentNode.insertBefore(m,j.nextSibling),n=d.getChildAtOffset(a,b),g=n[0],b=n[1],o=d.splitNode(g,b),h=o[0],i=o[1];null!==i;)k=i.nextSibling,m.appendChild(i),i=k;return[j,m,!0]},traversePostorder:function(a,b,c){var e,f;if(null==c&&(c=b),null!=a){for(e=a.firstChild,f=[];null!=e;)d.traversePostorder.call(c,e,b),e=b.call(c,e),f.push(null!=e?e=e.nextSibling:void 0);return f}},traversePreorder:function(){var a,b,c,e,f,h,i,j,k,l;if(j=arguments[0],i=arguments[1],f=arguments[2],b=arguments[3],a=5<=arguments.length?g.call(arguments,4):[],null==b&&(b=f),null!=j){for(c=j.firstChild,l=[];null!=c;)h=i+d.getNodeLength(c),e=c.innerHTML,c=f.call.apply(f,[b,c,i].concat(g.call(a))),(k=d.traversePreorder).call.apply(k,[null,c,i,f,b].concat(g.call(a))),null!=c&&c.innerHTML===e?(c=c.nextSibling,l.push(i=h)):l.push(void 0);return l}},traverseSiblings:function(a,b,c){var d,e;for(e=[];null!=a&&(d=a.nextSibling,c(a),a!==b);)e.push(a=d);return e}},b.exports=d},{"./dom":27,lodash:"4HJaAd"}]},{},[1])(1)});